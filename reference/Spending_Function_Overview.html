<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>4.0: Spending function overview — Spending_Function_Overview • gsDesign</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="4.0: Spending function overview — Spending_Function_Overview" />
<meta property="og:description" content="Spending functions are used to set boundaries for group sequential designs.
Using the spending function approach to design offers a natural way to
provide interim testing boundaries when unplanned interim analyses are added
or when the timing of an interim analysis changes. Many standard and
investigational spending functions are provided in the gsDesign package.
These offer a great deal of flexibility in setting up stopping boundaries
for a design." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gsDesign</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.1.0.9006</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>4.0: Spending function overview</h1>
    
    <div class="hidden name"><code>Spending_Function_Overview.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Spending functions are used to set boundaries for group sequential designs.
Using the spending function approach to design offers a natural way to
provide interim testing boundaries when unplanned interim analyses are added
or when the timing of an interim analysis changes. Many standard and
investigational spending functions are provided in the gsDesign package.
These offer a great deal of flexibility in setting up stopping boundaries
for a design.</p>
    </div>


    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>alpha</th>
      <td><p>Real value \(&gt; 0\) and no more than 1. Defaults in calls to
<code><a href='gsDesign.html'>gsDesign()</a></code> are <code>alpha=0.025</code> for one-sided Type I error
specification and <code>alpha=0.1</code> for Type II error specification.
However, this could be set to 1 if, for descriptive purposes, you wish to
see the proportion of spending as a function of the proportion of sample
size/information.</p></td>
    </tr>
    <tr>
      <th>t</th>
      <td><p>A vector of points with increasing values from 0 to 1, inclusive.
Values of the proportion of sample size/information for which the spending
function will be computed.</p></td>
    </tr>
    <tr>
      <th>param</th>
      <td><p>A single real value or a vector of real values specifying the
spending function parameter(s); this must be appropriately matched to the
spending function specified.</p></td>
    </tr>
    <tr>
      <th>object</th>
      <td><p>A spendfn object to be summarized.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Not currently used.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>spendingFunction</code> and spending functions in general produce an
object of type <code>spendfn</code>.</p>
<dt>name</dt><dd><p>A character string with the name
of the spending function.</p></dd> <dt>param</dt><dd><p>any parameters used for the spending
function.</p></dd> <dt>parname</dt><dd><p>a character string or strings with the name(s) of
the parameter(s) in <code>param</code>.</p></dd> <dt>sf</dt><dd><p>the spending function
specified.</p></dd> <dt>spend</dt><dd><p>a vector of cumulative spending values
corresponding to the input values in <code>t</code>.</p></dd> <dt>bound</dt><dd><p>this is null
when returned from the spending function, but is set in <code><a href='gsDesign.html'>gsDesign()</a></code> if
the spending function is called from there.  Contains z-values for bounds of
a design.</p></dd> <dt>prob</dt><dd><p>this is null when returned from the spending
function, but is set in <code><a href='gsDesign.html'>gsDesign()</a></code> if the spending function is called
from there.  Contains probabilities of boundary crossing at <code>i</code>-th
analysis for <code>j</code>-th theta value input to <code><a href='gsDesign.html'>gsDesign()</a></code> in
<code>prob[i,j]</code>.</p></dd>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code><a href='https://rdrr.io/r/base/summary.html'>summary()</a></code> function for <code>spendfn</code> objects provides a brief
textual summary of a spending function or boundary used for a design.</p>
<p>Spending functions have three arguments as noted above and return an object
of type <code>spendfn</code>. Normally a spending function will be passed to
<code><a href='gsDesign.html'>gsDesign()</a></code> in the parameter <code>sfu</code> for the upper bound and
<code>sfl</code> for the lower bound to specify a spending function family for a
design. In this case, the user does not need to know the calling sequence -
only how to specify the parameter(s) for the spending function. The calling
sequence is useful when the user wishes to plot a spending function as
demonstrated below in examples. In addition to using supplied spending
functions, a user can write code for a spending function. See examples.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>The manual is not linked to this help file, but is available in
library/gsdesign/doc/gsDesignManual.pdf in the directory where R is
installed.</p>
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Jennison C and Turnbull BW (2000), <em>Group Sequential
Methods with Applications to Clinical Trials</em>. Boca Raton: Chapman and Hall.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='gsDesign.html'>gsDesign</a></code>, <code><a href='sfHSD.html'>sfHSD</a></code>, <code><a href='sfPower.html'>sfPower</a></code>,
<code><a href='sfDistribution.html'>sfLogistic</a></code>, <code><a href='sfExponential.html'>sfExponential</a></code>,
<code><a href='sfSpecial.html'>sfTruncated</a></code>, <a href='gsDesign-package-overview.html'>gsDesign package overview</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>ggplot2</span>)
<span class='co'># Example 1: simple example showing what mose users need to know</span>

<span class='co'># design a 4-analysis trial using a Hwang-Shih-DeCani spending function </span>
<span class='co'># for both lower and upper bounds </span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gsDesign.html'>gsDesign</a></span>(<span class='kw'>k</span><span class='kw'>=</span><span class='fl'>4</span>, <span class='kw'>sfu</span><span class='kw'>=</span><span class='no'>sfHSD</span>, <span class='kw'>sfupar</span><span class='kw'>=</span>-<span class='fl'>2</span>, <span class='kw'>sfl</span><span class='kw'>=</span><span class='no'>sfHSD</span>, <span class='kw'>sflpar</span><span class='kw'>=</span><span class='fl'>1</span>)

<span class='co'># print the design</span>
<span class='no'>x</span></div><div class='output co'>#&gt; Asymmetric two-sided group sequential design with
#&gt; 90 % power and 2.5 % Type I Error.
#&gt; Upper bound spending computations assume
#&gt; trial continues if lower bound is crossed.
#&gt; 
#&gt;            Sample
#&gt;             Size   ----Lower bounds----  ----Upper bounds-----
#&gt;   Analysis Ratio*  Z   Nominal p Spend+  Z   Nominal p Spend++
#&gt;          1  0.324 0.03    0.5136 0.0350 2.80    0.0025  0.0025
#&gt;          2  0.649 0.88    0.8096 0.0273 2.58    0.0049  0.0042
#&gt;          3  0.973 1.51    0.9349 0.0212 2.34    0.0096  0.0069
#&gt;          4  1.297 2.09    0.9817 0.0165 2.09    0.0183  0.0114
#&gt;      Total                       0.1000                 0.0250 
#&gt; + lower bound beta spending (under H1):
#&gt;  Hwang-Shih-DeCani spending function with gamma = 1.
#&gt; ++ alpha spending:
#&gt;  Hwang-Shih-DeCani spending function with gamma = -2.
#&gt; * Sample size ratio compared to fixed design with no interim
#&gt; 
#&gt; Boundary crossing probabilities and expected sample size
#&gt; assume any cross stops the trial
#&gt; 
#&gt; Upper boundary (power or Type I Error)
#&gt;           Analysis
#&gt;    Theta      1      2      3      4  Total   E{N}
#&gt;   0.0000 0.0025 0.0042 0.0065 0.0072 0.0203 0.5477
#&gt;   3.2415 0.1695 0.3553 0.2774 0.0978 0.9000 0.7533
#&gt; 
#&gt; Lower boundary (futility or Type II Error)
#&gt;           Analysis
#&gt;    Theta      1      2      3      4  Total
#&gt;   0.0000 0.5136 0.3156 0.1169 0.0336 0.9797
#&gt;   3.2415 0.0350 0.0273 0.0212 0.0165 0.1000</div><div class='input'><span class='co'># summarize the spending functions</span>
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>x</span>$<span class='no'>upper</span>)</div><div class='output co'>#&gt; [1] "Hwang-Shih-DeCani spending function with gamma = -2"</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>x</span>$<span class='no'>lower</span>)</div><div class='output co'>#&gt; [1] "Hwang-Shih-DeCani spending function with gamma = 1"</div><div class='input'>
<span class='co'># plot the alpha- and beta-spending functions</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='kw'>plottype</span><span class='kw'>=</span><span class='fl'>5</span>)</div><div class='img'><img src='Spending_Function_Overview-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># what happens to summary if we used a boundary function design</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gsDesign.html'>gsDesign</a></span>(<span class='kw'>test.type</span><span class='kw'>=</span><span class='fl'>2</span>,<span class='kw'>sfu</span><span class='kw'>=</span><span class='st'>"OF"</span>)
<span class='no'>y</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gsDesign.html'>gsDesign</a></span>(<span class='kw'>test.type</span><span class='kw'>=</span><span class='fl'>1</span>,<span class='kw'>sfu</span><span class='kw'>=</span><span class='st'>"WT"</span>,<span class='kw'>sfupar</span><span class='kw'>=</span><span class='fl'>.25</span>)
<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>x</span>$<span class='no'>upper</span>)</div><div class='output co'>#&gt; [1] "O'Brien-Fleming boundary"</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>y</span>$<span class='no'>upper</span>)</div><div class='output co'>#&gt; [1] "Wang-Tsiatis boundary with Delta = 0.25"</div><div class='input'>
<span class='co'># Example 2: advanced example: writing a new spending function  </span>
<span class='co'># Most users may ignore this!</span>

<span class='co'># implementation of 2-parameter version of</span>
<span class='co'># beta distribution spending function</span>
<span class='co'># assumes t and alpha are appropriately specified (does not check!) </span>
<span class='no'>sfbdist</span> <span class='kw'>&lt;-</span> <span class='kw'>function</span>(<span class='no'>alpha</span>,  <span class='no'>t</span>,  <span class='no'>param</span>)
{
   <span class='co'># check inputs</span>
   <span class='fu'><a href='checkScalar.html'>checkVector</a></span>(<span class='no'>param</span>, <span class='st'>"numeric"</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>Inf</span>), <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>FALSE</span>, <span class='fl'>TRUE</span>))
   <span class='kw'>if</span> (<span class='fu'><a href='https://rdrr.io/r/base/length.html'>length</a></span>(<span class='no'>param</span>) <span class='kw'>!=</span><span class='fl'>2</span>) <span class='fu'><a href='https://rdrr.io/r/base/stop.html'>stop</a></span>(
   <span class='st'>"b-dist example spending function parameter must be of length 2"</span>)

   <span class='co'># set spending using cumulative beta distribution and return</span>
   <span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span>(<span class='kw'>name</span><span class='kw'>=</span><span class='st'>"B-dist example"</span>, <span class='kw'>param</span><span class='kw'>=</span><span class='no'>param</span>, <span class='kw'>parname</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"a"</span>, <span class='st'>"b"</span>),
             <span class='kw'>sf</span><span class='kw'>=</span><span class='no'>sfbdist</span>, <span class='kw'>spend</span><span class='kw'>=</span><span class='no'>alpha</span> *
           <span class='fu'><a href='https://rdrr.io/r/stats/Beta.html'>pbeta</a></span>(<span class='no'>t</span>, <span class='no'>param</span>[<span class='fl'>1</span>], <span class='no'>param</span>[<span class='fl'>2</span>]), <span class='kw'>bound</span><span class='kw'>=</span><span class='kw'>NULL</span>, <span class='kw'>prob</span><span class='kw'>=</span><span class='kw'>NULL</span>)

   <span class='fu'><a href='https://rdrr.io/r/base/class.html'>class</a></span>(<span class='no'>x</span>) <span class='kw'>&lt;-</span> <span class='st'>"spendfn"</span>

   <span class='no'>x</span>
}

<span class='co'># now try it out!</span>
<span class='co'># plot some example beta (lower bound) spending functions using </span>
<span class='co'># the beta distribution spending function </span>
<span class='no'>t</span> <span class='kw'>&lt;-</span> <span class='fl'>0</span>:<span class='fl'>100</span>/<span class='fl'>100</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>t</span>, <span class='fu'>sfbdist</span>(<span class='fl'>1</span>, <span class='no'>t</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>2</span>, <span class='fl'>1</span>))$<span class='no'>spend</span>, <span class='kw'>type</span><span class='kw'>=</span><span class='st'>"l"</span>,
    <span class='kw'>xlab</span><span class='kw'>=</span><span class='st'>"Proportion of information"</span>,
    <span class='kw'>ylab</span><span class='kw'>=</span><span class='st'>"Cumulative proportion of total spending"</span>,
    <span class='kw'>main</span><span class='kw'>=</span><span class='st'>"Beta distribution Spending Function Example"</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='no'>t</span>, <span class='fu'>sfbdist</span>(<span class='fl'>1</span>, <span class='no'>t</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>6</span>, <span class='fl'>4</span>))$<span class='no'>spend</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>2</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='no'>t</span>, <span class='fu'>sfbdist</span>(<span class='fl'>1</span>, <span class='no'>t</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.5</span>, <span class='fl'>.5</span>))$<span class='no'>spend</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>3</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/lines.html'>lines</a></span>(<span class='no'>t</span>, <span class='fu'>sfbdist</span>(<span class='fl'>1</span>, <span class='no'>t</span>, <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.6</span>, <span class='fl'>2</span>))$<span class='no'>spend</span>, <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>4</span>)</div><div class='input'><span class='fu'><a href='https://rdrr.io/r/graphics/legend.html'>legend</a></span>(<span class='kw'>x</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.65</span>, <span class='fl'>1</span>), <span class='kw'>y</span><span class='kw'>=</span><span class='fl'>1</span> * <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>0</span>, <span class='fl'>.25</span>), <span class='kw'>lty</span><span class='kw'>=</span><span class='fl'>1</span>:<span class='fl'>4</span>,
    <span class='kw'>legend</span><span class='kw'>=</span><span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"a=2, b=1"</span>,<span class='st'>"a=6, b=4"</span>,<span class='st'>"a=0.5, b=0.5"</span>,<span class='st'>"a=0.6, b=2"</span>))</div><div class='img'><img src='Spending_Function_Overview-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Keaven Anderson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


