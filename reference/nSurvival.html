<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Time-to-event sample size calculation (Lachin-Foulkes) — print.nSurvival • gsDesign</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet"><script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet"><meta property="og:title" content="Time-to-event sample size calculation (Lachin-Foulkes) — print.nSurvival"><meta name="description" content='nSurvival() is used to calculate the sample size for a clinical trial
with a time-to-event endpoint. The Lachin and Foulkes (1986) method is used.
nEvents uses the Schoenfeld (1981) approximation to provide sample
size and power in terms of the underlying hazard ratio and the number of
events observed in a survival analysis. The functions hrz2n(),
hrn2z() and zn2hr() also use the Schoenfeld approximation to
provide simple translations between hazard ratios, z-values and the number
of events in an analysis; input variables can be given as vectors.
nSurvival() produces an object of class "nSurvival" with the number
of subjects and events for a set of pre-specified trial parameters, such as
accrual duration and follow-up period. The calculation is based on Lachin
and Foulkes (1986) method and can be used for risk ratio or risk difference.
The function also consider non-uniform (exponential) entry as well as
uniform entry.
If the logical approx is TRUE, the variance under alternative
hypothesis is used to replace the variance under null hypothesis.  For
non-uniform entry, a non-zero value of gamma for exponential entry
must be supplied. For positive gamma, the entry distribution is
convex, whereas for negative gamma, the entry distribution is
concave.
nEvents() uses the Schoenfeld (1981) method to approximate the number
of events n (given beta) or the power (given n).
Arguments may be vectors or scalars, but any vectors must have the same
length.
The functions hrz2n, hrn2z and zn2hr also all apply the
Schoenfeld approximation for proportional hazards modeling.  This
approximation is based on the asymptotic normal distribtuion of the logrank
statistic as well as related statistics are asymptotically normal.  Let
\(\lambda\) denote the underlying hazard ratio (lambda1/lambda2 in
terms of the arguments to nSurvival). Further, let \(n\) denote the
number of events observed when computing the statistic of interest and
\(r\) the ratio of the sample size in an experimental group relative to a
control. The estimated natural logarithm of the hazard ratio from a
proportional hazards ratio is approximately normal with a mean of
\(log{\lambda}\) and variance \((1+r)^2/nr\). Let \(z\) denote a
logrank statistic (or a Wald statistic or score statistic from a
proportional hazards regression model). The same asymptotic theory implies
\(z\) is asymptotically equivalent to a normalized estimate of the hazard
ratio \(\lambda\) and thus \(z\) is asymptotically normal with variance
1 and mean $$\frac{log{\lambda}r}{(1+r)^2}.$$ Plugging the estimated
hazard ratio into the above equation allows approximating any one of the
following based on the other two: the estimate hazard ratio, the number of
events and the z-statistic. That is, $$\hat{\lambda}=
\exp(z(1+r)/\sqrt{rn})$$ $$z=\log(\hat{\lambda})\sqrt{nr}/(1+r)$$ $$n=
(z(1+r)/\log(\hat{\lambda}))^2/r.$$
hrz2n() translates an observed interim hazard ratio and interim
z-value into the number of events required for the Z-value and hazard ratio
to correspond to each other. hrn2z() translates a hazard ratio and
number of events into an approximate corresponding Z-value. zn2hr()
translates a Z-value and number of events into an approximate corresponding
hazard ratio. Each of these functions has a default assumption of an
underlying hazard ratio of 1 which can be changed using the argument
hr0. hrn2z() and zn2hr() also have an argument
hr1 which is only used to compute the sign of the computed Z-value in
the case of hrn2z() and whether or not a z-value &amp;gt; 0 corresponds to a
hazard ratio &amp;gt; or &amp;lt; the null hazard ratio hr0.'><meta property="og:description" content='nSurvival() is used to calculate the sample size for a clinical trial
with a time-to-event endpoint. The Lachin and Foulkes (1986) method is used.
nEvents uses the Schoenfeld (1981) approximation to provide sample
size and power in terms of the underlying hazard ratio and the number of
events observed in a survival analysis. The functions hrz2n(),
hrn2z() and zn2hr() also use the Schoenfeld approximation to
provide simple translations between hazard ratios, z-values and the number
of events in an analysis; input variables can be given as vectors.
nSurvival() produces an object of class "nSurvival" with the number
of subjects and events for a set of pre-specified trial parameters, such as
accrual duration and follow-up period. The calculation is based on Lachin
and Foulkes (1986) method and can be used for risk ratio or risk difference.
The function also consider non-uniform (exponential) entry as well as
uniform entry.
If the logical approx is TRUE, the variance under alternative
hypothesis is used to replace the variance under null hypothesis.  For
non-uniform entry, a non-zero value of gamma for exponential entry
must be supplied. For positive gamma, the entry distribution is
convex, whereas for negative gamma, the entry distribution is
concave.
nEvents() uses the Schoenfeld (1981) method to approximate the number
of events n (given beta) or the power (given n).
Arguments may be vectors or scalars, but any vectors must have the same
length.
The functions hrz2n, hrn2z and zn2hr also all apply the
Schoenfeld approximation for proportional hazards modeling.  This
approximation is based on the asymptotic normal distribtuion of the logrank
statistic as well as related statistics are asymptotically normal.  Let
\(\lambda\) denote the underlying hazard ratio (lambda1/lambda2 in
terms of the arguments to nSurvival). Further, let \(n\) denote the
number of events observed when computing the statistic of interest and
\(r\) the ratio of the sample size in an experimental group relative to a
control. The estimated natural logarithm of the hazard ratio from a
proportional hazards ratio is approximately normal with a mean of
\(log{\lambda}\) and variance \((1+r)^2/nr\). Let \(z\) denote a
logrank statistic (or a Wald statistic or score statistic from a
proportional hazards regression model). The same asymptotic theory implies
\(z\) is asymptotically equivalent to a normalized estimate of the hazard
ratio \(\lambda\) and thus \(z\) is asymptotically normal with variance
1 and mean $$\frac{log{\lambda}r}{(1+r)^2}.$$ Plugging the estimated
hazard ratio into the above equation allows approximating any one of the
following based on the other two: the estimate hazard ratio, the number of
events and the z-statistic. That is, $$\hat{\lambda}=
\exp(z(1+r)/\sqrt{rn})$$ $$z=\log(\hat{\lambda})\sqrt{nr}/(1+r)$$ $$n=
(z(1+r)/\log(\hat{\lambda}))^2/r.$$
hrz2n() translates an observed interim hazard ratio and interim
z-value into the number of events required for the Z-value and hazard ratio
to correspond to each other. hrn2z() translates a hazard ratio and
number of events into an approximate corresponding Z-value. zn2hr()
translates a Z-value and number of events into an approximate corresponding
hazard ratio. Each of these functions has a default assumption of an
underlying hazard ratio of 1 which can be changed using the argument
hr0. hrn2z() and zn2hr() also have an argument
hr1 which is only used to compute the sign of the computed Z-value in
the case of hrn2z() and whether or not a z-value &amp;gt; 0 corresponds to a
hazard ratio &amp;gt; or &amp;lt; the null hazard ratio hr0.'><meta property="og:image" content="https://keaven.github.io/gsDesign/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gsDesign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.6.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/keaven/gsDesign/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Time-to-event sample size calculation (Lachin-Foulkes)</h1>
      <small class="dont-index">Source: <a href="https://github.com/keaven/gsDesign/blob/v3.6.7/R/gsMethods.R" class="external-link"><code>R/gsMethods.R</code></a>, <a href="https://github.com/keaven/gsDesign/blob/v3.6.7/R/gsSurvival.R" class="external-link"><code>R/gsSurvival.R</code></a>, <a href="https://github.com/keaven/gsDesign/blob/v3.6.7/R/nEvents.R" class="external-link"><code>R/nEvents.R</code></a></small>
      <div class="d-none name"><code>nSurvival.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>nSurvival()</code> is used to calculate the sample size for a clinical trial
with a time-to-event endpoint. The Lachin and Foulkes (1986) method is used.
<code>nEvents</code> uses the Schoenfeld (1981) approximation to provide sample
size and power in terms of the underlying hazard ratio and the number of
events observed in a survival analysis. The functions <code>hrz2n()</code>,
<code>hrn2z()</code> and <code>zn2hr()</code> also use the Schoenfeld approximation to
provide simple translations between hazard ratios, z-values and the number
of events in an analysis; input variables can be given as vectors.</p>
<p><code>nSurvival()</code> produces an object of class "nSurvival" with the number
of subjects and events for a set of pre-specified trial parameters, such as
accrual duration and follow-up period. The calculation is based on Lachin
and Foulkes (1986) method and can be used for risk ratio or risk difference.
The function also consider non-uniform (exponential) entry as well as
uniform entry.</p>
<p>If the logical <code>approx</code> is <code>TRUE</code>, the variance under alternative
hypothesis is used to replace the variance under null hypothesis.  For
non-uniform entry, a non-zero value of <code>gamma</code> for exponential entry
must be supplied. For positive <code>gamma</code>, the entry distribution is
convex, whereas for negative <code>gamma</code>, the entry distribution is
concave.</p>
<p><code>nEvents()</code> uses the Schoenfeld (1981) method to approximate the number
of events <code>n</code> (given <code>beta</code>) or the power (given <code>n</code>).
Arguments may be vectors or scalars, but any vectors must have the same
length.</p>
<p>The functions <code>hrz2n</code>, <code>hrn2z</code> and <code>zn2hr</code> also all apply the
Schoenfeld approximation for proportional hazards modeling.  This
approximation is based on the asymptotic normal distribtuion of the logrank
statistic as well as related statistics are asymptotically normal.  Let
\(\lambda\) denote the underlying hazard ratio (<code>lambda1/lambda2</code> in
terms of the arguments to <code>nSurvival</code>). Further, let \(n\) denote the
number of events observed when computing the statistic of interest and
\(r\) the ratio of the sample size in an experimental group relative to a
control. The estimated natural logarithm of the hazard ratio from a
proportional hazards ratio is approximately normal with a mean of
\(log{\lambda}\) and variance \((1+r)^2/nr\). Let \(z\) denote a
logrank statistic (or a Wald statistic or score statistic from a
proportional hazards regression model). The same asymptotic theory implies
\(z\) is asymptotically equivalent to a normalized estimate of the hazard
ratio \(\lambda\) and thus \(z\) is asymptotically normal with variance
1 and mean $$\frac{log{\lambda}r}{(1+r)^2}.$$ Plugging the estimated
hazard ratio into the above equation allows approximating any one of the
following based on the other two: the estimate hazard ratio, the number of
events and the z-statistic. That is, $$\hat{\lambda}=
\exp(z(1+r)/\sqrt{rn})$$ $$z=\log(\hat{\lambda})\sqrt{nr}/(1+r)$$ $$n=
(z(1+r)/\log(\hat{\lambda}))^2/r.$$</p>
<p><code>hrz2n()</code> translates an observed interim hazard ratio and interim
z-value into the number of events required for the Z-value and hazard ratio
to correspond to each other. <code>hrn2z()</code> translates a hazard ratio and
number of events into an approximate corresponding Z-value. <code>zn2hr()</code>
translates a Z-value and number of events into an approximate corresponding
hazard ratio. Each of these functions has a default assumption of an
underlying hazard ratio of 1 which can be changed using the argument
<code>hr0</code>. <code>hrn2z()</code> and <code>zn2hr()</code> also have an argument
<code>hr1</code> which is only used to compute the sign of the computed Z-value in
the case of <code>hrn2z()</code> and whether or not a z-value &gt; 0 corresponds to a
hazard ratio &gt; or &lt; the null hazard ratio <code>hr0</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="co"># S3 method for class 'nSurvival'</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">nSurvival</span><span class="op">(</span></span>
<span>  lambda1 <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">12</span>,</span>
<span>  lambda2 <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="fl">24</span>,</span>
<span>  Ts <span class="op">=</span> <span class="fl">24</span>,</span>
<span>  Tr <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  eta <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  sided <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  approx <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  type <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"rr"</span>, <span class="st">"rd"</span><span class="op">)</span>,</span>
<span>  entry <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"unif"</span>, <span class="st">"expo"</span><span class="op">)</span>,</span>
<span>  gamma <span class="op">=</span> <span class="cn">NA</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">nEvents</span><span class="op">(</span></span>
<span>  hr <span class="op">=</span> <span class="fl">0.6</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  ratio <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sided <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  hr0 <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  n <span class="op">=</span> <span class="fl">0</span>,</span>
<span>  tbl <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="fu">zn2hr</span><span class="op">(</span><span class="va">z</span>, <span class="va">n</span>, ratio <span class="op">=</span> <span class="fl">1</span>, hr0 <span class="op">=</span> <span class="fl">1</span>, hr1 <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hrn2z</span><span class="op">(</span><span class="va">hr</span>, <span class="va">n</span>, ratio <span class="op">=</span> <span class="fl">1</span>, hr0 <span class="op">=</span> <span class="fl">1</span>, hr1 <span class="op">=</span> <span class="fl">0.7</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">hrz2n</span><span class="op">(</span><span class="va">hr</span>, <span class="va">z</span>, ratio <span class="op">=</span> <span class="fl">1</span>, hr0 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of class "nSurvival" returned by <code>nSurvival()</code>
(optional: used for output; "months" or "years" would be the 'usual'
choices).</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Allows additional arguments for <code>print.nSurvival()</code>.</p></dd>


<dt id="arg-lambda-lambda-">lambda1, lambda2<a class="anchor" aria-label="anchor" href="#arg-lambda-lambda-"></a></dt>
<dd><p>event hazard rate for placebo and treatment group
respectively.</p></dd>


<dt id="arg-ts">Ts<a class="anchor" aria-label="anchor" href="#arg-ts"></a></dt>
<dd><p>maximum study duration.</p></dd>


<dt id="arg-tr">Tr<a class="anchor" aria-label="anchor" href="#arg-tr"></a></dt>
<dd><p>accrual (recruitment) duration.</p></dd>


<dt id="arg-eta">eta<a class="anchor" aria-label="anchor" href="#arg-eta"></a></dt>
<dd><p>equal dropout hazard rate for both groups.</p></dd>


<dt id="arg-ratio">ratio<a class="anchor" aria-label="anchor" href="#arg-ratio"></a></dt>
<dd><p>randomization ratio between placebo and treatment group.
Default is balanced design, i.e., randomization ratio is 1.</p></dd>


<dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>type I error rate. Default is 0.025 since 1-sided testing is
default.</p></dd>


<dt id="arg-beta">beta<a class="anchor" aria-label="anchor" href="#arg-beta"></a></dt>
<dd><p>type II error rate. Default is 0.10 (90% power). Not needed for
<code>nEvents()</code> if n is provided.</p></dd>


<dt id="arg-sided">sided<a class="anchor" aria-label="anchor" href="#arg-sided"></a></dt>
<dd><p>one or two-sided test? Default is one-sided test.</p></dd>


<dt id="arg-approx">approx<a class="anchor" aria-label="anchor" href="#arg-approx"></a></dt>
<dd><p>logical. If <code>TRUE</code>, the approximation sample size formula
for risk difference is used.</p></dd>


<dt id="arg-type">type<a class="anchor" aria-label="anchor" href="#arg-type"></a></dt>
<dd><p>type of sample size calculation: risk ratio (“rr”) or
risk difference (“rd”).</p></dd>


<dt id="arg-entry">entry<a class="anchor" aria-label="anchor" href="#arg-entry"></a></dt>
<dd><p>patient entry type: uniform entry (<code>"unif"</code>) or
exponential entry (<code>"expo"</code>).</p></dd>


<dt id="arg-gamma">gamma<a class="anchor" aria-label="anchor" href="#arg-gamma"></a></dt>
<dd><p>rate parameter for exponential entry. <code>NA</code> if entry type
is <code>"unif"</code> (uniform). A non-zero value is supplied if entry type is
<code>"expo"</code> (exponential).</p></dd>


<dt id="arg-hr">hr<a class="anchor" aria-label="anchor" href="#arg-hr"></a></dt>
<dd><p>Hazard ratio. For <code>nEvents</code>, this is the hazard ratio under
the alternative hypothesis (&gt;0).</p></dd>


<dt id="arg-hr-">hr0<a class="anchor" aria-label="anchor" href="#arg-hr-"></a></dt>
<dd><p>Hazard ratio under the null hypothesis (&gt;0, for <code>nEvents</code>,
<code>!= hr</code>).</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Number of events. For <code>nEvents</code> may be input to compute power
rather than sample size.</p></dd>


<dt id="arg-tbl">tbl<a class="anchor" aria-label="anchor" href="#arg-tbl"></a></dt>
<dd><p>Indicator of whether or not scalar (vector) or tabular output is
desired for <code>nEvents()</code>.</p></dd>


<dt id="arg-z">z<a class="anchor" aria-label="anchor" href="#arg-z"></a></dt>
<dd><p>A z-statistic.</p></dd>


<dt id="arg-hr-">hr1<a class="anchor" aria-label="anchor" href="#arg-hr-"></a></dt>
<dd><p>Hazard ratio under the alternate hypothesis for <code>hrn2z,
zn2hr</code> (&gt;0, <code>!= hr0</code>)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>nSurvival</code> produces a list with the following component
returned:</p>
<dl><dt>type</dt>
<dd><p>As input.</p></dd>
 <dt>entry</dt>
<dd><p>As input.</p></dd>
 <dt>n</dt>
<dd><p>Sample
size required (computed).</p></dd>
 <dt>nEvents</dt>
<dd><p>Number of events required
(computed).</p></dd>
 <dt>lambda1</dt>
<dd><p>As input.</p></dd>
 <dt>lambda2</dt>
<dd><p>As input.</p></dd>

<dt>eta</dt>
<dd><p>As input.</p></dd>
 <dt>ratio</dt>
<dd><p>As input.</p></dd>
 <dt>gamma</dt>
<dd><p>As input.</p></dd>

<dt>alpha</dt>
<dd><p>As input.</p></dd>
 <dt>beta</dt>
<dd><p>As input.</p></dd>
 <dt>sided</dt>
<dd><p>As input.</p></dd>

<dt>Ts</dt>
<dd><p>As input.</p></dd>
 <dt>Tr</dt>
<dd><p>As input.</p></dd>


</dl><p><code>nEvents</code> produces a scalar or vector of sample sizes (or powers) when
<code>tbl=FALSE</code> or, when <code>tbl=TRUE</code> a data frame of values with the
following columns:</p>
<dl><dt>hr</dt>
<dd><p>As input.</p></dd>
 <dt>n</dt>
<dd><p>If <code>n[1]=0</code> on input
(default), output contains the number of events need to obtain the input
Type I and II error. If <code>n[1]&gt;0</code> on input, the input value is
returned.</p></dd>
 <dt>alpha</dt>
<dd><p>As input.</p></dd>
 <dt>beta</dt>
<dd><p>If <code>n[1]=0</code> on input
(default), <code>beta</code> is output as input. Otherwise, this is the computed
Type II error based on the input <code>n</code>.</p></dd>
 <dt>Power</dt>
<dd><p>One minus the
output <code>beta</code>. When <code>tbl=FALSE, n[1]&gt;0</code>, this is the value or
vector of values returned.</p></dd>
 <dt>delta</dt>
<dd><p>Standardized effect size
represented by input difference between null and alternative hypothesis
hazard ratios.</p></dd>
 <dt>ratio</dt>
<dd><p>Ratio of experimental to control sample size
where 'experimental' is the same as the group with hazard represented in the
numerator of the hazard ratio.</p></dd>
 <dt>se</dt>
<dd><p>Estimated standard error for the
observed log(hazard ratio) with the given sample size.</p></dd>


</dl><p><code>hrz2n</code> outputs a number of events required to approximately have the
input hazard ratio, z-statistic and sample size correspond. <code>hrn2z</code>
outputs an approximate z-statistic corresponding to an input hazard ratio
and number of events. <code>zn2hr</code> outputs an approximate hazard ratio
corresponding to an input z-statistic and number of events.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Lachin JM and Foulkes MA (1986), Evaluation of Sample Size and
Power for Analyses of Survival with Allowance for Nonuniform Patient Entry,
Losses to Follow-Up, Noncompliance, and Stratification. <em>Biometrics</em>,
42, 507-519.</p>
<p>Schoenfeld D (1981), The Asymptotic Properties of Nonparametric Tests for
Comparing Survival Distributions. <em>Biometrika</em>, 68, 316-319.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="../articles/gsDesignPackageOverview.html">vignette("gsDesignPackageOverview")</a></code>, <a href="plot.gsDesign.html">plot.gsDesign</a>,
<a href="gsDesign.html">gsDesign</a>, <a href="gsBoundSummary.html">gsHR</a></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Shanhong Guan <a href="mailto:shanhong.guan@gmail.com">shanhong.guan@gmail.com</a>, Keaven Anderson
<a href="mailto:keaven_anderson@merck.com">keaven_anderson@merck.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># consider a trial with</span></span></span>
<span class="r-in"><span><span class="co"># 2 year maximum follow-up</span></span></span>
<span class="r-in"><span><span class="co"># 6 month uniform enrollment</span></span></span>
<span class="r-in"><span><span class="co"># Treatment/placebo hazards = 0.1/0.2 per 1 person-year</span></span></span>
<span class="r-in"><span><span class="co"># drop out hazard 0.1 per 1 person-year</span></span></span>
<span class="r-in"><span><span class="co"># alpha = 0.025 (1-sided)</span></span></span>
<span class="r-in"><span><span class="co"># power = 0.9 (default beta=.1)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">ss</span> <span class="op">&lt;-</span> <span class="fu">nSurvival</span><span class="op">(</span></span></span>
<span class="r-in"><span>  lambda1 <span class="op">=</span> <span class="fl">.2</span>, lambda2 <span class="op">=</span> <span class="fl">.1</span>, eta <span class="op">=</span> <span class="fl">.1</span>, Ts <span class="op">=</span> <span class="fl">2</span>, Tr <span class="op">=</span> <span class="fl">.5</span>,</span></span>
<span class="r-in"><span>  sided <span class="op">=</span> <span class="fl">1</span>, alpha <span class="op">=</span> <span class="fl">.025</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#  group sequential translation with default bounds</span></span></span>
<span class="r-in"><span><span class="co">#  note that delta1 is log hazard ratio; used later in gsBoundSummary summary</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="gsDesign.html">gsDesign</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  k <span class="op">=</span> <span class="fl">5</span>, test.type <span class="op">=</span> <span class="fl">2</span>, n.fix <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">nEvents</span>, nFixSurv <span class="op">=</span> <span class="va">ss</span><span class="op">$</span><span class="va">n</span>,</span></span>
<span class="r-in"><span>  delta1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">ss</span><span class="op">$</span><span class="va">lambda2</span> <span class="op">/</span> <span class="va">ss</span><span class="op">$</span><span class="va">lambda1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># boundary plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="nSurvival-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># effect size plot</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, plottype <span class="op">=</span> <span class="st">"hr"</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="nSurvival-2.png" alt="" width="700" height="433"></span>
<span class="r-in"><span><span class="co"># total sample size</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">$</span><span class="va">nSurv</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 440</span>
<span class="r-in"><span><span class="co"># number of events at analyses</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">$</span><span class="va">n.I</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 18.44213 36.88425 55.32638 73.76850 92.21063</span>
<span class="r-in"><span><span class="co"># print the design</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Group sequential design sample size for time-to-event outcome</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> with sample size 440. The analysis plan below shows events</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> at each analysis.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Symmetric two-sided group sequential design with</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90 % power and 2.5 % Type I Error.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Spending computations assume trial stops</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> if a bound is crossed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Analysis N   Z   Nominal p  Spend</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1 19 3.25    0.0006 0.0006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          2 37 2.99    0.0014 0.0013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          3 56 2.69    0.0036 0.0028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          4 74 2.37    0.0088 0.0063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          5 93 2.03    0.0214 0.0140</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Total                   0.0250 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ++ alpha spending:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hwang-Shih-DeCani spending function with gamma = -4.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Boundary crossing probabilities and expected sample size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assume any cross stops the trial</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary (power or Type I Error)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Theta      1      2      3      4      5 Total E{N}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.0000 0.0006 0.0013 0.0028 0.0063 0.0140 0.025 91.5</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.3415 0.0370 0.1512 0.2647 0.2699 0.1771 0.900 66.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary (futility or Type II Error)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Theta     1      2      3      4     5 Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.0000 6e-04 0.0013 0.0028 0.0063 0.014 0.025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.3415 0e+00 0.0000 0.0000 0.0000 0.000 0.000</span>
<span class="r-in"><span><span class="co"># overall design summary</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Symmetric two-sided group sequential design with 5 analyses, time-to-event outcome with sample size 440 and 93 events required, 90 percent power, 2.5 percent (1-sided) Type I error. Bounds derived using a  Hwang-Shih-DeCani spending function with gamma = -4.</span>
<span class="r-in"><span><span class="co"># tabular summary of bounds</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gsBoundSummary.html">gsBoundSummary</a></span><span class="op">(</span><span class="va">x</span>, deltaname <span class="op">=</span> <span class="st">"HR"</span>, Nname <span class="op">=</span> <span class="st">"Events"</span>, logdelta <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Analysis              Value Efficacy Futility</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   IA 1: 20%                  Z   3.2527  -3.2527</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Events: 19        p (1-sided)   0.0006   0.0006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   ~HR at bound   0.2198   4.5487</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               P(Cross) if HR=1   0.0006   0.0006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             P(Cross) if HR=0.5   0.0370   0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   IA 2: 40%                  Z   2.9860  -2.9860</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Events: 37        p (1-sided)   0.0014   0.0014</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   ~HR at bound   0.3741   2.6734</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               P(Cross) if HR=1   0.0018   0.0018</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             P(Cross) if HR=0.5   0.1883   0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   IA 3: 60%                  Z   2.6917  -2.6917</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Events: 56        p (1-sided)   0.0036   0.0036</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   ~HR at bound   0.4849   2.0621</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               P(Cross) if HR=1   0.0047   0.0047</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             P(Cross) if HR=0.5   0.4530   0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   IA 4: 80%                  Z   2.3737  -2.3737</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Events: 74        p (1-sided)   0.0088   0.0088</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   ~HR at bound   0.5754   1.7380</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               P(Cross) if HR=1   0.0110   0.0110</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             P(Cross) if HR=0.5   0.7229   0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>       Final                  Z   2.0253  -2.0253</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Events: 93        p (1-sided)   0.0214   0.0214</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   ~HR at bound   0.6558   1.5247</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               P(Cross) if HR=1   0.0250   0.0250</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             P(Cross) if HR=0.5   0.9000   0.0000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># approximate number of events required using Schoenfeld's method</span></span></span>
<span class="r-in"><span><span class="co"># for 2 different hazard ratios</span></span></span>
<span class="r-in"><span><span class="fu">nEvents</span><span class="op">(</span>hr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.6</span><span class="op">)</span>, tbl <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    hr   n alpha sided beta Power     delta ratio hr0        se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.5  88 0.025     1  0.1   0.9 0.3465736     1   1 0.2132007</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.6 162 0.025     1  0.1   0.9 0.2554128     1   1 0.1571348</span>
<span class="r-in"><span><span class="co"># vector output</span></span></span>
<span class="r-in"><span><span class="fu">nEvents</span><span class="op">(</span>hr <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.5</span>, <span class="fl">.6</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1]  87.4793 161.0686</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># approximate power using Schoenfeld's method</span></span></span>
<span class="r-in"><span><span class="co"># given 2 sample sizes and hr=.6</span></span></span>
<span class="r-in"><span><span class="fu">nEvents</span><span class="op">(</span>hr <span class="op">=</span> <span class="fl">.6</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span><span class="op">)</span>, tbl <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    hr   n alpha sided      beta     Power     delta ratio hr0        se</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 0.6  50 0.025     1 0.5611646 0.4388354 0.2554128     1   1 0.2828427</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2 0.6 100 0.025     1 0.2762012 0.7237988 0.2554128     1   1 0.2000000</span>
<span class="r-in"><span><span class="co"># vector output</span></span></span>
<span class="r-in"><span><span class="fu">nEvents</span><span class="op">(</span>hr <span class="op">=</span> <span class="fl">.6</span>, n <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">100</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.4388354 0.7237988</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># approximate hazard ratio corresponding to 100 events and z-statistic of 2</span></span></span>
<span class="r-in"><span><span class="fu">zn2hr</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, z <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.67032</span>
<span class="r-in"><span><span class="co"># same when hr0 is 1.1</span></span></span>
<span class="r-in"><span><span class="fu">zn2hr</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, z <span class="op">=</span> <span class="fl">2</span>, hr0 <span class="op">=</span> <span class="fl">1.1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.7373521</span>
<span class="r-in"><span><span class="co"># same when hr0 is .9 and hr1 is greater than hr0</span></span></span>
<span class="r-in"><span><span class="fu">zn2hr</span><span class="op">(</span>n <span class="op">=</span> <span class="fl">100</span>, z <span class="op">=</span> <span class="fl">2</span>, hr0 <span class="op">=</span> <span class="fl">.9</span>, hr1 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.342642</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># approximate number of events corresponding to z-statistic of 2 and</span></span></span>
<span class="r-in"><span><span class="co"># estimated hazard ratio of .5 (or 2)</span></span></span>
<span class="r-in"><span><span class="fu">hrz2n</span><span class="op">(</span>hr <span class="op">=</span> <span class="fl">.5</span>, z <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 33.3019</span>
<span class="r-in"><span><span class="fu">hrz2n</span><span class="op">(</span>hr <span class="op">=</span> <span class="fl">2</span>, z <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 33.3019</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># approximate z statistic corresponding to 75 events</span></span></span>
<span class="r-in"><span><span class="co"># and estimated hazard ratio of .6 (or 1/.6)</span></span></span>
<span class="r-in"><span><span class="co"># assuming 2-to-1 randomization of experimental to control</span></span></span>
<span class="r-in"><span><span class="fu">hrn2z</span><span class="op">(</span>hr <span class="op">=</span> <span class="fl">.6</span>, n <span class="op">=</span> <span class="fl">75</span>, ratio <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -2.085437</span>
<span class="r-in"><span><span class="fu">hrn2z</span><span class="op">(</span>hr <span class="op">=</span> <span class="fl">1</span> <span class="op">/</span> <span class="fl">.6</span>, n <span class="op">=</span> <span class="fl">75</span>, ratio <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.085437</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Keaven Anderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer></div>





  </body></html>

