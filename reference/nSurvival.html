<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Time-to-event sample size calculation (Lachin-Foulkes) — print.nSurvival • gsDesign</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Time-to-event sample size calculation (Lachin-Foulkes) — print.nSurvival" />
<meta property="og:description" content="nSurvival() is used to calculate the sample size for a clinical trial
with a time-to-event endpoint. The Lachin and Foulkes (1986) method is used.
nEvents uses the Schoenfeld (1981) approximation to provide sample
size and power in terms of the underlying hazard ratio and the number of
events observed in a survival analysis. The functions hrz2n(),
hrn2z() and zn2hr() also use the Schoenfeld approximation to
provide simple translations between hazard ratios, z-values and the number
of events in an analysis; input variables can be given as vectors.
nSurvival() produces an object of class &quot;nSurvival&quot; with the number
of subjects and events for a set of pre-specified trial parameters, such as
accrual duration and follow-up period. The calculation is based on Lachin
and Foulkes (1986) method and can be used for risk ratio or risk difference.
The function also consider non-uniform (exponential) entry as well as
uniform entry.
If the logical approx is TRUE, the variance under alternative
hypothesis is used to replace the variance under null hypothesis.  For
non-uniform entry, a non-zero value of gamma for exponential entry
must be supplied. For positive gamma, the entry distribution is
convex, whereas for negative gamma, the entry distribution is
concave.
nEvents() uses the Schoenfeld (1981) method to approximate the number
of events n (given beta) or the power (given n).
Arguments may be vectors or scalars, but any vectors must have the same
length.
The functions hrz2n, hrn2z and zn2hr also all apply the
Schoenfeld approximation for proportional hazards modelling.  This
approximation is based on the asymptotic normal distribtuion of the logrank
statistic as well as related statistics are asymptotically normal.  Let
\(\lambda\) denote the underlying hazard ratio (lambda1/lambda2 in
terms of the arguments to nSurvival). Further, let \(n\) denote the
number of events observed when computing the statistic of interest and
\(r\) the ratio of the sample size in an experimental group relative to a
control. The estimated natural logarithm of the hazard ratio from a
proportional hazards ratio is approximately normal with a mean of
\(log{\lambda}\) and variance \((1+r)^2/nr\). Let \(z\) denote a
logrank statistic (or a Wald statistic or score statistic from a
proportional hazards regression model). The same asymptotic theory implies
\(z\) is asymptotically equivalent to a normalized estimate of the hazard
ratio \(\lambda\) and thus \(z\) is asymptotically normal with variance
1 and mean $$\frac{log{\lambda}r}{(1+r)^2}.$$ Plugging the estimated
hazard ratio into the above equation allows approximating any one of the
following based on the other two: the estimate hazard ratio, the number of
events and the z-statistic. That is, $$\hat{\lambda}=
\exp(z(1+r)/\sqrt{rn})$$ $$z=\log(\hat{\lambda})\sqrt{nr}/(1+r)$$ $$n=
(z(1+r)/\log(\hat{\lambda}))^2/r.$$
hrz2n() translates an observed interim hazard ratio and interim
z-value into the number of events required for the Z-value and hazard ratio
to correspond to each other. hrn2z() translates a hazard ratio and
number of events into an approximate corresponding Z-value. zn2hr()
translates a Z-value and number of events into an approximate corresponding
hazard ratio. Each of these functions has a default assumption of an
underlying hazard ratio of 1 which can be changed using the argument
hr0. hrn2z() and zn2hr() also have an argument
hr1 which is only used to compute the sign of the computed Z-value in
the case of hrn2z() and whether or not a z-value &amp;gt; 0 corresponds to a
hazard ratio &amp;gt; or &amp;lt; the null hazard ratio hr0." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gsDesign</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.1.0.9006</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Time-to-event sample size calculation (Lachin-Foulkes)</h1>
    
    <div class="hidden name"><code>nSurvival.Rd</code></div>
    </div>

    <div class="ref-description">
    <p><code>nSurvival()</code> is used to calculate the sample size for a clinical trial
with a time-to-event endpoint. The Lachin and Foulkes (1986) method is used.
<code>nEvents</code> uses the Schoenfeld (1981) approximation to provide sample
size and power in terms of the underlying hazard ratio and the number of
events observed in a survival analysis. The functions <code>hrz2n()</code>,
<code>hrn2z()</code> and <code>zn2hr()</code> also use the Schoenfeld approximation to
provide simple translations between hazard ratios, z-values and the number
of events in an analysis; input variables can be given as vectors.</p>
<p><code>nSurvival()</code> produces an object of class "nSurvival" with the number
of subjects and events for a set of pre-specified trial parameters, such as
accrual duration and follow-up period. The calculation is based on Lachin
and Foulkes (1986) method and can be used for risk ratio or risk difference.
The function also consider non-uniform (exponential) entry as well as
uniform entry.</p>
<p>If the logical <code>approx</code> is <code>TRUE</code>, the variance under alternative
hypothesis is used to replace the variance under null hypothesis.  For
non-uniform entry, a non-zero value of <code>gamma</code> for exponential entry
must be supplied. For positive <code>gamma</code>, the entry distribution is
convex, whereas for negative <code>gamma</code>, the entry distribution is
concave.</p>
<p><code>nEvents()</code> uses the Schoenfeld (1981) method to approximate the number
of events <code>n</code> (given <code>beta</code>) or the power (given <code>n</code>).
Arguments may be vectors or scalars, but any vectors must have the same
length.</p>
<p>The functions <code>hrz2n</code>, <code>hrn2z</code> and <code>zn2hr</code> also all apply the
Schoenfeld approximation for proportional hazards modelling.  This
approximation is based on the asymptotic normal distribtuion of the logrank
statistic as well as related statistics are asymptotically normal.  Let
\(\lambda\) denote the underlying hazard ratio (<code>lambda1/lambda2</code> in
terms of the arguments to <code>nSurvival</code>). Further, let \(n\) denote the
number of events observed when computing the statistic of interest and
\(r\) the ratio of the sample size in an experimental group relative to a
control. The estimated natural logarithm of the hazard ratio from a
proportional hazards ratio is approximately normal with a mean of
\(log{\lambda}\) and variance \((1+r)^2/nr\). Let \(z\) denote a
logrank statistic (or a Wald statistic or score statistic from a
proportional hazards regression model). The same asymptotic theory implies
\(z\) is asymptotically equivalent to a normalized estimate of the hazard
ratio \(\lambda\) and thus \(z\) is asymptotically normal with variance
1 and mean $$\frac{log{\lambda}r}{(1+r)^2}.$$ Plugging the estimated
hazard ratio into the above equation allows approximating any one of the
following based on the other two: the estimate hazard ratio, the number of
events and the z-statistic. That is, $$\hat{\lambda}=
\exp(z(1+r)/\sqrt{rn})$$ $$z=\log(\hat{\lambda})\sqrt{nr}/(1+r)$$ $$n=
(z(1+r)/\log(\hat{\lambda}))^2/r.$$</p>
<p><code>hrz2n()</code> translates an observed interim hazard ratio and interim
z-value into the number of events required for the Z-value and hazard ratio
to correspond to each other. <code>hrn2z()</code> translates a hazard ratio and
number of events into an approximate corresponding Z-value. <code>zn2hr()</code>
translates a Z-value and number of events into an approximate corresponding
hazard ratio. Each of these functions has a default assumption of an
underlying hazard ratio of 1 which can be changed using the argument
<code>hr0</code>. <code>hrn2z()</code> and <code>zn2hr()</code> also have an argument
<code>hr1</code> which is only used to compute the sign of the computed Z-value in
the case of <code>hrn2z()</code> and whether or not a z-value &gt; 0 corresponds to a
hazard ratio &gt; or &lt; the null hazard ratio <code>hr0</code>.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for nSurvival</span>
<span class='fu'><a href='https://rdrr.io/r/base/print.html'>print</a></span>(<span class='no'>x</span>, <span class='no'>...</span>)

<span class='fu'>nSurvival</span>(
  <span class='kw'>lambda1</span> <span class='kw'>=</span> <span class='fl'>1</span>/<span class='fl'>12</span>,
  <span class='kw'>lambda2</span> <span class='kw'>=</span> <span class='fl'>1</span>/<span class='fl'>24</span>,
  <span class='kw'>Ts</span> <span class='kw'>=</span> <span class='fl'>24</span>,
  <span class='kw'>Tr</span> <span class='kw'>=</span> <span class='fl'>12</span>,
  <span class='kw'>eta</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>ratio</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.025</span>,
  <span class='kw'>beta</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
  <span class='kw'>sided</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>approx</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>,
  <span class='kw'>type</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"rr"</span>, <span class='st'>"rd"</span>),
  <span class='kw'>entry</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='st'>"unif"</span>, <span class='st'>"expo"</span>),
  <span class='kw'>gamma</span> <span class='kw'>=</span> <span class='fl'>NA</span>
)

<span class='fu'>nEvents</span>(
  <span class='kw'>hr</span> <span class='kw'>=</span> <span class='fl'>0.6</span>,
  <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>0.025</span>,
  <span class='kw'>beta</span> <span class='kw'>=</span> <span class='fl'>0.1</span>,
  <span class='kw'>ratio</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>sided</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>hr0</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>tbl</span> <span class='kw'>=</span> <span class='fl'>FALSE</span>
)

<span class='fu'>zn2hr</span>(<span class='no'>z</span>, <span class='no'>n</span>, <span class='kw'>ratio</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>hr0</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>hr1</span> <span class='kw'>=</span> <span class='fl'>0.7</span>)

<span class='fu'>hrn2z</span>(<span class='no'>hr</span>, <span class='no'>n</span>, <span class='kw'>ratio</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>hr0</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>hr1</span> <span class='kw'>=</span> <span class='fl'>0.7</span>)

<span class='fu'>hrz2n</span>(<span class='no'>hr</span>, <span class='no'>z</span>, <span class='kw'>ratio</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>hr0</span> <span class='kw'>=</span> <span class='fl'>1</span>)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An object of class "nSurvival" returned by <code>nSurvival()</code>
(optional: used for output; "months" or "years" would be the 'usual'
choices).</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Allows additional arguments for <code>print.nSurvival()</code>.</p></td>
    </tr>
    <tr>
      <th>lambda1, lambda2</th>
      <td><p>event hazard rate for placebo and treatment group
respectively.</p></td>
    </tr>
    <tr>
      <th>Ts</th>
      <td><p>maximum study duration.</p></td>
    </tr>
    <tr>
      <th>Tr</th>
      <td><p>accrual (recruitment) duration.</p></td>
    </tr>
    <tr>
      <th>eta</th>
      <td><p>equal dropout hazard rate for both groups.</p></td>
    </tr>
    <tr>
      <th>ratio</th>
      <td><p>randomization ratio between placebo and treatment group.
Default is balanced design, i.e., randomization ratio is 1.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>type I error rate. Default is 0.025 since 1-sided testing is
default.</p></td>
    </tr>
    <tr>
      <th>beta</th>
      <td><p>type II error rate. Default is 0.10 (90% power). Not needed for
<code>nEvents()</code> if n is provided.</p></td>
    </tr>
    <tr>
      <th>sided</th>
      <td><p>one or two-sided test? Default is one-sided test.</p></td>
    </tr>
    <tr>
      <th>approx</th>
      <td><p>logical. If <code>TRUE</code>, the approximation sample size formula
for risk difference is used.</p></td>
    </tr>
    <tr>
      <th>type</th>
      <td><p>type of sample size calculation: risk ratio (&#8220;rr&#8221;) or
risk difference (&#8220;rd&#8221;).</p></td>
    </tr>
    <tr>
      <th>entry</th>
      <td><p>patient entry type: uniform entry (<code>"unif"</code>) or
exponential entry (<code>"expo"</code>).</p></td>
    </tr>
    <tr>
      <th>gamma</th>
      <td><p>rate parameter for exponential entry. <code>NA</code> if entry type
is <code>"unif"</code> (uniform). A non-zero value is supplied if entry type is
<code>"expo"</code> (exponential).</p></td>
    </tr>
    <tr>
      <th>hr</th>
      <td><p>Hazard ratio. For <code>nEvents</code>, this is the hazard ratio under
the alternative hypothesis (&gt;0).</p></td>
    </tr>
    <tr>
      <th>hr0</th>
      <td><p>Hazard ratio under the null hypothesis (&gt;0, for <code>nEvents</code>,
<code>!= hr</code>).</p></td>
    </tr>
    <tr>
      <th>n</th>
      <td><p>Number of events. For <code>nEvents</code> may be input to compute power
rather than sample size.</p></td>
    </tr>
    <tr>
      <th>tbl</th>
      <td><p>Indicator of whether or not scalar (vector) or tabular output is
desired for <code>nEvents()</code>.</p></td>
    </tr>
    <tr>
      <th>z</th>
      <td><p>A z-statistic.</p></td>
    </tr>
    <tr>
      <th>hr1</th>
      <td><p>Hazard ratio under the alternate hypothesis for <code>hrn2z,
zn2hr</code> (&gt;0, <code>!= hr0</code>)</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p><code>nSurvival</code> produces a list with the following component
returned:</p>
<dt>type</dt><dd><p>As input.</p></dd> <dt>entry</dt><dd><p>As input.</p></dd> <dt>n</dt><dd><p>Sample
size required (computed).</p></dd> <dt>nEvents</dt><dd><p>Number of events required
(computed).</p></dd> <dt>lambda1</dt><dd><p>As input.</p></dd> <dt>lambda2</dt><dd><p>As input.</p></dd>
<dt>eta</dt><dd><p>As input.</p></dd> <dt>ratio</dt><dd><p>As input.</p></dd> <dt>gamma</dt><dd><p>As input.</p></dd>
<dt>alpha</dt><dd><p>As input.</p></dd> <dt>beta</dt><dd><p>As input.</p></dd> <dt>sided</dt><dd><p>As input.</p></dd>
<dt>Ts</dt><dd><p>As input.</p></dd> <dt>Tr</dt><dd><p>As input.</p></dd>

nEvents produces a scalar or vector of sample sizes (or powers) when
tbl=FALSE or, when tbl=TRUE a data frame of values with the
following columns: <dt>hr</dt><dd><p>As input.</p></dd> <dt>n</dt><dd><p>If <code>n[1]=0</code> on input
(default), output contains the number of events need to obtain the input
Type I and II error. If <code>n[1]&gt;0</code> on input, the input value is
returned.</p></dd> <dt>alpha</dt><dd><p>As input.</p></dd> <dt>beta</dt><dd><p>If <code>n[1]=0</code> on input
(default), <code>beta</code> is output as input. Otherwise, this is the computed
Type II error based on the input <code>n</code>.</p></dd> <dt>Power</dt><dd><p>One minus the
output <code>beta</code>. When <code>tbl=FALSE, n[1]&gt;0</code>, this is the value or
vector of values returned.</p></dd> <dt>delta</dt><dd><p>Standardized effect size
represented by input difference between null and alternative hypothesis
hazard ratios.</p></dd> <dt>ratio</dt><dd><p>Ratio of experimental to control sample size
where 'experimental' is the same as the group with hazard represented in the
numerator of the hazard ratio.</p></dd> <dt>se</dt><dd><p>Estimated standard error for the
observed log(hazard ratio) with the given sample size.</p></dd>

hrz2n outputs a number of events required to approximately have the
input hazard ratio, z-statistic and sample size correspond. hrn2z
outputs an approximate z-statistic corresponding to an input hazard ratio
and number of events. zn2hr outputs an approximate hazard ratio
corresponding to an input z-statistic and number of events.

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Lachin JM and Foulkes MA (1986), Evaluation of Sample Size and
Power for Analyses of Survival with Allowance for Nonuniform Patient Entry,
Losses to Follow-Up, Noncompliance, and Stratification. <em>Biometrics</em>,
42, 507-519.</p>
<p>Schoenfeld D (1981), The Asymptotic Properties of Nonparametric Tests for
Comparing Survival Distributions. <em>Biometrika</em>, 68, 316-319.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='gsDesign-package-overview.html'>gsDesign package overview</a>, <a href='plot.gsDesign.html'>plot.gsDesign</a>, 
<a href='gsDesign.html'>gsDesign</a>, <a href='gsBoundSummary.html'>gsHR</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='fu'><a href='https://rdrr.io/r/base/library.html'>library</a></span>(<span class='no'>ggplot2</span>)

<span class='co'># consider a trial with</span>
<span class='co'># 2 year maximum follow-up</span>
<span class='co'># 6 month uniform enrollment</span>
<span class='co'># Treatment/placebo hazards = 0.1/0.2 per 1 person-year</span>
<span class='co'># drop out hazard 0.1 per 1 person-year</span>
<span class='co'># alpha = 0.025 (1-sided)</span>
<span class='co'># power = 0.9 (default beta=.1)</span>

<span class='no'>ss</span> <span class='kw'>&lt;-</span> <span class='fu'>nSurvival</span>(
  <span class='kw'>lambda1</span> <span class='kw'>=</span> <span class='fl'>.2</span>, <span class='kw'>lambda2</span> <span class='kw'>=</span> <span class='fl'>.1</span>, <span class='kw'>eta</span> <span class='kw'>=</span> <span class='fl'>.1</span>, <span class='kw'>Ts</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>Tr</span> <span class='kw'>=</span> <span class='fl'>.5</span>,
  <span class='kw'>sided</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>alpha</span> <span class='kw'>=</span> <span class='fl'>.025</span>
)

<span class='co'>#  group sequential translation with default bounds</span>
<span class='co'>#  note that delta1 is log hazard ratio; used later in gsBoundSummary summary</span>
<span class='no'>x</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='gsDesign.html'>gsDesign</a></span>(
  <span class='kw'>k</span> <span class='kw'>=</span> <span class='fl'>5</span>, <span class='kw'>test.type</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>n.fix</span> <span class='kw'>=</span> <span class='no'>ss</span>$<span class='no'>nEvents</span>, <span class='kw'>nFixSurv</span> <span class='kw'>=</span> <span class='no'>ss</span>$<span class='no'>n</span>,
  <span class='kw'>delta1</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Log.html'>log</a></span>(<span class='no'>ss</span>$<span class='no'>lambda2</span> / <span class='no'>ss</span>$<span class='no'>lambda1</span>)
)
<span class='co'># boundary plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>x</span>)</div><div class='img'><img src='nSurvival-1.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># effect size plot</span>
<span class='fu'><a href='https://rdrr.io/r/graphics/plot.html'>plot</a></span>(<span class='no'>x</span>, <span class='kw'>plottype</span> <span class='kw'>=</span> <span class='st'>"hr"</span>)</div><div class='img'><img src='nSurvival-2.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># total sample size</span>
<span class='no'>x</span>$<span class='no'>nSurv</span></div><div class='output co'>#&gt; [1] 440</div><div class='input'><span class='co'># number of events at analyses</span>
<span class='no'>x</span>$<span class='no'>n.I</span></div><div class='output co'>#&gt; [1] 18.44213 36.88425 55.32638 73.76850 92.21063</div><div class='input'><span class='co'># print the design</span>
<span class='no'>x</span></div><div class='output co'>#&gt; Group sequential design sample size for time-to-event outcome
#&gt; with sample size 440. The analysis plan below shows events
#&gt; at each analysis.
#&gt; Symmetric two-sided group sequential design with
#&gt; 90 % power and 2.5 % Type I Error.
#&gt; Spending computations assume trial stops
#&gt; if a bound is crossed.
#&gt; 
#&gt;              
#&gt;   Analysis N   Z   Nominal p  Spend
#&gt;          1 19 3.25    0.0006 0.0006
#&gt;          2 37 2.99    0.0014 0.0013
#&gt;          3 56 2.69    0.0036 0.0028
#&gt;          4 74 2.37    0.0088 0.0063
#&gt;          5 93 2.03    0.0214 0.0140
#&gt;      Total                   0.0250 
#&gt; 
#&gt; ++ alpha spending:
#&gt;  Hwang-Shih-DeCani spending function with gamma = -4.
#&gt; 
#&gt; Boundary crossing probabilities and expected sample size
#&gt; assume any cross stops the trial
#&gt; 
#&gt; Upper boundary (power or Type I Error)
#&gt;           Analysis
#&gt;    Theta      1      2      3      4      5 Total E{N}
#&gt;   0.0000 0.0006 0.0013 0.0028 0.0063 0.0140 0.025 91.5
#&gt;   0.3415 0.0370 0.1512 0.2647 0.2699 0.1771 0.900 66.4
#&gt; 
#&gt; Lower boundary (futility or Type II Error)
#&gt;           Analysis
#&gt;    Theta     1      2      3      4     5 Total
#&gt;   0.0000 6e-04 0.0013 0.0028 0.0063 0.014 0.025
#&gt;   0.3415 0e+00 0.0000 0.0000 0.0000 0.000 0.000</div><div class='input'><span class='co'># overall design summary</span>
<span class='fu'><a href='https://rdrr.io/r/base/cat.html'>cat</a></span>(<span class='fu'><a href='https://rdrr.io/r/base/summary.html'>summary</a></span>(<span class='no'>x</span>))</div><div class='output co'>#&gt; Symmetric two-sided group sequential design with 5 analyses, time-to-event outcome with sample size 440 and 93 events required, 90 percent power, 2.5 percent (1-sided) Type I error. Bounds derived using a  Hwang-Shih-DeCani spending function with gamma = -4.</div><div class='input'><span class='co'># tabular summary of bounds</span>
<span class='fu'><a href='gsBoundSummary.html'>gsBoundSummary</a></span>(<span class='no'>x</span>, <span class='kw'>deltaname</span> <span class='kw'>=</span> <span class='st'>"HR"</span>, <span class='kw'>Nname</span> <span class='kw'>=</span> <span class='st'>"Events"</span>, <span class='kw'>logdelta</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;    Analysis              Value Efficacy Futility
#&gt;   IA 1: 20%                  Z   3.2527  -3.2527
#&gt;  Events: 19        p (1-sided)   0.0006   0.0006
#&gt;                   ~HR at bound   0.2198   4.5487
#&gt;               P(Cross) if HR=1   0.0006   0.0006
#&gt;             P(Cross) if HR=0.5   0.0370   0.0000
#&gt;   IA 2: 40%                  Z   2.9860  -2.9860
#&gt;  Events: 37        p (1-sided)   0.0014   0.0014
#&gt;                   ~HR at bound   0.3741   2.6734
#&gt;               P(Cross) if HR=1   0.0018   0.0018
#&gt;             P(Cross) if HR=0.5   0.1883   0.0000
#&gt;   IA 3: 60%                  Z   2.6917  -2.6917
#&gt;  Events: 56        p (1-sided)   0.0036   0.0036
#&gt;                   ~HR at bound   0.4849   2.0621
#&gt;               P(Cross) if HR=1   0.0047   0.0047
#&gt;             P(Cross) if HR=0.5   0.4530   0.0000
#&gt;   IA 4: 80%                  Z   2.3737  -2.3737
#&gt;  Events: 74        p (1-sided)   0.0088   0.0088
#&gt;                   ~HR at bound   0.5754   1.7380
#&gt;               P(Cross) if HR=1   0.0110   0.0110
#&gt;             P(Cross) if HR=0.5   0.7229   0.0000
#&gt;       Final                  Z   2.0253  -2.0253
#&gt;  Events: 93        p (1-sided)   0.0214   0.0214
#&gt;                   ~HR at bound   0.6558   1.5247
#&gt;               P(Cross) if HR=1   0.0250   0.0250
#&gt;             P(Cross) if HR=0.5   0.9000   0.0000</div><div class='input'>


<span class='co'># approximate number of events required using Schoenfeld's method</span>
<span class='co'># for 2 different hazard ratios</span>
<span class='fu'>nEvents</span>(<span class='kw'>hr</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.5</span>, <span class='fl'>.6</span>), <span class='kw'>tbl</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;    hr   n alpha sided beta Power     delta ratio hr0        se
#&gt; 1 0.5  88 0.025     1  0.1   0.9 0.3465736     1   1 0.2132007
#&gt; 2 0.6 162 0.025     1  0.1   0.9 0.2554128     1   1 0.1571348</div><div class='input'><span class='co'># vector output</span>
<span class='fu'>nEvents</span>(<span class='kw'>hr</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>.5</span>, <span class='fl'>.6</span>))</div><div class='output co'>#&gt; [1]  87.4793 161.0686</div><div class='input'>
<span class='co'># approximate power using Schoenfeld's method</span>
<span class='co'># given 2 sample sizes and hr=.6</span>
<span class='fu'>nEvents</span>(<span class='kw'>hr</span> <span class='kw'>=</span> <span class='fl'>.6</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>50</span>, <span class='fl'>100</span>), <span class='kw'>tbl</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)</div><div class='output co'>#&gt;    hr   n alpha sided      beta     Power     delta ratio hr0        se
#&gt; 1 0.6  50 0.025     1 0.5611646 0.4388354 0.2554128     1   1 0.2828427
#&gt; 2 0.6 100 0.025     1 0.2762012 0.7237988 0.2554128     1   1 0.2000000</div><div class='input'><span class='co'># vector output</span>
<span class='fu'>nEvents</span>(<span class='kw'>hr</span> <span class='kw'>=</span> <span class='fl'>.6</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span>(<span class='fl'>50</span>, <span class='fl'>100</span>))</div><div class='output co'>#&gt; [1] 0.4388354 0.7237988</div><div class='input'>
<span class='co'># approximate hazard ratio corresponding to 100 events and z-statistic of 2</span>
<span class='fu'>zn2hr</span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>z</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='output co'>#&gt; [1] 0.67032</div><div class='input'><span class='co'># same when hr0 is 1.1</span>
<span class='fu'>zn2hr</span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>z</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>hr0</span> <span class='kw'>=</span> <span class='fl'>1.1</span>)</div><div class='output co'>#&gt; [1] 0.7373521</div><div class='input'><span class='co'># same when hr0 is .9 and hr1 is greater than hr0</span>
<span class='fu'>zn2hr</span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>z</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>hr0</span> <span class='kw'>=</span> <span class='fl'>.9</span>, <span class='kw'>hr1</span> <span class='kw'>=</span> <span class='fl'>1</span>)</div><div class='output co'>#&gt; [1] 1.342642</div><div class='input'>
<span class='co'># approximate number of events corresponding to z-statistic of 2 and</span>
<span class='co'># estimated hazard ratio of .5 (or 2)</span>
<span class='fu'>hrz2n</span>(<span class='kw'>hr</span> <span class='kw'>=</span> <span class='fl'>.5</span>, <span class='kw'>z</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='output co'>#&gt; [1] 33.3019</div><div class='input'><span class='fu'>hrz2n</span>(<span class='kw'>hr</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>z</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='output co'>#&gt; [1] 33.3019</div><div class='input'>
<span class='co'># approximate z statistic corresponding to 75 events</span>
<span class='co'># and estimated hazard ratio of .6 (or 1/.6)</span>
<span class='co'># assuming 2-to-1 randomization of experimental to control</span>
<span class='fu'>hrn2z</span>(<span class='kw'>hr</span> <span class='kw'>=</span> <span class='fl'>.6</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>75</span>, <span class='kw'>ratio</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='output co'>#&gt; [1] -2.085437</div><div class='input'><span class='fu'>hrn2z</span>(<span class='kw'>hr</span> <span class='kw'>=</span> <span class='fl'>1</span> / <span class='fl'>.6</span>, <span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>75</span>, <span class='kw'>ratio</span> <span class='kw'>=</span> <span class='fl'>2</span>)</div><div class='output co'>#&gt; [1] 2.085437</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Keaven Anderson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


