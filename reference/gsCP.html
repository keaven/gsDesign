<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="gsCP() computes conditional boundary crossing probabilities at future
planned analyses for a given group sequential design assuming an interim
z-statistic at a specified interim analysis. While gsCP() is designed
toward computing conditional power for a variety of underlying parameter
values, condPower is built to compute conditional power for a
variety of interim test statistic values which is useful for sample size
adaptation (see ssrCP). gsPP() averages conditional
power across a posterior distribution to compute predictive power.
gsPI() computes Bayesian prediction intervals for future analyses
corresponding to results produced by gsPP().  gsPosterior()
computes the posterior density for the group sequential design parameter of
interest given a prior density and an interim outcome that is exact or in an
interval. gsPOS() computes the probability of success for a trial
using a prior distribution to average power over a set of theta
values of interest. gsCPOS() assumes no boundary has been crossed
before and including an interim analysis of interest, and computes the
probability of success based on this event. Note that gsCP() and
gsPP() take only the interim test statistic into account in computing
conditional probabilities, while gsCPOS() conditions on not crossing
any bound through a specified interim analysis.
See Conditional power section of manual for further clarification. See also
Muller and Schaffer (2001) for background theory.
For gsPP(), gsPI(), gsPOS() and gsCPOS(), the
prior distribution for the standardized parameter theta () for a
group sequential design specified through a gsDesign object is specified
through the arguments theta and wgts. This can be a discrete
or a continuous probability density function. For a discrete function,
generally all weights would be 1. For a continuous density, the wgts
would contain integration grid weights, such as those provided by
normalGrid.
For gsPosterior, a prior distribution in prior must be
composed of the vectors z density.  The vector z
contains points where the prior is evaluated and density the
corresponding density or, for a discrete distribution, the probabilities of
each point in z. Densities may be supplied as from
normalGrid() where grid weights for numerical integration are
supplied in gridwgts. If gridwgts are not supplied, they are
defaulted to 1 (equal weighting). To ensure a proper prior distribution, you
must have sum(gridwgts * density) equal to 1; this is NOT checked,
however."><title>Conditional and Predictive Power, Overall and Conditional Probability of Success — gsCP • gsDesign</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.1.0/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.1.0/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.rawgit.com/afeld/bootstrap-toc/v1.0.1/dist/bootstrap-toc.min.js"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Conditional and Predictive Power, Overall and Conditional Probability of Success — gsCP"><meta property="og:description" content="gsCP() computes conditional boundary crossing probabilities at future
planned analyses for a given group sequential design assuming an interim
z-statistic at a specified interim analysis. While gsCP() is designed
toward computing conditional power for a variety of underlying parameter
values, condPower is built to compute conditional power for a
variety of interim test statistic values which is useful for sample size
adaptation (see ssrCP). gsPP() averages conditional
power across a posterior distribution to compute predictive power.
gsPI() computes Bayesian prediction intervals for future analyses
corresponding to results produced by gsPP().  gsPosterior()
computes the posterior density for the group sequential design parameter of
interest given a prior density and an interim outcome that is exact or in an
interval. gsPOS() computes the probability of success for a trial
using a prior distribution to average power over a set of theta
values of interest. gsCPOS() assumes no boundary has been crossed
before and including an interim analysis of interest, and computes the
probability of success based on this event. Note that gsCP() and
gsPP() take only the interim test statistic into account in computing
conditional probabilities, while gsCPOS() conditions on not crossing
any bound through a specified interim analysis.
See Conditional power section of manual for further clarification. See also
Muller and Schaffer (2001) for background theory.
For gsPP(), gsPI(), gsPOS() and gsCPOS(), the
prior distribution for the standardized parameter theta () for a
group sequential design specified through a gsDesign object is specified
through the arguments theta and wgts. This can be a discrete
or a continuous probability density function. For a discrete function,
generally all weights would be 1. For a continuous density, the wgts
would contain integration grid weights, such as those provided by
normalGrid.
For gsPosterior, a prior distribution in prior must be
composed of the vectors z density.  The vector z
contains points where the prior is evaluated and density the
corresponding density or, for a discrete distribution, the probabilities of
each point in z. Densities may be supplied as from
normalGrid() where grid weights for numerical integration are
supplied in gridwgts. If gridwgts are not supplied, they are
defaulted to 1 (equal weighting). To ensure a proper prior distribution, you
must have sum(gridwgts * density) equal to 1; this is NOT checked,
however."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">gsDesign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.2.1.9000</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../articles/index.html">Articles</a>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/keaven/gsDesign/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="" class="logo" alt=""><h1>Conditional and Predictive Power, Overall and Conditional Probability of Success</h1>
      <small class="dont-index">Source: <a href="https://github.com/keaven/gsDesign/blob/HEAD/R/gsCP.R" class="external-link"><code>R/gsCP.R</code></a></small>
      <div class="d-none name"><code>gsCP.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>gsCP()</code> computes conditional boundary crossing probabilities at future
planned analyses for a given group sequential design assuming an interim
z-statistic at a specified interim analysis. While <code>gsCP()</code> is designed
toward computing conditional power for a variety of underlying parameter
values, <code><a href="ssrCP.html">condPower</a></code> is built to compute conditional power for a
variety of interim test statistic values which is useful for sample size
adaptation (see <code><a href="ssrCP.html">ssrCP</a></code>). <code>gsPP()</code> averages conditional
power across a posterior distribution to compute predictive power.
<code>gsPI()</code> computes Bayesian prediction intervals for future analyses
corresponding to results produced by <code>gsPP()</code>.  <code>gsPosterior()</code>
computes the posterior density for the group sequential design parameter of
interest given a prior density and an interim outcome that is exact or in an
interval. <code>gsPOS()</code> computes the probability of success for a trial
using a prior distribution to average power over a set of <code>theta</code>
values of interest. <code>gsCPOS()</code> assumes no boundary has been crossed
before and including an interim analysis of interest, and computes the
probability of success based on this event. Note that <code>gsCP()</code> and
<code>gsPP()</code> take only the interim test statistic into account in computing
conditional probabilities, while <code>gsCPOS()</code> conditions on not crossing
any bound through a specified interim analysis.</p>
<p>See Conditional power section of manual for further clarification. See also
Muller and Schaffer (2001) for background theory.</p>
<p>For <code>gsPP()</code>, <code>gsPI()</code>, <code>gsPOS()</code> and <code>gsCPOS()</code>, the
prior distribution for the standardized parameter <code>theta</code> () for a
group sequential design specified through a gsDesign object is specified
through the arguments <code>theta</code> and <code>wgts</code>. This can be a discrete
or a continuous probability density function. For a discrete function,
generally all weights would be 1. For a continuous density, the <code>wgts</code>
would contain integration grid weights, such as those provided by
<a href="normalGrid.html">normalGrid</a>.</p>
<p>For <code>gsPosterior</code>, a prior distribution in <code>prior</code> must be
composed of the vectors <code>z</code> <code>density</code>.  The vector <code>z</code>
contains points where the prior is evaluated and <code>density</code> the
corresponding density or, for a discrete distribution, the probabilities of
each point in <code>z</code>. Densities may be supplied as from
<code><a href="normalGrid.html">normalGrid()</a></code> where grid weights for numerical integration are
supplied in <code>gridwgts</code>. If <code>gridwgts</code> are not supplied, they are
defaulted to 1 (equal weighting). To ensure a proper prior distribution, you
must have <code>sum(gridwgts * density)</code> equal to 1; this is NOT checked,
however.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="fu">gsCP</span><span class="op">(</span><span class="va">x</span>, theta <span class="op">=</span> <span class="cn">NULL</span>, i <span class="op">=</span> <span class="fl">1</span>, zi <span class="op">=</span> <span class="fl">0</span>, r <span class="op">=</span> <span class="fl">18</span><span class="op">)</span>

<span class="fu">gsPP</span><span class="op">(</span>
  <span class="va">x</span>,
  i <span class="op">=</span> <span class="fl">1</span>,
  zi <span class="op">=</span> <span class="fl">0</span>,
  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,
  wgts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,
  r <span class="op">=</span> <span class="fl">18</span>,
  total <span class="op">=</span> <span class="cn">TRUE</span>
<span class="op">)</span>

<span class="fu">gsPI</span><span class="op">(</span>
  <span class="va">x</span>,
  i <span class="op">=</span> <span class="fl">1</span>,
  zi <span class="op">=</span> <span class="fl">0</span>,
  j <span class="op">=</span> <span class="fl">2</span>,
  level <span class="op">=</span> <span class="fl">0.95</span>,
  theta <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">3</span><span class="op">)</span>,
  wgts <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>
<span class="op">)</span>

<span class="fu">gsPosterior</span><span class="op">(</span>x <span class="op">=</span> <span class="fu"><a href="gsDesign.html">gsDesign</a></span><span class="op">(</span><span class="op">)</span>, i <span class="op">=</span> <span class="fl">1</span>, zi <span class="op">=</span> <span class="cn">NULL</span>, prior <span class="op">=</span> <span class="fu"><a href="normalGrid.html">normalGrid</a></span><span class="op">(</span><span class="op">)</span>, r <span class="op">=</span> <span class="fl">18</span><span class="op">)</span>

<span class="fu">gsPOS</span><span class="op">(</span><span class="va">x</span>, <span class="va">theta</span>, <span class="va">wgts</span><span class="op">)</span>

<span class="fu">gsCPOS</span><span class="op">(</span><span class="va">i</span>, <span class="va">x</span>, <span class="va">theta</span>, <span class="va">wgts</span><span class="op">)</span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>x</dt>
<dd><p>An object of type <code>gsDesign</code> or <code>gsProbability</code></p></dd>
<dt>theta</dt>
<dd><p>a vector with \(\theta\) value(s) at which conditional
power is to be computed; for <code>gsCP()</code> if <code>NULL</code>, an estimated
value of \(\theta\) based on the interim test statistic
(<code>zi/sqrt(x$n.I[i])</code>) as well as at <code>x$theta</code> is computed. For
<code>gsPosterior</code>, this may be a scalar or an interval; for <code>gsPP</code> and
<code>gsCP</code>, this must be a scalar.</p></dd>
<dt>i</dt>
<dd><p>analysis at which interim z-value is given; must be from 1 to
<code>x$k-1</code></p></dd>
<dt>zi</dt>
<dd><p>interim z-value at analysis i (scalar)</p></dd>
<dt>r</dt>
<dd><p>Integer value controlling grid for numerical integration as in
Jennison and Turnbull (2000); default is 18, range is 1 to 80.  Larger
values provide larger number of grid points and greater accuracy.  Normally
<code>r</code> will not be changed by the user.</p></dd>
<dt>wgts</dt>
<dd><p>Weights to be used with grid points in <code>theta</code>. Length can
be one if weights are equal, otherwise should be the same length as
<code>theta</code>. Values should be positive, but do not need to sum to 1.</p></dd>
<dt>total</dt>
<dd><p>The default of <code>total=TRUE</code> produces the combined
probability for all planned analyses after the interim analysis specified in
<code>i</code>. Otherwise, information on each analysis is provided separately.</p></dd>
<dt>j</dt>
<dd><p>specific analysis for which prediction is being made; must be
<code>&gt;i</code> and no more than <code>x$k</code></p></dd>
<dt>level</dt>
<dd><p>The level to be used for Bayes credible intervals (which
approach confidence intervals for vague priors). The default
<code>level=.95</code> corresponds to a 95% credible interval. <code>level=0</code>
provides a point estimate rather than an interval.</p></dd>
<dt>prior</dt>
<dd><p>provides a prior distribution in the form produced by
<code><a href="normalGrid.html">normalGrid</a></code></p></dd>
</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p><code>gsCP()</code> returns an object of the class <code>gsProbability</code>.
Based on the input design and the interim test statistic, the output
gsDesign object has bounds for test statistics computed based on solely on
observations after interim <code>i</code>.  Boundary crossing probabilities are
computed for the input \(\theta\) values. See manual and examples.
<code>gsPP()</code> if total==TRUE, returns a real value indicating the predictive
power of the trial conditional on the interim test statistic <code>zi</code> at
analysis <code>i</code>; otherwise returns vector with predictive power for each
future planned analysis.
<code>gsPI()</code> returns an interval (or point estimate if <code>level=0</code>)
indicating 100<code>level</code>% credible interval for the z-statistic at
analysis <code>j</code> conditional on the z-statistic at analysis <code>i&lt;j</code>.
The interval does not consider intervending interim analyses. The
probability estimate is based on the predictive distribution used for
<code>gsPP()</code> and requires a prior distribution for the group sequential
parameter <code>theta</code> specified in <code>theta</code> and <code>wgts</code>.
<code>gsPosterior()</code> returns a posterior distribution containing the the
vector <code>z</code> input in <code>prior$z</code>, the posterior density in
<code>density</code>, grid weights for integrating the posterior density as input
in <code>prior$gridwgts</code> or defaulted to a vector of ones, and the product
of the output values in <code>density</code> and <code>gridwgts</code> in <code>wgts</code>.
<code>gsPOS()</code> returns a real value indicating the probability of a positive
study weighted by the prior distribution input for <code>theta</code>.
<code>gsCPOS()</code> returns a real value indicating the probability of a
positive study weighted by the posterior distribution derived from the
interim test statistic and the prior distribution input for <code>theta</code>conditional on an interim test statistic.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The manual is not linked to this help file, but is available in
library/gsdesign/doc/gsDesignManual.pdf in the directory where R is
installed.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jennison C and Turnbull BW (2000), <em>Group Sequential
Methods with Applications to Clinical Trials</em>. Boca Raton: Chapman and Hall.</p>
<p>Proschan, Michael A., Lan, KK Gordon and Wittes, Janet Turk (2006),
<em>Statistical Monitoring of Clinical Trials</em>. NY: Springer.</p>
<p>Muller, Hans-Helge and Schaffer, Helmut (2001), Adaptive group sequential
designs for clinical trials: combining the advantages of adaptive and
classical group sequential approaches. <em>Biometrics</em>;57:886-891.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="normalGrid.html">normalGrid</a></code>, <code><a href="gsDesign.html">gsDesign</a></code>,
<code><a href="gsProbability.html">gsProbability</a></code>, <code><a href="gsBoundCP.html">gsBoundCP</a></code>, <code><a href="ssrCP.html">ssrCP</a></code>,
<code><a href="ssrCP.html">condPower</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Keaven Anderson <a href="mailto:keaven%5C_anderson@merck.">keaven\_anderson@merck.</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org" class="external-link">ggplot2</a></span><span class="op">)</span></span>
<span class="r-in"><span class="co"># set up a group sequential design</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="gsDesign.html">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span>
<span class="r-in"><span class="va">x</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymmetric two-sided group sequential design with</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90 % power and 2.5 % Type I Error.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound spending computations assume</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trial continues if lower bound is crossed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Sample</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Size    ----Lower bounds----  ----Upper bounds-----</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Analysis Ratio*   Z   Nominal p Spend+  Z   Nominal p Spend++</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1  0.220 -0.90    0.1836 0.0077 3.25    0.0006  0.0006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          2  0.441 -0.04    0.4853 0.0115 2.99    0.0014  0.0013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          3  0.661  0.69    0.7563 0.0171 2.69    0.0036  0.0028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          4  0.881  1.36    0.9131 0.0256 2.37    0.0088  0.0063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          5  1.101  2.03    0.9786 0.0381 2.03    0.0214  0.0140</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Total                        0.1000                 0.0250 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + lower bound beta spending (under H1):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hwang-Shih-DeCani spending function with gamma = -2.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ++ alpha spending:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hwang-Shih-DeCani spending function with gamma = -4.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Sample size ratio compared to fixed design with no interim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Boundary crossing probabilities and expected sample size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assume any cross stops the trial</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary (power or Type I Error)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Theta      1      2      3      4      5  Total   E{N}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.0000 0.0006 0.0013 0.0028 0.0062 0.0117 0.0226 0.5726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3.2415 0.0417 0.1679 0.2806 0.2654 0.1444 0.9000 0.7440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary (futility or Type II Error)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Theta      1      2      3      4      5  Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.0000 0.1836 0.3201 0.2700 0.1477 0.0559 0.9774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3.2415 0.0077 0.0115 0.0171 0.0256 0.0381 0.1000</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># set up a prior distribution for the treatment effect</span></span>
<span class="r-in"><span class="co"># that is normal with mean .75*x$delta and standard deviation x$delta/2</span></span>
<span class="r-in"><span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">.75</span> <span class="op">*</span> <span class="va">x</span><span class="op">$</span><span class="va">delta</span></span>
<span class="r-in"><span class="va">sigma0</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">delta</span> <span class="op">/</span> <span class="fl">2</span></span>
<span class="r-in"><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="normalGrid.html">normalGrid</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="va">mu0</span>, sigma <span class="op">=</span> <span class="va">sigma0</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># compute POS for the design given the above prior distribution for theta</span></span>
<span class="r-in"><span class="fu">gsPOS</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, theta <span class="op">=</span> <span class="va">prior</span><span class="op">$</span><span class="va">z</span>, wgts <span class="op">=</span> <span class="va">prior</span><span class="op">$</span><span class="va">wgts</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5954771</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># assume POS should only count cases in prior where theta &gt;= x$delta/2</span></span>
<span class="r-in"><span class="fu">gsPOS</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, theta <span class="op">=</span> <span class="va">prior</span><span class="op">$</span><span class="va">z</span>, wgts <span class="op">=</span> <span class="va">prior</span><span class="op">$</span><span class="va">wgts</span> <span class="op">*</span> <span class="op">(</span><span class="va">prior</span><span class="op">$</span><span class="va">z</span> <span class="op">&gt;=</span> <span class="va">x</span><span class="op">$</span><span class="va">delta</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.5554313</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># assuming a z-value at lower bound at analysis 2, what are conditional</span></span>
<span class="r-in"><span class="co"># boundary crossing probabilities for future analyses</span></span>
<span class="r-in"><span class="co"># assuming theta values from x as well as a value based on the interim</span></span>
<span class="r-in"><span class="co"># observed z</span></span>
<span class="r-in"><span class="va">CP</span> <span class="op">&lt;-</span> <span class="fu">gsCP</span><span class="op">(</span><span class="va">x</span>, i <span class="op">=</span> <span class="fl">2</span>, zi <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">lower</span><span class="op">$</span><span class="va">bound</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"><span class="va">CP</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>               Lower bounds   Upper bounds</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Analysis N   Z   Nominal p  Z   Nominal p</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1  1 1.25    0.8952 4.71    0.0000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          2  1 1.96    0.9750 3.39    0.0003</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          3  1 2.64    0.9959 2.64    0.0041</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Boundary crossing probabilities and expected sample size assume</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> any cross stops the trial</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary (power or Type I Error)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Theta     1      2      3  Total E{N}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -0.0554 0e+00 0.0003 0.0019 0.0022  0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0.0000 0e+00 0.0003 0.0022 0.0026  0.2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3.2415 7e-04 0.1038 0.2631 0.3677  0.4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary (futility or Type II Error)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     Theta      1      2      3  Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   -0.0554 0.8999 0.0841 0.0138 0.9978</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    0.0000 0.8952 0.0872 0.0150 0.9974</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    3.2415 0.3950 0.1368 0.1006 0.6323</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># summing values for crossing future upper bounds gives overall</span></span>
<span class="r-in"><span class="co"># conditional power for each theta value</span></span>
<span class="r-in"><span class="va">CP</span><span class="op">$</span><span class="va">theta</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.05536767  0.00000000  3.24151555</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/t.html" class="external-link">t</a></span><span class="op">(</span><span class="va">CP</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">prob</span><span class="op">)</span> <span class="op"><a href="https://rdrr.io/r/base/matmult.html" class="external-link">%*%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             [,1]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.002238566</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.002561570</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.367657693</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># compute predictive probability based on above assumptions</span></span>
<span class="r-in"><span class="fu">gsPP</span><span class="op">(</span><span class="va">x</span>, i <span class="op">=</span> <span class="fl">2</span>, zi <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">lower</span><span class="op">$</span><span class="va">bound</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span>, theta <span class="op">=</span> <span class="va">prior</span><span class="op">$</span><span class="va">z</span>, wgts <span class="op">=</span> <span class="va">prior</span><span class="op">$</span><span class="va">wgts</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.06730167</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># if it is known that boundary not crossed at interim 2, use</span></span>
<span class="r-in"><span class="co"># gsCPOS to compute conditional POS based on this</span></span>
<span class="r-in"><span class="fu">gsCPOS</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, i <span class="op">=</span> <span class="fl">2</span>, theta <span class="op">=</span> <span class="va">prior</span><span class="op">$</span><span class="va">z</span>, wgts <span class="op">=</span> <span class="va">prior</span><span class="op">$</span><span class="va">wgts</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.6114033</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># 2-stage example to compare results to direct computation</span></span>
<span class="r-in"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="gsDesign.html">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="va">z1</span> <span class="op">&lt;-</span> <span class="fl">0.5</span></span>
<span class="r-in"><span class="va">n1</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span class="r-in"><span class="va">n2</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">-</span> <span class="va">x</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span></span>
<span class="r-in"><span class="va">thetahat</span> <span class="op">&lt;-</span> <span class="va">z1</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n1</span><span class="op">)</span></span>
<span class="r-in"><span class="va">theta</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">thetahat</span>, <span class="fl">0</span>, <span class="va">x</span><span class="op">$</span><span class="va">delta</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># conditional power direct computation - comparison w gsCP</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="op">(</span><span class="va">n2</span> <span class="op">*</span> <span class="va">theta</span> <span class="op">+</span> <span class="va">z1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n1</span><span class="op">)</span> <span class="op">-</span> <span class="va">x</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n1</span> <span class="op">+</span> <span class="va">n2</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">n2</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.03579292 0.01067483 0.51555676</span>
<span class="r-in"></span>
<span class="r-in"><span class="fu">gsCP</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, zi <span class="op">=</span> <span class="va">z1</span>, i <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">prob</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            [,1]       [,2]      [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.03579292 0.01067483 0.5155568</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># predictive power direct computation - comparison w gsPP</span></span>
<span class="r-in"><span class="co"># use same prior as above</span></span>
<span class="r-in"><span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">.75</span> <span class="op">*</span> <span class="va">x</span><span class="op">$</span><span class="va">delta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-in"><span class="va">sigma2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">.5</span> <span class="op">*</span> <span class="va">x</span><span class="op">$</span><span class="va">delta</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">*</span> <span class="va">x</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span></span>
<span class="r-in"><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="normalGrid.html">normalGrid</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="fl">.75</span> <span class="op">*</span> <span class="va">x</span><span class="op">$</span><span class="va">delta</span>, sigma <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">delta</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span></span>
<span class="r-in"><span class="fu">gsPP</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, zi <span class="op">=</span> <span class="va">z1</span>, i <span class="op">=</span> <span class="fl">1</span>, theta <span class="op">=</span> <span class="va">prior</span><span class="op">$</span><span class="va">z</span>, wgts <span class="op">=</span> <span class="va">prior</span><span class="op">$</span><span class="va">wgts</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1556447</span>
<span class="r-in"><span class="va">t</span> <span class="op">&lt;-</span> <span class="fl">.5</span></span>
<span class="r-in"><span class="va">z1</span> <span class="op">&lt;-</span> <span class="fl">.5</span></span>
<span class="r-in"><span class="va">b</span> <span class="op">&lt;-</span> <span class="va">z1</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span></span>
<span class="r-in"><span class="co"># direct from Proschan, Lan and Wittes eqn 3.10</span></span>
<span class="r-in"><span class="co"># adjusted drift at n.I[2]</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">pnorm</a></span><span class="op">(</span><span class="op">(</span><span class="op">(</span><span class="va">b</span> <span class="op">-</span> <span class="va">x</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span><span class="op">[</span><span class="fl">2</span><span class="op">]</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">t</span> <span class="op">*</span> <span class="va">sigma2</span><span class="op">)</span> <span class="op">+</span></span>
<span class="r-in">  <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">t</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="va">mu0</span> <span class="op">+</span> <span class="va">b</span> <span class="op">*</span> <span class="va">sigma2</span><span class="op">)</span><span class="op">)</span> <span class="op">/</span></span>
<span class="r-in">  <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">t</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">sigma2</span><span class="op">)</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">t</span> <span class="op">*</span> <span class="va">sigma2</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 0.1556447</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># plot prior then posterior distribution for unblinded analysis with i=1, zi=1</span></span>
<span class="r-in"><span class="va">xp</span> <span class="op">&lt;-</span> <span class="fu">gsPosterior</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, i <span class="op">=</span> <span class="fl">1</span>, zi <span class="op">=</span> <span class="fl">1</span>, prior <span class="op">=</span> <span class="va">prior</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xp</span><span class="op">$</span><span class="va">z</span>, y <span class="op">=</span> <span class="va">xp</span><span class="op">$</span><span class="va">density</span>, type <span class="op">=</span> <span class="st">"l"</span>, col <span class="op">=</span> <span class="fl">2</span>, xlab <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="va">theta</span><span class="op">)</span>, ylab <span class="op">=</span> <span class="st">"Density"</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">z</span>, y <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">density</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># add posterior plot assuming only knowlede that interim bound has</span></span>
<span class="r-in"><span class="co"># not been crossed at interim 1</span></span>
<span class="r-in"><span class="va">xpb</span> <span class="op">&lt;-</span> <span class="fu">gsPosterior</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, i <span class="op">=</span> <span class="fl">1</span>, zi <span class="op">=</span> <span class="fl">1</span>, prior <span class="op">=</span> <span class="va">prior</span><span class="op">)</span></span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">xpb</span><span class="op">$</span><span class="va">z</span>, y <span class="op">=</span> <span class="va">xpb</span><span class="op">$</span><span class="va">density</span>, col <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span>
<span class="r-plt img"><img src="gsCP-1.png" alt="" width="700" height="433"></span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># prediction interval based in interim 1 results</span></span>
<span class="r-in"><span class="co"># start with point estimate, followed by 90% prediction interval</span></span>
<span class="r-in"><span class="fu">gsPI</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, i <span class="op">=</span> <span class="fl">1</span>, zi <span class="op">=</span> <span class="va">z1</span>, j <span class="op">=</span> <span class="fl">2</span>, theta <span class="op">=</span> <span class="va">prior</span><span class="op">$</span><span class="va">z</span>, wgts <span class="op">=</span> <span class="va">prior</span><span class="op">$</span><span class="va">wgts</span>, level <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 1.081745</span>
<span class="r-in"><span class="fu">gsPI</span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span>, i <span class="op">=</span> <span class="fl">1</span>, zi <span class="op">=</span> <span class="va">z1</span>, j <span class="op">=</span> <span class="fl">2</span>, theta <span class="op">=</span> <span class="va">prior</span><span class="op">$</span><span class="va">z</span>, wgts <span class="op">=</span> <span class="va">prior</span><span class="op">$</span><span class="va">wgts</span>, level <span class="op">=</span> <span class="fl">.9</span><span class="op">)</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] -0.3793133  2.5428090</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Keaven Anderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

    </footer></div>

  

  

  </body></html>

