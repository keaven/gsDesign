<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Truncated, trimmed and gapped spending functions — sfTruncated • gsDesign</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Truncated, trimmed and gapped spending functions — sfTruncated"><meta name="description" content="The functions sfTruncated() and sfTrimmed apply any other
spending function over a restricted range. This allows eliminating spending
for early interim analyses when you desire not to stop for the bound being
specified; this is usually applied to eliminate early tests for a positive
efficacy finding. The truncation can come late in the trial if you desire to
stop a trial any time after, say, 90 percent of information is available and
an analysis is performed. This allows full Type I error spending if the
final analysis occurs early. Both functions set cumulative spending to 0
below a 'spending interval' in the interval [0,1], and set cumulative
spending to 1 above this range. sfTrimmed() otherwise does not change
an input spending function that is specified; probably the preferred and
more intuitive method in most cases. sfTruncated() resets the time
scale on which the input spending function is computed to the 'spending
interval.'
sfGapped() allows elimination of analyses after some time point in
the trial; see details and examples.
sfTrimmed simply computes the value of the input spending function
and parameters in the sub-range of [0,1], sets spending to 0 below this
range and sets spending to 1 above this range.
sfGapped spends outside of the range provided in trange. Below
trange, the input spending function is used. Above trange, full spending is
used; i.e., the first analysis performed above the interval in trange is the
final analysis. As long as the input spending function is strictly
increasing, this means that the first interim in the interval trange is the
final interim analysis for the bound being specified.
sfTruncated compresses spending into a sub-range of [0,1]. The
parameter param$trange specifies the range over which spending is to
occur. Within this range, spending is spent according to the spending
function specified in param$sf along with the corresponding spending
function parameter(s) in param$param. See example using
sfLinear that spends uniformly over specified range."><meta property="og:description" content="The functions sfTruncated() and sfTrimmed apply any other
spending function over a restricted range. This allows eliminating spending
for early interim analyses when you desire not to stop for the bound being
specified; this is usually applied to eliminate early tests for a positive
efficacy finding. The truncation can come late in the trial if you desire to
stop a trial any time after, say, 90 percent of information is available and
an analysis is performed. This allows full Type I error spending if the
final analysis occurs early. Both functions set cumulative spending to 0
below a 'spending interval' in the interval [0,1], and set cumulative
spending to 1 above this range. sfTrimmed() otherwise does not change
an input spending function that is specified; probably the preferred and
more intuitive method in most cases. sfTruncated() resets the time
scale on which the input spending function is computed to the 'spending
interval.'
sfGapped() allows elimination of analyses after some time point in
the trial; see details and examples.
sfTrimmed simply computes the value of the input spending function
and parameters in the sub-range of [0,1], sets spending to 0 below this
range and sets spending to 1 above this range.
sfGapped spends outside of the range provided in trange. Below
trange, the input spending function is used. Above trange, full spending is
used; i.e., the first analysis performed above the interval in trange is the
final analysis. As long as the input spending function is strictly
increasing, this means that the first interim in the interval trange is the
final interim analysis for the bound being specified.
sfTruncated compresses spending into a sub-range of [0,1]. The
parameter param$trange specifies the range over which spending is to
occur. Within this range, spending is spent according to the spending
function specified in param$sf along with the corresponding spending
function parameter(s) in param$param. See example using
sfLinear that spends uniformly over specified range."><meta property="og:image" content="https://keaven.github.io/gsDesign/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gsDesign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.10.1</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/keaven/gsDesign/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Truncated, trimmed and gapped spending functions</h1>
      <small class="dont-index">Source: <a href="https://github.com/keaven/gsDesign/blob/master/R/gsSpending.R" class="external-link"><code>R/gsSpending.R</code></a></small>
      <div class="d-none name"><code>sfSpecial.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The functions <code>sfTruncated()</code> and <code>sfTrimmed</code> apply any other
spending function over a restricted range. This allows eliminating spending
for early interim analyses when you desire not to stop for the bound being
specified; this is usually applied to eliminate early tests for a positive
efficacy finding. The truncation can come late in the trial if you desire to
stop a trial any time after, say, 90 percent of information is available and
an analysis is performed. This allows full Type I error spending if the
final analysis occurs early. Both functions set cumulative spending to 0
below a 'spending interval' in the interval [0,1], and set cumulative
spending to 1 above this range. <code>sfTrimmed()</code> otherwise does not change
an input spending function that is specified; probably the preferred and
more intuitive method in most cases. <code>sfTruncated()</code> resets the time
scale on which the input spending function is computed to the 'spending
interval.'</p>
<p><code>sfGapped()</code> allows elimination of analyses after some time point in
the trial; see details and examples.</p>
<p><code>sfTrimmed</code> simply computes the value of the input spending function
and parameters in the sub-range of [0,1], sets spending to 0 below this
range and sets spending to 1 above this range.</p>
<p><code>sfGapped</code> spends outside of the range provided in trange. Below
trange, the input spending function is used. Above trange, full spending is
used; i.e., the first analysis performed above the interval in trange is the
final analysis. As long as the input spending function is strictly
increasing, this means that the first interim in the interval trange is the
final interim analysis for the bound being specified.</p>
<p><code>sfTruncated</code> compresses spending into a sub-range of [0,1]. The
parameter <code>param$trange</code> specifies the range over which spending is to
occur. Within this range, spending is spent according to the spending
function specified in <code>param$sf</code> along with the corresponding spending
function parameter(s) in <code>param$param</code>. See example using
<code>sfLinear</code> that spends uniformly over specified range.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">sfTruncated</span><span class="op">(</span><span class="va">alpha</span>, <span class="va">t</span>, <span class="va">param</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sfTrimmed</span><span class="op">(</span><span class="va">alpha</span>, <span class="va">t</span>, <span class="va">param</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">sfGapped</span><span class="op">(</span><span class="va">alpha</span>, <span class="va">t</span>, <span class="va">param</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-alpha">alpha<a class="anchor" aria-label="anchor" href="#arg-alpha"></a></dt>
<dd><p>Real value \(&gt; 0\) and no more than 1. Normally,
<code>alpha=0.025</code> for one-sided Type I error specification or
<code>alpha=0.1</code> for Type II error specification. However, this could be set
to 1 if for descriptive purposes you wish to see the proportion of spending
as a function of the proportion of sample size or information.</p></dd>


<dt id="arg-t">t<a class="anchor" aria-label="anchor" href="#arg-t"></a></dt>
<dd><p>A vector of points with increasing values from 0 to 1, inclusive.
Values of the proportion of sample size or information for which the
spending function will be computed.</p></dd>


<dt id="arg-param">param<a class="anchor" aria-label="anchor" href="#arg-param"></a></dt>
<dd><p>a list containing the elements sf (a spendfn object such as
sfHSD), trange (the range over which the spending function increases from 0
to 1; 0 &lt;= trange[1]&lt;trange[2] &lt;=1; for sfGapped, trange[1] must be &gt; 0),
and param (null for a spending function with no parameters or a scalar or
vector of parameters needed to fully specify the spending function in sf).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>An object of type <code>spendfn</code>. See <code><a href="../articles/SpendingFunctionOverview.html">vignette("SpendingFunctionOverview")</a></code>
for further details.</p>
    </div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The gsDesign technical manual is available at
  <a href="https://keaven.github.io/gsd-tech-manual/" class="external-link">https://keaven.github.io/gsd-tech-manual/</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jennison C and Turnbull BW (2000), <em>Group Sequential
Methods with Applications to Clinical Trials</em>. Boca Raton: Chapman and Hall.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="../articles/SpendingFunctionOverview.html">vignette("SpendingFunctionOverview")</a></code>, <code><a href="gsDesign.html">gsDesign</a></code>,
<code><a href="../articles/gsDesignPackageOverview.html">vignette("gsDesignPackageOverview")</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Keaven Anderson <a href="mailto:keaven_anderson@merck.com">keaven_anderson@merck.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Eliminate efficacy spending forany interim at or before 20 percent of information.</span></span></span>
<span class="r-in"><span><span class="co"># Complete spending at first interim at or after 80 percent of information.</span></span></span>
<span class="r-in"><span><span class="va">tx</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op">/</span> <span class="fl">100</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu"><a href="sfHSD.html">sfHSD</a></span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.05</span>, t <span class="op">=</span> <span class="va">tx</span>, param <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">$</span><span class="va">spend</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">tx</span>, Spending <span class="op">=</span> <span class="va">s</span>, sf <span class="op">=</span> <span class="st">"Original spending"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.8</span><span class="op">)</span>, sf <span class="op">=</span> <span class="va">sfHSD</span>, param <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">sfTruncated</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.05</span>, t <span class="op">=</span> <span class="va">tx</span>, param <span class="op">=</span> <span class="va">param</span><span class="op">)</span><span class="op">$</span><span class="va">spend</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">tx</span>, Spending <span class="op">=</span> <span class="va">s</span>, sf <span class="op">=</span> <span class="st">"Truncated"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">sfTrimmed</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.05</span>, t <span class="op">=</span> <span class="va">tx</span>, param <span class="op">=</span> <span class="va">param</span><span class="op">)</span><span class="op">$</span><span class="va">spend</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">tx</span>, Spending <span class="op">=</span> <span class="va">s</span>, sf <span class="op">=</span> <span class="st">"Trimmed"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">s</span> <span class="op">&lt;-</span> <span class="fu">sfGapped</span><span class="op">(</span>alpha <span class="op">=</span> <span class="fl">.05</span>, t <span class="op">=</span> <span class="va">tx</span>, param <span class="op">=</span> <span class="va">param</span><span class="op">)</span><span class="op">$</span><span class="va">spend</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>t <span class="op">=</span> <span class="va">tx</span>, Spending <span class="op">=</span> <span class="va">s</span>, sf <span class="op">=</span> <span class="st">"Gapped"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html" class="external-link">ggplot</a></span><span class="op">(</span><span class="va">x</span>, <span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html" class="external-link">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">t</span>, y <span class="op">=</span> <span class="va">Spending</span>, col <span class="op">=</span> <span class="va">sf</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> </span></span>
<span class="r-in"><span><span class="fu">ggplot2</span><span class="fu">::</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_path.html" class="external-link">geom_line</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-plt img"><img src="sfSpecial-1.png" alt="" width="700" height="433"></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># now apply the sfTrimmed version in gsDesign</span></span></span>
<span class="r-in"><span><span class="co"># initially, eliminate the early efficacy analysis</span></span></span>
<span class="r-in"><span><span class="co"># note: final spend must occur at &gt; next to last interim</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="gsDesign.html">gsDesign</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  k <span class="op">=</span> <span class="fl">4</span>, n.fix <span class="op">=</span> <span class="fl">100</span>, sfu <span class="op">=</span> <span class="va">sfTrimmed</span>,</span></span>
<span class="r-in"><span>  sfupar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="va">sfHSD</span>, param <span class="op">=</span> <span class="fl">1</span>, trange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.3</span>, <span class="fl">.9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># first upper bound=20 means no testing there</span></span></span>
<span class="r-in"><span><span class="fu"><a href="gsBoundSummary.html">gsBoundSummary</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Analysis               Value Efficacy Futility</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  IA 1: 25%                   Z  20.0000  -0.5316</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      N: 31         p (1-sided)   0.0000   0.7025</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                ~delta at bound  11.1795  -0.2972</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            P(Cross) if delta=0   0.0000   0.2975</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            P(Cross) if delta=1   0.0000   0.0102</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  IA 2: 50%                   Z   2.1555   0.4956</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      N: 61         p (1-sided)   0.0156   0.3101</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                ~delta at bound   0.8520   0.1959</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            P(Cross) if delta=0   0.0155   0.7033</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            P(Cross) if delta=1   0.6458   0.0269</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  IA 3: 75%                   Z   2.3061   1.3812</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      N: 92         p (1-sided)   0.0106   0.0836</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                ~delta at bound   0.7442   0.4457</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            P(Cross) if delta=0   0.0208   0.9208</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            P(Cross) if delta=1   0.8136   0.0545</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Final                   Z   2.3352   2.3352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>     N: 122         p (1-sided)   0.0098   0.0098</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                ~delta at bound   0.6527   0.6527</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            P(Cross) if delta=0   0.0242   0.9758</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            P(Cross) if delta=1   0.9000   0.1000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># now, do not eliminate early efficacy analysis</span></span></span>
<span class="r-in"><span><span class="va">param</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>sf <span class="op">=</span> <span class="va">sfHSD</span>, param <span class="op">=</span> <span class="fl">1</span>, trange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">.9</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="gsDesign.html">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">4</span>, n.fix <span class="op">=</span> <span class="fl">100</span>, sfu <span class="op">=</span> <span class="va">sfTrimmed</span>, sfupar <span class="op">=</span> <span class="va">param</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># The above means if final analysis is done a little early, all spending can occur</span></span></span>
<span class="r-in"><span><span class="co"># Suppose we set calendar date for final analysis based on</span></span></span>
<span class="r-in"><span><span class="co"># estimated full information, but come up with only 97 pct of plan</span></span></span>
<span class="r-in"><span><span class="va">xA</span> <span class="op">&lt;-</span> <span class="fu"><a href="gsDesign.html">gsDesign</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  k <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">k</span>, n.fix <span class="op">=</span> <span class="fl">100</span>, n.I <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="fl">.97</span> <span class="op">*</span> <span class="va">x</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test.type <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">test.type</span>,</span></span>
<span class="r-in"><span>  maxn.IPlan <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">k</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  sfu <span class="op">=</span> <span class="va">sfTrimmed</span>, sfupar <span class="op">=</span> <span class="va">param</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># now accelerate without the trimmed spending function</span></span></span>
<span class="r-in"><span><span class="va">xNT</span> <span class="op">&lt;-</span> <span class="fu"><a href="gsDesign.html">gsDesign</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  k <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">k</span>, n.fix <span class="op">=</span> <span class="fl">100</span>, n.I <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="fl">.97</span> <span class="op">*</span> <span class="va">x</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test.type <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">test.type</span>,</span></span>
<span class="r-in"><span>  maxn.IPlan <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">k</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  sfu <span class="op">=</span> <span class="va">sfHSD</span>, sfupar <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co"># Check last bound if analysis done at early time</span></span></span>
<span class="r-in"><span><span class="va">x</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.357469</span>
<span class="r-in"><span><span class="co"># Now look at last bound if done at early time with trimmed spending function</span></span></span>
<span class="r-in"><span><span class="co"># that allows capture of full alpha</span></span></span>
<span class="r-in"><span><span class="va">xA</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.343624</span>
<span class="r-in"><span><span class="co"># With original spending function, we don't get full alpha and therefore have</span></span></span>
<span class="r-in"><span><span class="co"># unnecessarily stringent bound at final analysis</span></span></span>
<span class="r-in"><span><span class="va">xNT</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.37218</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># note that if the last analysis is LATE, all 3 approaches should give the same</span></span></span>
<span class="r-in"><span><span class="co"># final bound that has a little larger z-value</span></span></span>
<span class="r-in"><span><span class="va">xlate</span> <span class="op">&lt;-</span> <span class="fu"><a href="gsDesign.html">gsDesign</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  k <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">k</span>, n.fix <span class="op">=</span> <span class="fl">100</span>, n.I <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span>, <span class="fl">1.25</span> <span class="op">*</span> <span class="va">x</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  test.type <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">test.type</span>,</span></span>
<span class="r-in"><span>  maxn.IPlan <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">k</span><span class="op">]</span>,</span></span>
<span class="r-in"><span>  sfu <span class="op">=</span> <span class="va">sfHSD</span>, sfupar <span class="op">=</span> <span class="fl">1</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">xlate</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span><span class="op">[</span><span class="fl">4</span><span class="op">]</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 2.435171</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># eliminate futility after the first interim analysis</span></span></span>
<span class="r-in"><span><span class="co"># note that by setting trange[1] to .2, the spend at t=.2 is used for the first</span></span></span>
<span class="r-in"><span><span class="co"># interim at or after 20 percent of information</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="gsDesign.html">gsDesign</a></span><span class="op">(</span>n.fix <span class="op">=</span> <span class="fl">100</span>, sfl <span class="op">=</span> <span class="va">sfGapped</span>, sflpar <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>trange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">.2</span>, <span class="fl">.9</span><span class="op">)</span>, sf <span class="op">=</span> <span class="va">sfHSD</span>, param <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Keaven Anderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer></div>





  </body></html>

