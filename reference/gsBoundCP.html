<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Conditional Power at Interim Boundaries — gsBoundCP • gsDesign</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Conditional Power at Interim Boundaries — gsBoundCP"><meta name="description" content="gsBoundCP() computes the total probability of crossing future upper
bounds given an interim test statistic at an interim bound. For each interim
boundary, assumes an interim test statistic at the boundary and computes the
probability of crossing any of the later upper boundaries.
See Conditional power section of manual for further clarification. See also
Muller and Schaffer (2001) for background theory."><meta property="og:description" content="gsBoundCP() computes the total probability of crossing future upper
bounds given an interim test statistic at an interim bound. For each interim
boundary, assumes an interim test statistic at the boundary and computes the
probability of crossing any of the later upper boundaries.
See Conditional power section of manual for further clarification. See also
Muller and Schaffer (2001) for background theory."><meta property="og:image" content="https://keaven.github.io/gsDesign/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gsDesign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.6.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/keaven/gsDesign/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Conditional Power at Interim Boundaries</h1>
      <small class="dont-index">Source: <a href="https://github.com/keaven/gsDesign/blob/master/R/gsCP.R" class="external-link"><code>R/gsCP.R</code></a></small>
      <div class="d-none name"><code>gsBoundCP.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p><code>gsBoundCP()</code> computes the total probability of crossing future upper
bounds given an interim test statistic at an interim bound. For each interim
boundary, assumes an interim test statistic at the boundary and computes the
probability of crossing any of the later upper boundaries.</p>
<p>See Conditional power section of manual for further clarification. See also
Muller and Schaffer (2001) for background theory.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">gsBoundCP</span><span class="op">(</span><span class="va">x</span>, theta <span class="op">=</span> <span class="st">"thetahat"</span>, r <span class="op">=</span> <span class="fl">18</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>An object of type <code>gsDesign</code> or <code>gsProbability</code></p></dd>


<dt id="arg-theta">theta<a class="anchor" aria-label="anchor" href="#arg-theta"></a></dt>
<dd><p>if <code>"thetahat"</code> and <code>class(x)!="gsDesign"</code>,
conditional power computations for each boundary value are computed using
estimated treatment effect assuming a test statistic at that boundary
(<code>zi/sqrt(x$n.I[i])</code> at analysis <code>i</code>, interim test statistic
<code>zi</code> and interim sample size/statistical information of
<code>x$n.I[i]</code>). Otherwise, conditional power is computed assuming the
input scalar value <code>theta</code>.</p></dd>


<dt id="arg-r">r<a class="anchor" aria-label="anchor" href="#arg-r"></a></dt>
<dd><p>Integer value (&gt;= 1 and &lt;= 80) controlling the number of numerical
integration grid points. Default is 18, as recommended by Jennison and
Turnbull (2000). Grid points are spread out in the tails for accurate
probability calculations. Larger values provide more grid points and greater
accuracy but slow down computation. Jennison and Turnbull (p. 350) note an
accuracy of \(10^{-6}\) with <code>r = 16</code>. This parameter is normally
not changed by users.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list containing two vectors, <code>CPlo</code> and <code>CPhi</code>.</p>
<dl><dt>CPlo</dt>
<dd><p>A vector of length <code>x$k-1</code> with conditional powers of
crossing upper bounds given interim test statistics at each lower bound</p></dd>

<dt>CPhi</dt>
<dd><p>A vector of length <code>x$k-1</code> with conditional powers of
crossing upper bounds given interim test statistics at each upper bound.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="note">Note<a class="anchor" aria-label="anchor" href="#note"></a></h2>
    <p>The gsDesign technical manual is available at
  <a href="https://keaven.github.io/gsd-tech-manual/" class="external-link">https://keaven.github.io/gsd-tech-manual/</a>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Jennison C and Turnbull BW (2000), <em>Group Sequential
Methods with Applications to Clinical Trials</em>. Boca Raton: Chapman and Hall.</p>
<p>Muller, Hans-Helge and Schaffer, Helmut (2001), Adaptive group sequential
designs for clinical trials: combining the advantages of adaptive and
classical group sequential approaches. <em>Biometrics</em>;57:886-891.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="gsDesign.html">gsDesign</a></code>, <code><a href="gsProbability.html">gsProbability</a></code>,
<code><a href="gsCP.html">gsCP</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Keaven Anderson <a href="mailto:keaven_anderson@merck.com">keaven_anderson@merck.com</a></p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># set up a group sequential design</span></span></span>
<span class="r-in"><span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="gsDesign.html">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">x</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Asymmetric two-sided group sequential design with</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 90 % power and 2.5 % Type I Error.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper bound spending computations assume</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> trial continues if lower bound is crossed.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span>            Sample</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>             Size    ----Lower bounds----  ----Upper bounds-----</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   Analysis Ratio*   Z   Nominal p Spend+  Z   Nominal p Spend++</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          1  0.220 -0.90    0.1836 0.0077 3.25    0.0006  0.0006</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          2  0.441 -0.04    0.4853 0.0115 2.99    0.0014  0.0013</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          3  0.661  0.69    0.7563 0.0171 2.69    0.0036  0.0028</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          4  0.881  1.36    0.9131 0.0256 2.37    0.0088  0.0063</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>          5  1.101  2.03    0.9786 0.0381 2.03    0.0214  0.0140</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      Total                        0.1000                 0.0250 </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> + lower bound beta spending (under H1):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hwang-Shih-DeCani spending function with gamma = -2.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ++ alpha spending:</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  Hwang-Shih-DeCani spending function with gamma = -4.</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> * Sample size ratio compared to fixed design with no interim</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Boundary crossing probabilities and expected sample size</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> assume any cross stops the trial</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Upper boundary (power or Type I Error)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Theta      1      2      3      4      5  Total   E{N}</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.0000 0.0006 0.0013 0.0028 0.0062 0.0117 0.0226 0.5726</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3.2415 0.0417 0.1679 0.2806 0.2654 0.1444 0.9000 0.7440</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Lower boundary (futility or Type II Error)</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           Analysis</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    Theta      1      2      3      4      5  Total</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   0.0000 0.1836 0.3201 0.2700 0.1477 0.0559 0.9774</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>   3.2415 0.0077 0.0115 0.0171 0.0256 0.0381 0.1000</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute conditional power based on interim treatment effects</span></span></span>
<span class="r-in"><span><span class="fu">gsBoundCP</span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>              CPlo      CPhi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 2.294534e-06 1.0000001</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 2.238566e-03 0.9998352</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 2.669114e-02 0.9922459</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 1.296705e-01 0.9200502</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># compute conditional power based on original x$delta</span></span></span>
<span class="r-in"><span><span class="fu">gsBoundCP</span><span class="op">(</span><span class="va">x</span>, theta <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">delta</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>           CPlo      CPhi</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,] 0.4936972 0.9940265</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,] 0.3676577 0.9954019</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,] 0.3331896 0.9912361</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [4,] 0.3871332 0.9590607</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Keaven Anderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

