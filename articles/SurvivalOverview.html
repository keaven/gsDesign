<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Overview of design and evaluation of trials with time-to-event outcomes â€¢ gsDesign</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Overview of design and evaluation of trials with time-to-event outcomes">
<meta property="og:description" content="gsDesign">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gsDesign</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.1.0.9006</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../articles/index.html">Articles</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Overview of design and evaluation of trials with time-to-event outcomes</h1>
            
            <h4 class="date">2020-04-27</h4>
      
      
      <div class="hidden name"><code>SurvivalOverview.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This article/vignette provides a summary of functions in the <strong><em>gsDesign</em></strong> package supporting design and evaluation of trial designs for time-to-event outcomes. We do not focus on detailed output options, but what numbers summarizing the design are based on. If you are not looking for this level of detail and just want to see how to design a fixed or group sequential design for a time-to-event endpoint, see the vignette <em>Basic time-to-event group sequential design using gsSurv</em>.</p>
<p>The following functions support use of the very straightforward <span class="citation">Schoenfeld (1981)</span> approximation for 2-arm trials:</p>
<ul>
<li>
<code><a href="../reference/nSurvival.html">nEvents()</a></code>: number of events to achieve power or power given number of events with no interim analysis.</li>
<li>
<code><a href="../reference/nSurvival.html">zn2hr()</a></code>, <code><a href="../reference/gsBoundSummary.html">gsHR()</a></code> and <code><a href="../reference/gsBoundSummary.html">gsBoundSummary()</a></code>: approximate the observed hazard ratio (HR) required to achieve a targeted Z-value for a given number of events.</li>
<li>
<code><a href="../reference/nSurvival.html">hrn2z()</a></code>: approximate Z-value corresponding to a specified HR and event count.</li>
<li>
<code><a href="../reference/nSurvival.html">hrz2n()</a></code>: approxiate event count corresponding to a specified HR and Z-value.</li>
</ul>
<p>The above functions do not directly support sample size calculations. This is done with the <span class="citation">Lachin and Foulkes (1986)</span> method. Functions include:</p>
<ul>
<li>
<code><a href="../reference/nSurvival.html">nSurvival()</a></code>: Sample size restricted to single enrollment rate; single analysis.</li>
<li>
<code><a href="../reference/nSurv.html">nSurv()</a></code>: More flexible enrollment scenarios; single analysis.</li>
<li>
<code><a href="../reference/nSurv.html">gsSurv()</a></code>: Group sequential design extension of <code><a href="../reference/nSurv.html">nSurv()</a></code>.</li>
</ul>
<p>Output for survival design information is supported in various formats:</p>
<ul>
<li>
<code><a href="../reference/gsBoundSummary.html">gsBoundSummary()</a></code>: Tabular summary of a design in a data frame.</li>
<li>
<code><a href="../reference/plot.gsDesign.html">plot.gsDesign()</a></code>: Various plot summaries of a design.</li>
<li>
<code><a href="../reference/gsBoundSummary.html">gsHR()</a></code>: Approximate HR required to cross a bound.</li>
</ul>
</div>
<div id="schoenfeld-approximation-support" class="section level2">
<h2 class="hasAnchor">
<a href="#schoenfeld-approximation-support" class="anchor"></a>Schoenfeld approximation support</h2>
<p>We will assume a hazard ratio <span class="math inline">\(\nu &lt; 1\)</span> represents a benefit of experimental treatment over control. We let <span class="math inline">\(\delta = \log\nu\)</span> denote the so-called <em>natural parameter</em> for this case. Asymptotically the distribution of the Cox model estimate <span class="math inline">\(\hat{\delta}\)</span> under the proportional hazards assumption is <span class="math display">\[\hat\delta\sim \hbox{Normal}(\delta=\log\nu, (1+r)^2/nr).\]</span> Using a Cox model to estimate <span class="math inline">\(\delta\)</span>, the Wald test for <span class="math inline">\(\hbox{H_0}: \delta=0\)</span> can be approximated with the asymptotic variance from above as:</p>
<p><span class="math display">\[Z_W\approx \frac{\sqrt {nr}}{1+r}\hat\delta=\frac{\ln(\hat\nu)\sqrt{nr}}{1+r}.\]</span></p>
<p>Also, we know that the Wald test <span class="math inline">\(Z_W\)</span> and a standard normal version of the logrank <span class="math inline">\(Z\)</span> are both asymptotically efficient and therefore asymptotically equivalent. We denote the <em>standardized effect size</em> as</p>
<p><span class="math display">\[\theta = \delta\sqrt r / (1+r)= \log(\nu)\sqrt r / (1+r).\]</span> Letting <span class="math inline">\(\hat\theta = -\sqrt r/(1+r)\hat\delta\)</span> we have <span class="math display">\[ \hat \theta \sim \hbox{Normal}(\theta, 1/ n).\]</span> Thus, the standardized Z version of the logrank is approximately distributed as</p>
<p><span class="math display">\[Z\sim\hbox{Normal}(\sqrt n\theta,1).\]</span> Treatment effect favoring experimental treatment compared to control in this notation corresponds to a hazard ratio <span class="math inline">\(\nu &lt; 1\)</span>, as well as negative values of the standardized effect <span class="math inline">\(\theta\)</span>, natural parameter <span class="math inline">\(\delta\)</span> and standardized Z-test.</p>
<div id="power-and-sample-size-with-nevents" class="section level3">
<h3 class="hasAnchor">
<a href="#power-and-sample-size-with-nevents" class="anchor"></a>Power and sample size with nEvents()</h3>
<p>Based on the above, the power for the logrank test is approximated by</p>
<p><span class="math display">\[P[Z\le z]=\Phi(z -\sqrt n\theta)=\Phi(z- \sqrt{nr}/(1+r)\log\nu).\]</span> Thus, assuming <span class="math inline">\(n=100\)</span> events and <span class="math inline">\(\delta = \log\nu=-\log(.7)\)</span>, and <span class="math inline">\(r=1\)</span> (equal randomization) we approximate power for the logrank test when <span class="math inline">\(\alpha=0.025\)</span> as</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="no">n</span> <span class="kw">&lt;-</span> <span class="fl">100</span>
<span class="no">hr</span> <span class="kw">&lt;-</span> <span class="fl">.7</span>
<span class="no">delta</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">hr</span>)
<span class="no">alpha</span> <span class="kw">&lt;-</span> <span class="fl">.025</span>
<span class="no">r</span> <span class="kw">&lt;-</span> <span class="fl">1</span>
<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(<span class="no">alpha</span>) - <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="no">n</span>*<span class="no">r</span>)/(<span class="fl">1</span>+<span class="no">r</span>)*<span class="no">delta</span>)
<span class="co">#&gt; [1] 0.4299155</span></pre></body></html></div>
<p>We can compute this with <code><a href="../reference/nSurvival.html">gsDesign::nEvents()</a></code> as:</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="fu"><a href="../reference/nSurvival.html">nEvents</a></span>(<span class="kw">n</span><span class="kw">=</span><span class="no">n</span>,<span class="kw">alpha</span><span class="kw">=</span><span class="no">alpha</span>,<span class="kw">hr</span><span class="kw">=</span><span class="no">hr</span>,<span class="kw">r</span><span class="kw">=</span><span class="no">r</span>)
<span class="co">#&gt; [1] 0.4299155</span></pre></body></html></div>
<p>We solve for the number of events <span class="math inline">\(n\)</span> to see how many events are required to obtain a desired power</p>
<p><span class="math display">\[1-\beta=P(Z\ge \Phi^{-1}(1-\alpha))\]</span> with</p>
<p><span class="math display">\[n = \left(\frac{\Phi^{-1} (1-\alpha)+\Phi^{-1}(1-\beta)}{\theta}\right)^2
=\frac{(1+r)^2}{r(\log\nu)^2}\left({\Phi^{-1} (1-\alpha)+\Phi^{-1}(1-\beta)}\right)^2.\]</span> Thus, the approximate number of events required to power for HR=0.7 with <span class="math inline">\(\alpha=0.025\)</span> one-sided and power <span class="math inline">\(1-\beta=0.9\)</span> is</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="no">beta</span> <span class="kw">&lt;-</span> <span class="fl">0.1</span>
(<span class="fl">1</span>+<span class="no">r</span>)^<span class="fl">2</span>/<span class="no">r</span>/<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">hr</span>)^<span class="fl">2</span> * ((<span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(<span class="fl">1</span> - <span class="no">alpha</span>) + <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(<span class="fl">1</span> - <span class="no">beta</span>)))^<span class="fl">2</span>
<span class="co">#&gt; [1] 330.3779</span></pre></body></html></div>
<p>which, rounding up, matches (with tabular output):</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="fu"><a href="../reference/nSurvival.html">nEvents</a></span>(<span class="kw">hr</span> <span class="kw">=</span> <span class="no">hr</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="no">alpha</span>, <span class="kw">beta</span> <span class="kw">=</span> <span class="no">beta</span>, <span class="kw">r</span> <span class="kw">=</span> <span class="fl">1</span>, <span class="kw">tbl</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="right">hr</th>
<th align="right">n</th>
<th align="right">alpha</th>
<th align="right">sided</th>
<th align="right">beta</th>
<th align="right">Power</th>
<th align="right">delta</th>
<th align="right">ratio</th>
<th align="right">hr0</th>
<th align="right">se</th>
</tr></thead>
<tbody><tr class="odd">
<td align="right">0.7</td>
<td align="right">331</td>
<td align="right">0.025</td>
<td align="right">1</td>
<td align="right">0.1</td>
<td align="right">0.9</td>
<td align="right">0.1783375</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">0.1099299</td>
</tr></tbody>
</table>
<p>The notation <code>delta</code> in the above table changes the sign for the standardized treatment effect <span class="math inline">\(\theta\)</span> in the above:</p>
<div class="sourceCode" id="cb5"><html><body><pre class="r"><span class="no">theta</span> <span class="kw">&lt;-</span> <span class="no">delta</span> * <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="no">r</span>) / (<span class="fl">1</span> + <span class="no">r</span>)
<span class="no">theta</span>
<span class="co">#&gt; [1] -0.1783375</span></pre></body></html></div>
<p>The <code>se</code> in the table is the estimated standard error for the log hazard ratio <span class="math inline">\(\delta=\log\hat\nu\)</span></p>
<div class="sourceCode" id="cb6"><html><body><pre class="r">(<span class="fl">1</span> + <span class="no">r</span>) / <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="fl">331</span> * <span class="no">r</span>)
<span class="co">#&gt; [1] 0.1099299</span></pre></body></html></div>
</div>
<div id="group-sequential-design" class="section level3">
<h3 class="hasAnchor">
<a href="#group-sequential-design" class="anchor"></a>Group sequential design</h3>
<p>We can create a group sequential design for the above problem either with <span class="math inline">\(\theta\)</span> or with the fixed design sample size. The parameter <code>delta</code> in <code><a href="../reference/gsDesign.html">gsDesign()</a></code> corresponds to standardized effect size with sign changed <span class="math inline">\(-\theta\)</span> in notation used above and by <span class="citation">Jennison and Turnbull (2000)</span>, while the natural parameter, <span class="math inline">\(\log(\hbox{HR})\)</span> is in the parameter <code>delta1</code> passed to <code><a href="../reference/gsDesign.html">gsDesign()</a></code>. The name of the effect size is specified in <code>deltaname</code> and the parameter <code>logdelta = TRUE</code> indicates that <code>delta</code> input needs to be exponentiated to obtain HR in the output below. This example code can be useful in practice. We begin by passing the number of events for a fixed design in the parameter <code>n.fix</code> (continuous, not rounded) to adapt to a group sequential design.</p>
<div class="sourceCode" id="cb7"><html><body><pre class="r"><span class="no">Schoenfeld</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/gsDesign.html">gsDesign</a></span>(<span class="kw">k</span><span class="kw">=</span><span class="fl">2</span>,
                       <span class="kw">n.fix</span> <span class="kw">=</span> <span class="fu"><a href="../reference/nSurvival.html">nEvents</a></span>(<span class="kw">hr</span> <span class="kw">=</span> <span class="no">hr</span>, <span class="kw">alpha</span> <span class="kw">=</span> <span class="no">alpha</span>, <span class="kw">beta</span> <span class="kw">=</span> <span class="no">beta</span>, <span class="kw">r</span> <span class="kw">=</span> <span class="fl">1</span>),
                       <span class="kw">delta1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">hr</span>))
<span class="no">Schoenfeld</span> <span class="kw">%&gt;%</span>
  <span class="fu"><a href="../reference/gsBoundSummary.html">gsBoundSummary</a></span>(<span class="kw">deltaname</span> <span class="kw">=</span> <span class="st">"HR"</span>, <span class="kw">logdelta</span> <span class="kw">=</span> <span class="fl">TRUE</span>) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>(<span class="kw">row.names</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">Analysis</th>
<th align="left">Value</th>
<th align="right">Efficacy</th>
<th align="right">Futility</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">IA 1: 50%</td>
<td align="left">Z</td>
<td align="right">2.7500</td>
<td align="right">0.4122</td>
</tr>
<tr class="even">
<td align="left">N: 173</td>
<td align="left">p (1-sided)</td>
<td align="right">0.0030</td>
<td align="right">0.3401</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">~HR at bound</td>
<td align="right">0.6577</td>
<td align="right">0.9391</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">P(Cross) if HR=1</td>
<td align="right">0.0030</td>
<td align="right">0.6599</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">P(Cross) if HR=0.7</td>
<td align="right">0.3412</td>
<td align="right">0.0269</td>
</tr>
<tr class="even">
<td align="left">Final</td>
<td align="left">Z</td>
<td align="right">1.9811</td>
<td align="right">1.9811</td>
</tr>
<tr class="odd">
<td align="left">N: 345</td>
<td align="left">p (1-sided)</td>
<td align="right">0.0238</td>
<td align="right">0.0238</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">~HR at bound</td>
<td align="right">0.8078</td>
<td align="right">0.8078</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">P(Cross) if HR=1</td>
<td align="right">0.0239</td>
<td align="right">0.9761</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">P(Cross) if HR=0.7</td>
<td align="right">0.9000</td>
<td align="right">0.1000</td>
</tr>
</tbody>
</table>
</div>
<div id="information-based-design" class="section level3">
<h3 class="hasAnchor">
<a href="#information-based-design" class="anchor"></a>Information based design</h3>
<p>Exactly the same result can be obtained with the following, passing the standardized effect size <code>theta</code> from above to the parameter <code>delta</code> in <code><a href="../reference/gsDesign.html">gsDesign()</a></code>.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="no">Schoenfeld</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/gsDesign.html">gsDesign</a></span>(<span class="kw">k</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">delta</span> <span class="kw">=</span> -<span class="no">theta</span>, <span class="kw">delta1</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">hr</span>))</pre></body></html></div>
<p>We noted above that the asymptotic variance for <span class="math inline">\(\hat\theta\)</span> is <span class="math inline">\(1/n\)</span> which corresponds to statistical information <span class="math inline">\(\mathcal I=n\)</span> for the parameter <span class="math inline">\(\theta\)</span>. Thus, the value</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="no">Schoenfeld</span>$<span class="no">n.I</span>
<span class="co">#&gt; [1] 172.2757 344.5514</span></pre></body></html></div>
<p>corresponds both to the number of events and the statistical information for the standardized effect size <span class="math inline">\(\theta\)</span> required to power the trial at the desired level. Note that if you plug in the natural parameter <span class="math inline">\(\delta= -\log\nu &gt; 0\)</span>, then <span class="math inline">\(n.I\)</span> returns the statistical information for the log hazard ratio.</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="../reference/gsDesign.html">gsDesign</a></span>(<span class="kw">k</span><span class="kw">=</span><span class="fl">2</span>, <span class="kw">delta</span> <span class="kw">=</span> -<span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">hr</span>))$<span class="no">n.I</span>
<span class="co">#&gt; [1] 43.06893 86.13786</span></pre></body></html></div>
<p>The reader may wish to look above to derive the exact relationship between events and statistical information for <span class="math inline">\(\delta\)</span>.</p>
</div>
<div id="approximating-boundary-characteristics" class="section level3">
<h3 class="hasAnchor">
<a href="#approximating-boundary-characteristics" class="anchor"></a>Approximating boundary characteristics</h3>
<p>Another application of the <span class="citation">Schoenfeld (1981)</span> method is to approximate boundary characteristics of a design. As noted in the introduction above, we will consider <code><a href="../reference/nSurvival.html">zn2hr()</a></code>, <code><a href="../reference/gsBoundSummary.html">gsHR()</a></code> and <code><a href="../reference/gsBoundSummary.html">gsBoundSummary()</a></code> to approximate the treatment effect required to cross design bounds. <code><a href="../reference/nSurvival.html">zn2hr()</a></code> is complemented by the functions <code><a href="../reference/nSurvival.html">hrn2z()</a></code> and <code><a href="../reference/nSurvival.html">hrz2n()</a></code>. We begin with the basic approximation used across all of these functions in this section and follow with a sub-section with example code to reproduce some of what is in the table above.</p>
<p>We return to the following equation from above:</p>
<p><span class="math display">\[Z\approx Z_W\approx \frac{\sqrt {nr}}{1+r}\hat\delta=\frac{\ln(\hat\nu)\sqrt{nr}}{1+r}.\]</span> By fixing <span class="math inline">\(Z=z, n\)</span> we can solve for <span class="math inline">\(\hat\nu\)</span> from the above:</p>
<p><span class="math display">\[\hat{\nu} = \exp(z(1+r)/\sqrt{rn}).\]</span> By fixing <span class="math inline">\(\hat\nu\)</span> and <span class="math inline">\(z\)</span>, we can solve for the corresponding number of events required: <span class="math display">\[ n = (z(1+r)/\log(\hat{\nu}))^2/r.\]</span></p>
</div>
<div id="examples" class="section level3">
<h3 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h3>
<p>For our first example, we note that the event counts in <code>Schoenfeld</code> are actually continuous numbers that are rounded up in the table:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="no">Schoenfeld</span>$<span class="no">n.I</span>
<span class="co">#&gt; [1] 172.2757 344.5514</span></pre></body></html></div>
<p>We reproduce the approximate hazard ratios required to cross efficacy bounds using the Schoenfeld approximations above:</p>
<div class="sourceCode" id="cb12"><html><body><pre class="r"><span class="fu"><a href="../reference/gsBoundSummary.html">gsHR</a></span>(<span class="kw">z</span> <span class="kw">=</span> <span class="no">Schoenfeld</span>$<span class="no">upper</span>$<span class="no">bound</span>, <span class="co"># Z-values at bound</span>
     <span class="kw">i</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">2</span>,                    <span class="co"># Analysis number</span>
     <span class="kw">x</span> <span class="kw">=</span> <span class="no">Schoenfeld</span>,             <span class="co"># Group sequential design from above</span>
     <span class="kw">ratio</span> <span class="kw">=</span> <span class="no">r</span>)                  <span class="co"># Experimental/control randomization ratio</span>
<span class="co">#&gt; [1] 0.6576844 0.8077846</span></pre></body></html></div>
<p>For the following examples, we assume <span class="math inline">\(r=1\)</span>.</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="no">r</span> <span class="kw">&lt;-</span> <span class="fl">1</span></pre></body></html></div>
<ol style="list-style-type: decimal">
<li>Assuming a Cox model estimate <span class="math inline">\(\hat\nu\)</span> and a corresponding event count, approximately what Z-value (p-value) does this correspond to? We use the first equation above:</li>
</ol>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="no">hr</span> <span class="kw">&lt;-</span> <span class="fl">.73</span> <span class="co"># observed hr</span>
<span class="no">events</span> <span class="kw">&lt;-</span> <span class="fl">125</span> <span class="co"># Events in analysis</span>

<span class="no">z</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">hr</span>) * <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="no">events</span>*<span class="no">r</span>) / (<span class="fl">1</span>+<span class="no">r</span>)
<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">z</span>, <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">pnorm</a></span>(<span class="no">z</span>)) <span class="co"># Z- and p-value</span>
<span class="co">#&gt; [1] -1.75928655  0.03926443</span></pre></body></html></div>
<p>We replicate the Z-value with</p>
<div class="sourceCode" id="cb15"><html><body><pre class="r"><span class="fu"><a href="../reference/nSurvival.html">hrn2z</a></span>(<span class="kw">hr</span><span class="kw">=</span><span class="no">hr</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">events</span>, <span class="kw">ratio</span> <span class="kw">=</span> <span class="no">r</span>)
<span class="co">#&gt; [1] -1.759287</span></pre></body></html></div>
<ol start="2" style="list-style-type: decimal">
<li>Assuming an efficacy bound Z-value and event count, approximately what hazard ratio must be observed to cross the bound? We use the second equation above:</li>
</ol>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="no">z</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(<span class="fl">.025</span>)
<span class="no">events</span> <span class="kw">&lt;-</span> <span class="fl">120</span>
<span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span>(<span class="no">z</span> * (<span class="fl">1</span> + <span class="no">r</span>) / <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span>(<span class="no">r</span> * <span class="no">events</span>))
<span class="co">#&gt; [1] 0.6991858</span></pre></body></html></div>
<p>We can reproduce this with <code><a href="../reference/nSurvival.html">zn2hr()</a></code> by switching the sign of <code>z</code> above; note that the default is <code>ratio = 1</code> for all of these functions and often is not specified:</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="fu"><a href="../reference/nSurvival.html">zn2hr</a></span>(<span class="kw">z</span> <span class="kw">=</span> -<span class="no">z</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">events</span>,  <span class="kw">ratio</span> <span class="kw">=</span> <span class="no">r</span>)
<span class="co">#&gt; [1] 0.6991858</span></pre></body></html></div>
<ol start="3" style="list-style-type: decimal">
<li>Finally, if we want an observed hazard ratio <span class="math inline">\(\hat\nu = .8\)</span> to represent a positive result, how many events would be need to observe to achieve a 1-sided p-value of 0.025? assuming 2:1 randomization? We use the third equation above:</li>
</ol>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="no">r</span> <span class="kw">&lt;-</span> <span class="fl">2</span>
<span class="no">hr</span> <span class="kw">&lt;-</span> <span class="fl">.8</span>
<span class="no">z</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">qnorm</a></span>(<span class="fl">.025</span>)
<span class="no">events</span> <span class="kw">&lt;-</span> (<span class="no">z</span> * (<span class="fl">1</span> + <span class="no">r</span>) / <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="no">hr</span>))^<span class="fl">2</span> / <span class="no">r</span>
<span class="no">events</span>
<span class="co">#&gt; [1] 347.1683</span></pre></body></html></div>
<p>This is replicated with</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="fu"><a href="../reference/nSurvival.html">hrz2n</a></span>(<span class="kw">hr</span> <span class="kw">=</span> <span class="no">hr</span>, <span class="kw">z</span> <span class="kw">=</span> <span class="no">z</span>, <span class="kw">ratio</span> <span class="kw">=</span> <span class="no">r</span>)
<span class="co">#&gt; [1] 347.1683</span></pre></body></html></div>
</div>
</div>
<div id="lachin-and-foulkes-design" class="section level2">
<h2 class="hasAnchor">
<a href="#lachin-and-foulkes-design" class="anchor"></a>Lachin and Foulkes design</h2>
<p>For the purpose of sample size and power for group sequential design, the <span class="citation">Lachin and Foulkes (1986)</span> is based on substantial evaluation not documented further here. We try to make clear here what some of the strengths and weaknesses of both the <span class="citation">(<span class="citeproc-not-found" data-reference-id="LachinFoules"><strong>???</strong></span>)</span> method as well as its implementation in the <code><a href="../reference/nSurv.html">gsDesign::nSurv()</a></code> (fixed design) and <code><a href="../reference/nSurv.html">gsDesign::gsSurv()</a></code> (group sequential) functions. For historical and testing purposes, we also discuss use of the less flexible <code><a href="../reference/nSurvival.html">gsDesign::nSurvival()</a></code> function that was independently programmed and can be used for some limited validations of <code><a href="../reference/nSurv.html">gsDesign::nSurv()</a></code>.</p>
<div id="model-assumptions" class="section level3">
<h3 class="hasAnchor">
<a href="#model-assumptions" class="anchor"></a>Model assumptions</h3>
<p>Some detail in specification comes With the flexibility allowed by the <span class="citation">Lachin and Foulkes (1986)</span> method. The model assumes</p>
<ul>
<li>A fixed enrollment period with piecewise constant enrollment rates</li>
<li>A fixed minimum follow-up period</li>
<li>Piecewise exponential failure rates for the control group</li>
<li>A single, constant hazard ratio for the experimenatl group</li>
<li>Piecewise exponential loss-to-follow-up rates</li>
<li>A stratified population</li>
<li>A fixed randomization ratio of experimental to control group assignment</li>
</ul>
<p>Other than the proportional hazards assumption, this allows a great deal of flexibility in trial design assumptions. While <span class="citation">Lachin and Foulkes (1986)</span> adjusts the piecewise constant enrollment rates proportionately to derive a sample size, <code>gsDesign$nSurv()</code> also enables the approach of <span class="citation">Kim and Tsiatis (1990)</span> which fixes enrollment rates and extends the final enrollment rate duration to power the trial; the minimum follow-up period is still assumed this approach. We do not enable the drop-in option proposed in <span class="citation">Lachin and Foulkes (1986)</span>.</p>
<p>The two practical differences the <span class="citation">Lachin and Foulkes (1986)</span> method has from the <span class="citation">Schoenfeld (1981)</span> method are:</p>
<ol style="list-style-type: decimal">
<li>By assuming enrollment, failure and dropout rates the method delivers sample size <span class="math inline">\(N\)</span> as well as events required.</li>
<li>The variance for the log hazard ratio <span class="math inline">\(\hat\delta\)</span> is computed differently and both a null (<span class="math inline">\(\sigma^2_0) and alternate hypothesis (\)</span>^2_1$) variance are incorporated through the formula <span class="math display">\[ N  = \left(\frac{\Phi^{-1}(1-\alpha)\sigma_0 + \Phi^{-1}(1-\beta)\sigma_1}{\delta}\right).\]</span> The null hypothesis is derived by averaging the alternate hypothesis rates, weighting according to the proportion randomized in each group.</li>
</ol>
</div>
<div id="fixed-design" class="section level3">
<h3 class="hasAnchor">
<a href="#fixed-design" class="anchor"></a>Fixed design</h3>
<p>We will use the same hazard ratio 0.7 as for the <span class="citation">Schoenfeld (1981)</span> sample size calculations above. We assume further that the trial will enroll for a constant rate for 12 months, have a control group median of 8 months (exponential failure rate <span class="math inline">\(\lambda = \log(2)/8\)</span>), a dropout rate of 0.001 per month, and 16 months of minimum follow-up. As before, we assume a randomization ratio <span class="math inline">\(r=1\)</span>, one-sided Type I error <span class="math inline">\(\alpha=0.025\)</span>, 90% power which is equivalent to Type II error <span class="math inline">\(\beta=0.1\)</span>.</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="no">r</span> <span class="kw">&lt;-</span> <span class="fl">1</span>               <span class="co"># Experimental/control randomization ratio</span>
<span class="no">alpha</span> <span class="kw">&lt;-</span> <span class="fl">0.025</span>       <span class="co"># 1-sided Type I error</span>
<span class="no">beta</span> <span class="kw">&lt;-</span> <span class="fl">0.1</span>          <span class="co"># Type II error (1 - power)</span>
<span class="no">hr</span> <span class="kw">&lt;-</span> <span class="fl">0.7</span>            <span class="co"># Hazard ratio (experimental / control)</span>
<span class="no">controlMedian</span> <span class="kw">&lt;-</span> <span class="fl">8</span>
<span class="no">dropoutRate</span> <span class="kw">&lt;-</span> <span class="fl">0.001</span> <span class="co"># Exponential dropout rate per time unit</span>
<span class="no">enrollDuration</span> <span class="kw">&lt;-</span> <span class="fl">12</span>
<span class="no">minfup</span> <span class="kw">&lt;-</span> <span class="fl">16</span>         <span class="co"># minimum follow-up</span>
<span class="no">Nlf</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/nSurv.html">nSurv</a></span>(<span class="kw">lambdaC</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fl">2</span>) / <span class="no">controlMedian</span>,
             <span class="kw">hr</span> <span class="kw">=</span> <span class="no">hr</span>,
             <span class="kw">eta</span> <span class="kw">=</span> <span class="no">dropoutRate</span>,
             <span class="kw">T</span> <span class="kw">=</span> <span class="no">enrollDuration</span> + <span class="no">minfup</span>, <span class="co"># Trial duration</span>
             <span class="kw">minfup</span> <span class="kw">=</span> <span class="no">minfup</span>,
             <span class="kw">ratio</span> <span class="kw">=</span> <span class="no">r</span>,
             <span class="kw">alpha</span> <span class="kw">=</span> <span class="no">alpha</span>,
             <span class="kw">beta</span> <span class="kw">=</span> <span class="no">beta</span>
      )
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">"Sample size: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="no">Nlf</span>$<span class="no">n</span>), <span class="st">"Events: "</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html">ceiling</a></span>(<span class="no">Nlf</span>$<span class="no">d</span>), <span class="st">"\n"</span>))
<span class="co">#&gt; Sample size:  422 Events:  330</span></pre></body></html></div>
<p>Recall that the <span class="citation">Schoenfeld (1981)</span> method recommended 331 events. The two methods tend to yield very similar event count recommendations, but not the same. Other methods will also differ slightly; see <span class="citation">Lachin and Foulkes (1986)</span>. Sample size recommendations can vary more between methods.</p>
<p>We can get the same result with the <code><a href="../reference/nSurvival.html">nSurvival()</a></code> routine since only a single enrollment, failure and dropout rate is proposed for this example.</p>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">lambda1</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fl">2</span>) / <span class="no">controlMedian</span>
<span class="fu"><a href="../reference/nSurvival.html">nSurvival</a></span>(
  <span class="kw">lambda1</span> <span class="kw">=</span> <span class="no">lambda1</span>,
  <span class="kw">lambda2</span> <span class="kw">=</span> <span class="no">lambda1</span> * <span class="no">hr</span>,
  <span class="kw">Ts</span> <span class="kw">=</span> <span class="no">enrollDuration</span> + <span class="no">minfup</span>,
  <span class="kw">Tr</span> <span class="kw">=</span> <span class="no">enrollDuration</span>,
  <span class="kw">eta</span> <span class="kw">=</span> <span class="no">dropoutRate</span>,
  <span class="kw">ratio</span> <span class="kw">=</span> <span class="no">r</span>,
  <span class="kw">alpha</span> <span class="kw">=</span> <span class="no">alpha</span>,
  <span class="kw">beta</span> <span class="kw">=</span> <span class="no">beta</span>
)
<span class="co">#&gt; Fixed design, two-arm trial with time-to-event</span>
<span class="co">#&gt; outcome (Lachin and Foulkes, 1986).</span>
<span class="co">#&gt; Study duration (fixed):          Ts=28</span>
<span class="co">#&gt; Accrual duration (fixed):        Tr=12</span>
<span class="co">#&gt; Uniform accrual:              entry="unif"</span>
<span class="co">#&gt; Control median:      log(2)/lambda1=8</span>
<span class="co">#&gt; Experimental median: log(2)/lambda2=11.4</span>
<span class="co">#&gt; Censoring median:        log(2)/eta=693.1</span>
<span class="co">#&gt; Control failure rate:       lambda1=0.087</span>
<span class="co">#&gt; Experimental failure rate:  lambda2=0.061</span>
<span class="co">#&gt; Censoring rate:                 eta=0.001</span>
<span class="co">#&gt; Power:                 100*(1-beta)=90%</span>
<span class="co">#&gt; Type I error (1-sided):   100*alpha=2.5%</span>
<span class="co">#&gt; Equal randomization:          ratio=1</span>
<span class="co">#&gt; Sample size based on hazard ratio=0.7 (type="rr")</span>
<span class="co">#&gt; Sample size (computed):           n=422</span>
<span class="co">#&gt; Events required (computed): nEvents=330</span></pre></body></html></div>
</div>
<div id="group-sequential-design-1" class="section level3">
<h3 class="hasAnchor">
<a href="#group-sequential-design-1" class="anchor"></a>Group sequential design</h3>
<div class="sourceCode" id="cb22"><html><body><pre class="r"><span class="no">k</span> <span class="kw">&lt;-</span> <span class="fl">2</span>  <span class="co"># Total number of analyses</span>
<span class="no">lfgs</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/nSurv.html">gsSurv</a></span>(<span class="kw">k</span><span class="kw">=</span><span class="fl">2</span>,
             <span class="kw">lambdaC</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="fl">2</span>) / <span class="no">controlMedian</span>,
             <span class="kw">hr</span> <span class="kw">=</span> <span class="no">hr</span>,
             <span class="kw">eta</span> <span class="kw">=</span> <span class="no">dropoutRate</span>,
             <span class="kw">T</span> <span class="kw">=</span> <span class="no">enrollDuration</span> + <span class="no">minfup</span>, <span class="co"># Trial duration</span>
             <span class="kw">minfup</span> <span class="kw">=</span> <span class="no">minfup</span>,
             <span class="kw">ratio</span> <span class="kw">=</span> <span class="no">r</span>,
             <span class="kw">alpha</span> <span class="kw">=</span> <span class="no">alpha</span>,
             <span class="kw">beta</span> <span class="kw">=</span> <span class="no">beta</span>
      )
<span class="no">lfgs</span> <span class="kw">%&gt;%</span> <span class="fu"><a href="../reference/gsBoundSummary.html">gsBoundSummary</a></span>() <span class="kw">%&gt;%</span> <span class="fu">kable</span>(<span class="kw">row.names</span> <span class="kw">=</span> <span class="fl">FALSE</span>)</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="left">Analysis</th>
<th align="left">Value</th>
<th align="right">Efficacy</th>
<th align="right">Futility</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">IA 1: 50%</td>
<td align="left">Z</td>
<td align="right">2.7500</td>
<td align="right">0.4122</td>
</tr>
<tr class="even">
<td align="left">N: 440</td>
<td align="left">p (1-sided)</td>
<td align="right">0.0030</td>
<td align="right">0.3401</td>
</tr>
<tr class="odd">
<td align="left">Events: 172</td>
<td align="left">~HR at bound</td>
<td align="right">0.6571</td>
<td align="right">0.9390</td>
</tr>
<tr class="even">
<td align="left">Month: 13</td>
<td align="left">P(Cross) if HR=1</td>
<td align="right">0.0030</td>
<td align="right">0.6599</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">P(Cross) if HR=0.7</td>
<td align="right">0.3412</td>
<td align="right">0.0269</td>
</tr>
<tr class="even">
<td align="left">Final</td>
<td align="left">Z</td>
<td align="right">1.9811</td>
<td align="right">1.9811</td>
</tr>
<tr class="odd">
<td align="left">N: 440</td>
<td align="left">p (1-sided)</td>
<td align="right">0.0238</td>
<td align="right">0.0238</td>
</tr>
<tr class="even">
<td align="left">Events: 344</td>
<td align="left">~HR at bound</td>
<td align="right">0.8074</td>
<td align="right">0.8074</td>
</tr>
<tr class="odd">
<td align="left">Month: 28</td>
<td align="left">P(Cross) if HR=1</td>
<td align="right">0.0239</td>
<td align="right">0.9761</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">P(Cross) if HR=0.7</td>
<td align="right">0.9000</td>
<td align="right">0.1000</td>
</tr>
</tbody>
</table>
<p>Although we did not use the <span class="citation">Schoenfeld (1981)</span> for sample size, it is still used for the approximate HR at bound calculation above:</p>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="no">events</span> <span class="kw">&lt;-</span> <span class="no">lfgs</span>$<span class="no">n.I</span>
<span class="no">z</span> <span class="kw">&lt;-</span> <span class="no">lfgs</span>$<span class="no">upper</span>$<span class="no">bound</span>
<span class="fu"><a href="../reference/nSurvival.html">zn2hr</a></span>(<span class="kw">z</span> <span class="kw">=</span> <span class="no">z</span>, <span class="kw">n</span> <span class="kw">=</span> <span class="no">events</span>) <span class="co"># Schoenfeld approximation to HR</span>
<span class="co">#&gt; [1] 0.6571386 0.8074431</span></pre></body></html></div>
</div>
<div id="plotting" class="section level3">
<h3 class="hasAnchor">
<a href="#plotting" class="anchor"></a>Plotting</h3>
<p>There are various plots available. The approximate hazard ratios required to cross bounds again use the <span class="citation">Schoenfeld (1981)</span> approximation. For a <strong>ggplot2</strong> version of this plot, use the default <code>base = FALSE</code>.</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="no">lfgs</span>, <span class="kw">pl</span><span class="kw">=</span><span class="st">"hr"</span>, <span class="kw">dgt</span><span class="kw">=</span><span class="fl">4</span>, <span class="kw">base</span><span class="kw">=</span><span class="fl">TRUE</span>)</pre></body></html></div>
<p><img src="SurvivalOverview_files/figure-html/unnamed-chunk-25-1.png" width="624"></p>
</div>
<div id="event-accrual" class="section level3">
<h3 class="hasAnchor">
<a href="#event-accrual" class="anchor"></a>Event accrual</h3>
<p>The variance calculations for the Lachin and Foulkes method are mostly determined by expected event accrual under the null and alternate hypotheses. The null hypothesis characterized above is seemingly designed so that event accrual will be similar under each hypothesis. You can see the expected events accrued at each analysis under the alternate hypothesis with:</p>
<div class="sourceCode" id="cb25"><html><body><pre class="r"><span class="kw pkg">tibble</span><span class="kw ns">::</span><span class="fu"><a href="https://tibble.tidyverse.org/reference/tibble.html">tibble</a></span>(<span class="kw">Analysis</span> <span class="kw">=</span> <span class="fl">1</span>:<span class="fl">2</span>,
               <span class="kw">`Control events`</span> <span class="kw">=</span> <span class="no">lfgs</span>$<span class="no">eDC</span>,
               <span class="kw">`Experimental events`</span> <span class="kw">=</span>  <span class="no">lfgs</span>$<span class="no">eDE</span>) <span class="kw">%&gt;%</span>
  <span class="fu">kable</span>()</pre></body></html></div>
<table class="table">
<thead><tr class="header">
<th align="right">Analysis</th>
<th align="right">Control events</th>
<th align="right">Experimental events</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="right">1</td>
<td align="right">96.82001</td>
<td align="right">74.77511</td>
</tr>
<tr class="even">
<td align="right">2</td>
<td align="right">184.06813</td>
<td align="right">159.12213</td>
</tr>
</tbody>
</table>
<p>It is worth noting that if events accrue at the same rate in both the null and alternate hypothesis, then the expected duration of time to achieve the targeted events would be shortened. Keep in mind that there can be many reasons events will accrue at a different rate than in the design plan.</p>
<p>The expected event accrual of events over time for a design can be computed as follows:</p>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">Month</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="fl">0.025</span>, <span class="no">enrollDuration</span> + <span class="no">minfup</span>, <span class="fl">.025</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="no">Month</span>),
     <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>, <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span>(<span class="no">Month</span>, <span class="kw">function</span>(<span class="no">x</span>){<span class="fu"><a href="../reference/nSurv.html">nEventsIA</a></span>(<span class="kw">tIA</span><span class="kw">=</span><span class="no">x</span>, <span class="kw">x</span> <span class="kw">=</span> <span class="no">lfgs</span>)})),
     <span class="kw">type</span> <span class="kw">=</span> <span class="st">'l'</span>, <span class="kw">xlab</span><span class="kw">=</span><span class="st">"Month"</span>, <span class="kw">ylab</span><span class="kw">=</span><span class="st">"Expected events"</span>,
     <span class="kw">main</span><span class="kw">=</span><span class="st">"Expected event accrual over time"</span>)</pre></body></html></div>
<p><img src="SurvivalOverview_files/figure-html/unnamed-chunk-27-1.png" width="624"></p>
<p>On the other hand, if you want to know the expected time to accrue 25% of the final events and what the expected enrollment accrual is at that time, you compute using:</p>
<div class="sourceCode" id="cb27"><html><body><pre class="r"><span class="no">b</span> <span class="kw">&lt;-</span> <span class="fu"><a href="../reference/nSurv.html">tEventsIA</a></span>(<span class="kw">x</span> <span class="kw">=</span> <span class="no">lfgs</span>, <span class="kw">timing</span> <span class="kw">=</span> <span class="fl">0.25</span>)
<span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span>(<span class="st">" Time: "</span>, <span class="no">b</span>$<span class="no">T</span>,
          <span class="st">"\n Expected enrollment:"</span>, <span class="no">b</span>$<span class="no">eNC</span> + <span class="no">b</span>$<span class="no">eNE</span>,
          <span class="st">"\n Expected control events:"</span>, <span class="no">b</span>$<span class="no">eDC</span>,
          <span class="st">"\n Expected experimental events:"</span>, <span class="no">b</span>$<span class="no">eDE</span>, <span class="st">"\n"</span>))
<span class="co">#&gt;  Time:  8.88072854965729 </span>
<span class="co">#&gt;  Expected enrollment: 325.066468979827 </span>
<span class="co">#&gt;  Expected control events: 49.0303966242417 </span>
<span class="co">#&gt;  Expected experimental events: 36.7672374839294</span></pre></body></html></div>
<p>For expected accrual of events without a design returned by <code><a href="../reference/nSurv.html">gsDesign::gsSurv()</a></code>, see the help file for <code><a href="../reference/eEvents.html">gsDesign::eEvents()</a></code>.</p>
</div>
</div>
<div id="references" class="section level2 unnumbered">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<div id="refs" class="references">
<div id="ref-JTBook">
<p>Jennison, Christopher, and Bruce W. Turnbull. 2000. <em>Group Sequential Methods with Applications to Clinical Trials</em>. Boca Raton, FL: Chapman; Hall/CRC.</p>
</div>
<div id="ref-KimTsiatis">
<p>Kim, Kyungmann, and Anastasios A. Tsiatis. 1990. â€œStudy Duration for Clinical Trials with Survival Response and Early Stopping Rule.â€ <em>Biometrics</em> 46: 81â€“92.</p>
</div>
<div id="ref-LachinFoulkes">
<p>Lachin, John M., and Mary A. Foulkes. 1986. â€œEvaluation of Sample Size and Power for Analyses of Survival with Allowance for Nonuniform Patient Entry, Losses to Follow-up, Noncompliance, and Stratification.â€ <em>Biometrics</em> 42: 507â€“19.</p>
</div>
<div id="ref-Schoenfeld1981">
<p>Schoenfeld, David. 1981. â€œThe Asymptotic Properties of Nonparametric Tests for Comparing Survival Distributions.â€ <em>Biometrika</em> 68 (1): 316â€“19.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Keaven Anderson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.9000.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
