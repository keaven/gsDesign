<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Conditional power and conditional error • gsDesign</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><link href="../deps/KaTex-0.16.10/katex.min.css" rel="stylesheet">
<script src="../deps/KaTex-0.16.10/katex.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Conditional power and conditional error">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gsDesign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.6.7</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/keaven/gsDesign/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Conditional power and conditional error</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/keaven/gsDesign/blob/v3.6.7/vignettes/ConditionalPowerPlot.Rmd" class="external-link"><code>vignettes/ConditionalPowerPlot.Rmd</code></a></small>
      <div class="d-none name"><code>ConditionalPowerPlot.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>We provide a simple plot of conditional power at the time of interim
analysis. While group sequential boundaries should be designed to be the
primary decision boundaries, conditional power evaluations can be useful
supportive information. In addition to conditional power, we provide a
predictive power estimate that averages conditional power based on a
flat prior updated using an interim analysis result.</p>
</div>
<div class="section level2">
<h2 id="design">Design<a class="anchor" aria-label="anchor" href="#design"></a>
</h2>
<p>We consider the default design from <code><a href="../reference/nSurv.html">gsSurv()</a></code>, only
altering the targeted hazard ratio to <code>hr = 0.7</code>, trial
duration of <code>T = 36</code> and minimum follow-up of
<code>minfup = 24</code>. This implies expected enrollment duration of
12 months at a constant rate. We note that the expected interim analysis
timing leaves enough time for a data monitoring committee (DMC) to
review and make recommendations to the trial sponsor between analyses.
We use the <code><a href="../reference/toInteger.html">toInteger()</a></code> function to round sample size and
event counts to appropriate integers resulting in a slightly larger
power (90.05% versus the targeted 90%) and slightly altered interim
timing (117/353 = 0.3314, 235/353 = 0.6657) compared to plan (0.3333,
0.6667).</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">design</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nSurv.html">gsSurv</a></span><span class="op">(</span>hr <span class="op">=</span> <span class="fl">0.7</span>, lambdaC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">12</span>, minfup <span class="op">=</span> <span class="fl">24</span>, T <span class="op">=</span> <span class="fl">36</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/toInteger.html">toInteger</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="va">design</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="../reference/gsBoundSummary.html">gsBoundSummary</a></span><span class="op">(</span><span class="op">)</span></span>
<span><span class="co">#&gt;     Analysis              Value Efficacy Futility</span></span>
<span><span class="co">#&gt;    IA 1: 33%                  Z   3.0139  -0.2451</span></span>
<span><span class="co">#&gt;       N: 464        p (1-sided)   0.0013   0.5968</span></span>
<span><span class="co">#&gt;  Events: 117       ~HR at bound   0.5728   1.0464</span></span>
<span><span class="co">#&gt;    Month: 12   P(Cross) if HR=1   0.0013   0.4032</span></span>
<span><span class="co">#&gt;              P(Cross) if HR=0.7   0.1398   0.0147</span></span>
<span><span class="co">#&gt;    IA 2: 67%                  Z   2.5478   0.9413</span></span>
<span><span class="co">#&gt;       N: 464        p (1-sided)   0.0054   0.1733</span></span>
<span><span class="co">#&gt;  Events: 235       ~HR at bound   0.7172   0.8844</span></span>
<span><span class="co">#&gt;    Month: 21   P(Cross) if HR=1   0.0062   0.8347</span></span>
<span><span class="co">#&gt;              P(Cross) if HR=0.7   0.5814   0.0436</span></span>
<span><span class="co">#&gt;        Final                  Z   1.9991   1.9991</span></span>
<span><span class="co">#&gt;       N: 464        p (1-sided)   0.0228   0.0228</span></span>
<span><span class="co">#&gt;  Events: 353       ~HR at bound   0.8083   0.8083</span></span>
<span><span class="co">#&gt;    Month: 36   P(Cross) if HR=1   0.0233   0.9767</span></span>
<span><span class="co">#&gt;              P(Cross) if HR=0.7   0.9005   0.0995</span></span></code></pre></div>
<p>We also provide a textual summary.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="va">design</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>Asymmetric two-sided group sequential design with non-binding
futility bound, 3 analyses, time-to-event outcome with sample size 464
and 353 events required, 90 percent power, 2.5 percent (1-sided) Type I
error to detect a hazard ratio of 0.7. Enrollment and total study
durations are assumed to be 12 and 36.1 months, respectively. Efficacy
bounds derived using a Hwang-Shih-DeCani spending function with gamma =
-4. Futility bounds derived using a Hwang-Shih-DeCani spending function
with gamma = -2.</p>
</div>
<div class="section level2">
<h2 id="update-design-at-time-of-interim-analysis">Update design at time of interim analysis<a class="anchor" aria-label="anchor" href="#update-design-at-time-of-interim-analysis"></a>
</h2>
<p>Assume when the first interim is performed, there are 125 instead of
the planned 117 endpoints included in the analysis. We update the bounds
as follows:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">update</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsDesign.html">gsDesign</a></span><span class="op">(</span></span>
<span>  k <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">k</span>,</span>
<span>  test.type <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">test.type</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">alpha</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">beta</span>,</span>
<span>  sfu <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">sf</span>,</span>
<span>  sfupar <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">param</span>,</span>
<span>  sfl <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">lower</span><span class="op">$</span><span class="va">sf</span>,</span>
<span>  sflpar <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">lower</span><span class="op">$</span><span class="va">param</span>,</span>
<span>  n.I <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">117</span>, <span class="va">design</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="fl">3</span><span class="op">]</span><span class="op">)</span>,</span>
<span>  maxn.IPlan <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="va">design</span><span class="op">$</span><span class="va">k</span><span class="op">]</span>,</span>
<span>  delta <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">delta</span>,</span>
<span>  delta1 <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">delta1</span>,</span>
<span>  delta0 <span class="op">=</span> <span class="va">design</span><span class="op">$</span><span class="va">delta0</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gsBoundSummary.html">gsBoundSummary</a></span><span class="op">(</span></span>
<span>  <span class="va">update</span>,</span>
<span>  deltaname <span class="op">=</span> <span class="st">"HR"</span>,</span>
<span>  logdelta <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  Nname <span class="op">=</span> <span class="st">"Events"</span>,</span>
<span>  digits <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  ddigits <span class="op">=</span> <span class="fl">2</span>,</span>
<span>  tdigits <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  exclude <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>    <span class="st">"B-value"</span>, <span class="st">"CP"</span>, <span class="st">"CP H1"</span>, <span class="st">"PP"</span>,</span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste0</a></span><span class="op">(</span><span class="st">"P(Cross) if HR="</span>, <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">round</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">design</span><span class="op">$</span><span class="va">hr0</span>, <span class="va">design</span><span class="op">$</span><span class="va">hr</span><span class="op">)</span>, digits <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;     Analysis        Value Efficacy Futility</span></span>
<span><span class="co">#&gt;    IA 1: 33%            Z   3.0139  -0.2451</span></span>
<span><span class="co">#&gt;  Events: 117  p (1-sided)   0.0013   0.5968</span></span>
<span><span class="co">#&gt;              ~HR at bound   0.5728   1.0464</span></span>
<span><span class="co">#&gt;                  Spending   0.0013   0.0147</span></span>
<span><span class="co">#&gt;    IA 2: 67%            Z   2.5478   0.9413</span></span>
<span><span class="co">#&gt;  Events: 235  p (1-sided)   0.0054   0.1733</span></span>
<span><span class="co">#&gt;              ~HR at bound   0.7172   0.8844</span></span>
<span><span class="co">#&gt;                  Spending   0.0049   0.0289</span></span>
<span><span class="co">#&gt;        Final            Z   1.9991   1.9991</span></span>
<span><span class="co">#&gt;  Events: 353  p (1-sided)   0.0228   0.0228</span></span>
<span><span class="co">#&gt;              ~HR at bound   0.8083   0.8083</span></span>
<span><span class="co">#&gt;                  Spending   0.0188   0.0564</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="testing-and-conditional-power">Testing and conditional power<a class="anchor" aria-label="anchor" href="#testing-and-conditional-power"></a>
</h2>
<p>We assume an interim p-value of 0.04, one-sided. This does not come
close to the first efficacy or futility bound above. However, it is a
trend in the right direction.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Nominal 1-sided p-value</span></span>
<span><span class="va">p</span> <span class="op">&lt;-</span> <span class="fl">0.04</span></span></code></pre></div>
<p>This translates to a first order approximation of the Cox regression
estimate with the <span class="citation">Schoenfeld (1981)</span>
approximation:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/nSurvival.html">zn2hr</a></span><span class="op">(</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, n <span class="op">=</span> <span class="va">update</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.7234658</span></span></code></pre></div>
<p>Typically, conditional power is reported based on 3 different
assumptions about the future treatment effect:</p>
<ol style="list-style-type: decimal">
<li>The observed HR; here we base this on the above approximation.</li>
<li>No treatment effect; this translates to conditional error.</li>
<li>The originally targeted treatment effect in the design.</li>
</ol>
<p>These are displayed below, translated to the hazard ratio scale:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsCP.html">gsCP</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">update</span>, i <span class="op">=</span> <span class="fl">1</span>, zi <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co"># 3 treatment effects as outlined above</span></span>
<span><span class="co"># design$ratio is the experimental:control randomization ratio</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">exp</a></span><span class="op">(</span><span class="op">-</span><span class="va">cp</span><span class="op">$</span><span class="va">theta</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">design</span><span class="op">$</span><span class="va">ratio</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span> <span class="op">/</span> <span class="va">design</span><span class="op">$</span><span class="va">ratio</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.7234658 1.0000000 0.6995487</span></span></code></pre></div>
<p>Now we display the probability of crossing an efficacy boundary
before a futility boundary conditional on the above observed p-value at
the first interim analysis from the above call to <code><a href="../reference/gsCP.html">gsCP()</a></code>.
The columns of the resulting matrix correspond to the above treatment
effects. The rows correspond to the second interim and final analyses.
Adding the numbers in the first column, we get a conditional power of
0.899 for the treatment effect observed at the first interim. The third
column yields a conditional power of 0.937 for the originally targeted
hazard ratio of 0.7. Finally, the second column yields a conditional
error under the assumption of a future hazard ratio of 1 (no underlying
treatment effect) of 0.121. This could be used with the conditional
error method of <span class="citation">Müller and Schäfer (2004)</span>
to adapt the design for endpoints other than the time-to-event example
used here (e.g., a binary outcome).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">cp</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">prob</span></span>
<span><span class="co">#&gt;           [,1]       [,2]      [,3]</span></span>
<span><span class="co">#&gt; [1,] 0.4625266 0.03199697 0.5352688</span></span>
<span><span class="co">#&gt; [2,] 0.4364291 0.08886339 0.4017165</span></span></code></pre></div>
<p>We demonstrate a conditional power plot that may be of some use. We
will assume a wide range of potential underlying hazard ratios for
future events.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">hr</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">.6</span>, <span class="fl">1.1</span>, <span class="fl">.01</span><span class="op">)</span></span></code></pre></div>
<p>We compute conditional probabilities based on the observed interim 1
p-value over this range:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Translate hazard ratio to standardized effect size</span></span>
<span><span class="va">theta</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="va">hr</span><span class="op">)</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="va">design</span><span class="op">$</span><span class="va">ratio</span> <span class="op">/</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">design</span><span class="op">$</span><span class="va">ratio</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">cp</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsCP.html">gsCP</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">update</span>, i <span class="op">=</span> <span class="fl">1</span>, zi <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, theta <span class="op">=</span> <span class="va">theta</span><span class="op">)</span></span></code></pre></div>
<p>Finally, we plot conditional power as a function of future HR. Note
the use of the power plot option for the <strong>gsDesign</strong> plot
function. The <code>offset = 1</code> argument changes the legend to be
labeled with “Future Analysis” 2 and 3. The solid black line shows the
conditional probability of crossing any future bound prior to crossing a
lower bound. In general, black lines on this plot will show the
cumulative conditional probability of crossing an efficacy bound prior
to crossing a lower bound by the time of any given future analysis by
different underlying treatment effect assumptions. The red lines show 1
minus the cumulative conditional probability of crossing a lower bound
prior to crossing an efficacy bound by any given future analysis by
different underlying treatment effect (HR) assumptions.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">cp</span>, xval <span class="op">=</span> <span class="va">hr</span>, xlab <span class="op">=</span> <span class="st">"Future HR"</span>, ylab <span class="op">=</span> <span class="st">"Conditional Power/Error"</span>, </span>
<span>     main<span class="op">=</span><span class="st">"Conditional probability of crossing future bound"</span>, offset <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p><img src="ConditionalPowerPlot_files/figure-html/unnamed-chunk-12-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div class="section level2">
<h2 id="predictive-power">Predictive power<a class="anchor" aria-label="anchor" href="#predictive-power"></a>
</h2>
<p>Assuming a flat prior distribution and a constant treatment
underlying treatment effect throughout the trial, we can compute a
Bayesian predictive power conditioning on the interim <span class="math inline">p</span>-value above. This takes into account the
uncertainty of the underlying treatment effect, updating the flat prior
based on the interim result and using the resulting posterior
distribution to average across total conditional probabilities from the
conditional power plot above. This provides a single number to summarize
the conditional probability of success given the interim result.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># set up a flat prior distribution for the treatment effect</span></span>
<span><span class="co"># that is normal with mean .5 of the design standardized effect and</span></span>
<span><span class="co"># a large standard deviation. </span></span>
<span><span class="va">mu0</span> <span class="op">&lt;-</span> <span class="fl">.5</span> <span class="op">*</span> <span class="va">design</span><span class="op">$</span><span class="va">delta</span> </span>
<span><span class="va">sigma0</span> <span class="op">&lt;-</span> <span class="va">design</span><span class="op">$</span><span class="va">delta</span> <span class="op">*</span> <span class="fl">2</span></span>
<span><span class="va">prior</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/normalGrid.html">normalGrid</a></span><span class="op">(</span>mu <span class="op">=</span> <span class="va">mu0</span>, sigma <span class="op">=</span> <span class="va">sigma0</span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gsCP.html">gsPP</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">update</span>, i <span class="op">=</span> <span class="fl">1</span>, zi <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">qnorm</a></span><span class="op">(</span><span class="va">p</span><span class="op">)</span>, theta <span class="op">=</span> <span class="va">prior</span><span class="op">$</span><span class="va">z</span>, wgts <span class="op">=</span> <span class="va">prior</span><span class="op">$</span><span class="va">wgts</span><span class="op">)</span></span>
<span><span class="co">#&gt; [1] 0.7631346</span></span></code></pre></div>
<p>While the conditional power based on the observed effect was
essentially 90%, we now have an estimate that effectively shrinks
towards a lesser effect based on the uncertainly of the observed
treatment effect. The predictive probability is similar whether
<code>mu0</code> above is <code>0</code> or
<code>design$delta</code>.</p>
</div>
<div class="section level2 unnumbered">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-muller2004general" class="csl-entry">
Müller, Hans-Helge, and Helmut Schäfer. 2004. <span>“A General
Statistical Principle for Changing a Design Any Time During the Course
of a Trial.”</span> <em>Statistics in Medicine</em> 23 (16): 2497–2508.
</div>
<div id="ref-Schoenfeld1981" class="csl-entry">
Schoenfeld, David. 1981. <span>“The Asymptotic Properties of
Nonparametric Tests for Comparing Survival Distributions.”</span>
<em>Biometrika</em> 68 (1): 316–19.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Keaven Anderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.1.</p>
</div>

    </footer>
</div>





  </body>
</html>
