<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spending Time • gsDesign</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Spending Time">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">gsDesign</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/SpendingTime.html">Spending Time</a>
    </li>
    <li>
      <a href="../articles/gsSurvTemplate.html">Template for time-to-event group sequential design</a>
    </li>
    <li>
      <a href="../articles/gsSurvTemplateInstructions.html">Template instructions for time-to-event group sequential design</a>
    </li>
    <li>
      <a href="../articles/tests_and_coverage.html">Tests and Coverage</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Spending Time</h1>
                        <h4 class="author">Keaven M. Anderson</h4>
            
            <h4 class="date">2019-12-30</h4>
      
      
      <div class="hidden name"><code>SpendingTime.Rmd</code></div>

    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(gsDesign)</a>
<a class="sourceLine" id="cb1-2" data-line-number="2"><span class="co">#&gt; Loading required package: xtable</span></a>
<a class="sourceLine" id="cb1-3" data-line-number="3"><span class="co">#&gt; Loading required package: ggplot2</span></a></code></pre></div>
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>This vignette provides examples demonstrating uses of spending time, a concept introduced in version 3.0-4. One simple example of this is by plugging a calendar time fraction  into an <span class="math inline">\(\alpha\)</span>-spending function rather than an information fraction. However, the concept is more general than this and may apply to other situations that will be demonstrated below. The situations we will consider are:</p>
<ul>
<li>Fixed spending at each interim analysis as demonstrated with an approximation to a Haybittle-Peto bound.</li>
<li>Spending time based on information fraction from a different population analyzed for the same endpoint where the final event count for the given hypothesis is unknown.</li>
<li>These examples will also be used to demonstrate how to deal with interim analysis event counts during the course that differ substantially from planned.</li>
</ul>
</div>
<div id="calendar-time" class="section level1">
<h1 class="hasAnchor">
<a href="#calendar-time" class="anchor"></a>Calendar Time</h1>
</div>
<div id="haybittle-peto-bound-approximation" class="section level1">
<h1 class="hasAnchor">
<a href="#haybittle-peto-bound-approximation" class="anchor"></a>Haybittle-Peto Bound Approximation</h1>
</div>
<div id="unknown-final-event-count" class="section level1">
<h1 class="hasAnchor">
<a href="#unknown-final-event-count" class="anchor"></a>Unknown Final Event Count</h1>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="co"># code here applies to both fixed and group sequential design sections below.</span></a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="co"># name of primary endpoint and time units</span></a>
<a class="sourceLine" id="cb2-3" data-line-number="3">ep &lt;-<span class="st"> "overall survival"</span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4">timename &lt;-<span class="st"> "months"</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5">timename1 &lt;-<span class="st"> "month"</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co"># enrollment period durations; the last of these will be extended if T=NULL below</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7">R &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co"># relative enrollment rates during above periods</span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9">gamma&lt;-<span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1</span>,<span class="fl">1.5</span>,<span class="fl">2.5</span>,<span class="dv">4</span>)</a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co"># study duration</span></a>
<a class="sourceLine" id="cb2-11" data-line-number="11"><span class="co"># T can be set to NULL if you want to </span></a>
<a class="sourceLine" id="cb2-12" data-line-number="12"><span class="co"># fix enrollment and vary study duration</span></a>
<a class="sourceLine" id="cb2-13" data-line-number="13">T &lt;-<span class="st"> </span><span class="dv">36</span> </a>
<a class="sourceLine" id="cb2-14" data-line-number="14"><span class="co"># follow-up duration of last patient enrolled</span></a>
<a class="sourceLine" id="cb2-15" data-line-number="15">minfup &lt;-<span class="st"> </span><span class="dv">12</span></a>
<a class="sourceLine" id="cb2-16" data-line-number="16"><span class="co"># randomization ratio, experimental/control</span></a>
<a class="sourceLine" id="cb2-17" data-line-number="17">ratio &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-18" data-line-number="18"><span class="co"># median control time-to-event</span></a>
<a class="sourceLine" id="cb2-19" data-line-number="19">median &lt;-<span class="st"> </span><span class="dv">12</span></a>
<a class="sourceLine" id="cb2-20" data-line-number="20"><span class="co"># exponential dropout rate per unit of time</span></a>
<a class="sourceLine" id="cb2-21" data-line-number="21">eta &lt;-<span class="st"> </span><span class="fl">.001</span></a>
<a class="sourceLine" id="cb2-22" data-line-number="22"><span class="co"># hypothesized experimental/control hazard ratio</span></a>
<a class="sourceLine" id="cb2-23" data-line-number="23">hr &lt;-<span class="st"> </span><span class="fl">.75</span></a>
<a class="sourceLine" id="cb2-24" data-line-number="24"><span class="co"># null hazard ratio (1 for superiority, &gt;1 for non-inferiority)</span></a>
<a class="sourceLine" id="cb2-25" data-line-number="25">hr0 &lt;-<span class="st"> </span><span class="dv">1</span></a>
<a class="sourceLine" id="cb2-26" data-line-number="26"><span class="co"># Type I error (1-sided)</span></a>
<a class="sourceLine" id="cb2-27" data-line-number="27">alpha &lt;-.<span class="dv">025</span></a>
<a class="sourceLine" id="cb2-28" data-line-number="28"><span class="co"># Type II error (1-power)</span></a>
<a class="sourceLine" id="cb2-29" data-line-number="29">beta&lt;-.<span class="dv">2</span></a>
<a class="sourceLine" id="cb2-30" data-line-number="30"><span class="co"># number of analyses (interim + final)</span></a>
<a class="sourceLine" id="cb2-31" data-line-number="31">k &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb2-32" data-line-number="32"><span class="co"># timing of interim analyses (k-1 increasing numbers &gt;0 and &lt;1)</span></a>
<a class="sourceLine" id="cb2-33" data-line-number="33">timing &lt;-<span class="st"> </span><span class="fl">.7</span></a>
<a class="sourceLine" id="cb2-34" data-line-number="34"><span class="co"># efficacy bound spending function</span></a>
<a class="sourceLine" id="cb2-35" data-line-number="35">sfu &lt;-<span class="st"> </span>sfLDOF </a>
<a class="sourceLine" id="cb2-36" data-line-number="36"><span class="co"># efficacy bound spending parameter specification</span></a>
<a class="sourceLine" id="cb2-37" data-line-number="37">sfupar &lt;-<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb2-38" data-line-number="38"><span class="co"># futility bound spending function</span></a>
<a class="sourceLine" id="cb2-39" data-line-number="39">sfl &lt;-<span class="st"> </span>sfHSD </a>
<a class="sourceLine" id="cb2-40" data-line-number="40"><span class="co"># futility bound spending parameter specification</span></a>
<a class="sourceLine" id="cb2-41" data-line-number="41">sflpar &lt;-<span class="st"> </span><span class="dv">2</span></a>
<a class="sourceLine" id="cb2-42" data-line-number="42"><span class="co"># generate design</span></a>
<a class="sourceLine" id="cb2-43" data-line-number="43">x &lt;-<span class="st"> </span><span class="kw"><a href="../reference/nSurv.html">gsSurv</a></span>(<span class="dt">k=</span>k,<span class="dt">timing=</span>timing,<span class="dt">R=</span>R,<span class="dt">gamma=</span>gamma,<span class="dt">eta=</span>eta,</a>
<a class="sourceLine" id="cb2-44" data-line-number="44">            <span class="dt">minfup=</span>minfup,<span class="dt">T=</span>T,<span class="dt">lambdaC=</span><span class="kw"><a href="https://rdrr.io/r/base/Log.html">log</a></span>(<span class="dv">2</span>)<span class="op">/</span>median,</a>
<a class="sourceLine" id="cb2-45" data-line-number="45">            <span class="dt">hr=</span>hr,<span class="dt">hr0=</span>hr0,<span class="dt">beta=</span>beta,<span class="dt">alpha=</span>alpha,</a>
<a class="sourceLine" id="cb2-46" data-line-number="46">            <span class="dt">sfu=</span>sfu,<span class="dt">sfupar=</span>sfupar,<span class="dt">sfl=</span>sfl,<span class="dt">sflpar=</span>sflpar)</a></code></pre></div>
<p>For a comparative trial we consider a 2-arm group sequential design with overall survival as the primary endpoint as shown in Table  (a second version of the table is in . Timing, number of events, sample size, boundaries (Z-values, nominal p-values, approximate hazard ratios) are shown as well as the probability of crossing study boundaries under the null and alternate hypotheses. Bounds are determined by an O’Brien-Fleming spending function for superiority (<span class="math inline">\(\alpha\)</span>-spending) and a Hwang-Shih-DeCani spending function for futility with <span class="math inline">\(\gamma=\)</span> 2 (<span class="math inline">\(\beta\)</span>-spending). The median time-to-event is assumed to be 12 months in the control group. The trial is designed to demonstrate superiority of experimental treatment over control with an assumed hazard ratio of 0.75. The total sample size is 743 and a total of 487 endpoints is required for the final analysis. Planned recruitment duration is 24  and the minimum follow-up planned is 12 months. Thus, the total expected study duration is 36 months. The assumed dropout rate is 0.1% per month. There is a single interim analysis planned after 341 events have accrued which is expected after approximately 26.7 months.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1">knitr<span class="op">::</span><span class="kw"><a href="https://rdrr.io/pkg/knitr/man/kable.html">kable</a></span>(<span class="kw"><a href="../reference/gsBoundSummary.html">gsBoundSummary</a></span>(x),<span class="dt">digits=</span><span class="dv">4</span>,<span class="dt">row.names=</span><span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb3-2" data-line-number="2">             <span class="dt">caption=</span><span class="st">"Using kable to print a design summary."</span>)</a></code></pre></div>
<table class="table">
<caption>Using kable to print a design summary.</caption>
<thead><tr class="header">
<th align="left">Analysis</th>
<th align="left">Value</th>
<th align="right">Efficacy</th>
<th align="right">Futility</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">IA 1: 70%</td>
<td align="left">Z</td>
<td align="right">2.4380</td>
<td align="right">1.7191</td>
</tr>
<tr class="even">
<td align="left">N: 744</td>
<td align="left">p (1-sided)</td>
<td align="right">0.0074</td>
<td align="right">0.0428</td>
</tr>
<tr class="odd">
<td align="left">Events: 341</td>
<td align="left">~HR at bound</td>
<td align="right">0.7677</td>
<td align="right">0.8299</td>
</tr>
<tr class="even">
<td align="left">Month: 27</td>
<td align="left">P(Cross) if HR=1</td>
<td align="right">0.0074</td>
<td align="right">0.9572</td>
</tr>
<tr class="odd">
<td align="left"></td>
<td align="left">P(Cross) if HR=0.75</td>
<td align="right">0.5865</td>
<td align="right">0.1743</td>
</tr>
<tr class="even">
<td align="left">Final</td>
<td align="left">Z</td>
<td align="right">1.9999</td>
<td align="right">1.9999</td>
</tr>
<tr class="odd">
<td align="left">N: 744</td>
<td align="left">p (1-sided)</td>
<td align="right">0.0228</td>
<td align="right">0.0228</td>
</tr>
<tr class="even">
<td align="left">Events: 487</td>
<td align="left">~HR at bound</td>
<td align="right">0.8341</td>
<td align="right">0.8341</td>
</tr>
<tr class="odd">
<td align="left">Month: 36</td>
<td align="left">P(Cross) if HR=1</td>
<td align="right">0.0173</td>
<td align="right">0.9827</td>
</tr>
<tr class="even">
<td align="left"></td>
<td align="left">P(Cross) if HR=0.75</td>
<td align="right">0.8000</td>
<td align="right">0.2000</td>
</tr>
</tbody>
</table>
<p>Following are plots of the Z-values and approximate hazard ratios at the design bounds.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(x,<span class="dt">cex=</span>.<span class="dv">8</span>,<span class="dt">xlab=</span><span class="st">"Number of events"</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb4-2" data-line-number="2"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</a></code></pre></div>
<p><img src="SpendingTime_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1"><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(x,<span class="dt">plottype=</span><span class="st">"hr"</span>,<span class="dt">cex=</span>.<span class="dv">8</span>,<span class="dt">xlab=</span><span class="st">"Number of events"</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">"bottom"</span>)</a></code></pre></div>
<p><img src="SpendingTime_files/figure-html/unnamed-chunk-5-1.png" width="576"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">Introduction</a></li>
      <li><a href="#calendar-time">Calendar Time</a></li>
      <li><a href="#haybittle-peto-bound-approximation">Haybittle-Peto Bound Approximation</a></li>
      <li><a href="#unknown-final-event-count">Unknown Final Event Count</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Keaven Anderson.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
