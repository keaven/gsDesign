<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Selective bound testing at interim analyses • gsDesign</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<!-- mathjax math --><script src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script><script>
  window.MathJax = {
    chtml: {
      fontURL: "https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/output/chtml/fonts/woff-v2"
    }
  };
</script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Selective bound testing at interim analyses">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gsDesign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.9.0.9001</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/keaven/gsDesign/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Selective bound testing at interim analyses</h1>
                        <h4 data-toc-skip class="author">Keaven
Anderson</h4>
            
      
      <small class="dont-index">Source: <a href="https://github.com/keaven/gsDesign/blob/master/vignettes/SelectiveBoundTesting.Rmd" class="external-link"><code>vignettes/SelectiveBoundTesting.Rmd</code></a></small>
      <div class="d-none name"><code>SelectiveBoundTesting.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h2>
<p>In many clinical trial designs, it is desirable to test only certain
boundaries at specific interim analyses. For example:</p>
<ul>
<li>
<strong>Futility testing at early interims only</strong>: In some
trial designs, a futility assessment is only meaningful at the first
interim analysis. Later analyses focus solely on efficacy.</li>
<li>
<strong>No efficacy testing at the first interim</strong>: Some
regulatory or operational considerations may preclude testing for
efficacy at the very first interim.</li>
<li>
<strong>Selective harm monitoring</strong>: For designs with harm
bounds (<code>test.type = 7</code> or <code>8</code>), harm monitoring
may be needed only at certain analyses.</li>
</ul>
<p>The <code>testUpper</code>, <code>testLower</code>, and
<code>testHarm</code> parameters in <code><a href="../reference/gsDesign.html">gsDesign()</a></code>,
<code><a href="../reference/nSurv.html">gsSurv()</a></code>, and <code><a href="../reference/gsSurvCalendar.html">gsSurvCalendar()</a></code> allow
fine-grained control over which bounds are active at each analysis. When
a bound is inactive at a given analysis, it is set to an extreme value
(<span class="math inline">\(\pm 20\)</span> on the Z-scale) so that it
cannot be crossed, and is displayed as <code>NA</code> in summaries.</p>
</div>
<div class="section level2">
<h2 id="parameters">Parameters<a class="anchor" aria-label="anchor" href="#parameters"></a>
</h2>
<p>Each of <code>testUpper</code>, <code>testLower</code>, and
<code>testHarm</code> accepts either a single logical value (recycled to
all analyses) or a logical vector of length <code>k</code> (the number
of analyses):</p>
<table class="table">
<colgroup>
<col width="23%">
<col width="28%">
<col width="19%">
<col width="28%">
</colgroup>
<thead><tr class="header">
<th>Parameter</th>
<th>Description</th>
<th>Default</th>
<th>Constraints</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>testUpper</code></td>
<td>Test the upper (efficacy) bound</td>
<td><code>TRUE</code></td>
<td>Must be <code>TRUE</code> at the final analysis. For
<code>test.type</code> 1 and 2, overridden to all
<code>TRUE</code>.</td>
</tr>
<tr class="even">
<td><code>testLower</code></td>
<td>Test the lower (futility) bound</td>
<td><code>TRUE</code></td>
<td>Ignored for <code>test.type = 1</code> (one-sided). Overridden to
all <code>TRUE</code> for <code>test.type = 2</code> (symmetric). For
<code>test.type &gt;= 3</code>, at least one analysis must have
<code>testLower = TRUE</code>.</td>
</tr>
<tr class="odd">
<td><code>testHarm</code></td>
<td>Test the harm bound</td>
<td><code>TRUE</code></td>
<td>Only applies to <code>test.type = 7</code> or <code>8</code>. At
least one analysis must have <code>testHarm = TRUE</code>.</td>
</tr>
</tbody>
</table>
<p><strong>Validation</strong>: At every analysis, at least one of the
active bounds must be <code>TRUE</code>. If all three are
<code>FALSE</code> at any analysis, an error is raised.</p>
</div>
<div class="section level2">
<h2 id="example-1-futility-testing-only-at-the-first-interim">Example 1: Futility testing only at the first interim<a class="anchor" aria-label="anchor" href="#example-1-futility-testing-only-at-the-first-interim"></a>
</h2>
<p>A common scenario is to test for futility only at the first interim
analysis, with efficacy testing at all analyses. This is useful when the
trial’s data monitoring committee wants an early “go/no-go” decision,
but not ongoing futility monitoring.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3-analysis design with non-binding futility (test.type = 4)</span></span>
<span><span class="co"># Futility testing only at IA1</span></span>
<span><span class="va">x1</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsDesign.html">gsDesign</a></span><span class="op">(</span></span>
<span>  k <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  test.type <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  sfu <span class="op">=</span> <span class="va">sfHSD</span>,</span>
<span>  sfupar <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>,</span>
<span>  sfl <span class="op">=</span> <span class="va">sfHSD</span>,</span>
<span>  sflpar <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>,</span>
<span>  testLower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The lower bound is active only at IA1. At IA2 and the final analysis,
the futility bound shows as <code>NA</code>:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gsBoundSummary.html">gsBoundSummary</a></span><span class="op">(</span><span class="va">x1</span><span class="op">)</span></span>
<span><span class="co">#&gt;                Analysis               Value Efficacy Futility</span></span>
<span><span class="co">#&gt;               IA 1: 33%                   Z   3.0107  -0.2387</span></span>
<span><span class="co">#&gt;  N/Fixed design N: 0.36         p (1-sided)   0.0013   0.5943</span></span>
<span><span class="co">#&gt;                             ~delta at bound   1.5553  -0.1233</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=0   0.0013   0.4057</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=1   0.1412   0.0148</span></span>
<span><span class="co">#&gt;               IA 2: 67%                   Z   2.5465       NA</span></span>
<span><span class="co">#&gt;  N/Fixed design N: 0.71         p (1-sided)   0.0054       NA</span></span>
<span><span class="co">#&gt;                             ~delta at bound   0.9302       NA</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=0   0.0062       NA</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=1   0.5815       NA</span></span>
<span><span class="co">#&gt;                   Final                   Z   1.9992       NA</span></span>
<span><span class="co">#&gt;  N/Fixed design N: 1.07         p (1-sided)   0.0228       NA</span></span>
<span><span class="co">#&gt;                             ~delta at bound   0.5963       NA</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=0   0.0244       NA</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=1   0.9077       NA</span></span></code></pre></div>
<p>The probabilities under the null and alternative are recomputed
accounting for the inactive bounds. Notice the cumulative futility
crossing probability does not increase after IA1 since no further
futility testing occurs.</p>
<p>We can also see the bounds in the <code><a href="https://rdrr.io/r/base/print.html" class="external-link">print()</a></code> output:</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x1</span></span>
<span><span class="co">#&gt; Asymmetric two-sided group sequential design with</span></span>
<span><span class="co">#&gt; 90 % power and 2.5 % Type I Error.</span></span>
<span><span class="co">#&gt; Upper bound spending computations assume</span></span>
<span><span class="co">#&gt; trial continues if lower bound is crossed.</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;            Sample</span></span>
<span><span class="co">#&gt;             Size    ----Lower bounds----  ----Upper bounds-----</span></span>
<span><span class="co">#&gt;   Analysis Ratio*   Z   Nominal p Spend+  Z   Nominal p Spend++</span></span>
<span><span class="co">#&gt;          1  0.357 -0.24    0.4057 0.0148 3.01    0.0013  0.0013</span></span>
<span><span class="co">#&gt;          2  0.713    NA        NA     NA 2.55    0.0054  0.0049</span></span>
<span><span class="co">#&gt;          3  1.070    NA        NA     NA 2.00    0.0228  0.0188</span></span>
<span><span class="co">#&gt;      Total                        0.0148                 0.0250 </span></span>
<span><span class="co">#&gt; + lower bound beta spending (under H1):</span></span>
<span><span class="co">#&gt;  Hwang-Shih-DeCani spending function with gamma = -2.</span></span>
<span><span class="co">#&gt; ++ alpha spending:</span></span>
<span><span class="co">#&gt;  Hwang-Shih-DeCani spending function with gamma = -4.</span></span>
<span><span class="co">#&gt; * Sample size ratio compared to fixed design with no interim</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Boundary crossing probabilities and expected sample size</span></span>
<span><span class="co">#&gt; assume any cross stops the trial</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Upper boundary (power or Type I Error)</span></span>
<span><span class="co">#&gt;           Analysis</span></span>
<span><span class="co">#&gt;    Theta      1      2      3  Total   E{N}</span></span>
<span><span class="co">#&gt;   0.0000 0.0013 0.0049 0.0181 0.0244 0.7779</span></span>
<span><span class="co">#&gt;   3.2415 0.1412 0.4403 0.3262 0.9077 0.8016</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Lower boundary (futility or Type II Error)</span></span>
<span><span class="co">#&gt;           Analysis</span></span>
<span><span class="co">#&gt;    Theta      1 2 3  Total</span></span>
<span><span class="co">#&gt;   0.0000 0.4057 0 0 0.4057</span></span>
<span><span class="co">#&gt;   3.2415 0.0148 0 0 0.0148</span></span></code></pre></div>
<div class="section level3">
<h3 id="plotting">Plotting<a class="anchor" aria-label="anchor" href="#plotting"></a>
</h3>
<p>The standard plot shows the active bounds, with inactive bounds
omitted:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x1</span>, plottype <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<div class="figure" style="text-align: center">
<img src="SelectiveBoundTesting_files/figure-html/unnamed-chunk-6-1.svg" class="r-plt" alt="Power plot with futility only at IA1" width="80%"><p class="caption">
Power plot with futility only at IA1
</p>
</div>
</div>
</div>
<div class="section level2">
<h2 id="example-2-no-efficacy-testing-at-the-first-interim">Example 2: No efficacy testing at the first interim<a class="anchor" aria-label="anchor" href="#example-2-no-efficacy-testing-at-the-first-interim"></a>
</h2>
<p>In some settings, particularly early-phase or adaptive designs,
efficacy testing may be deferred until sufficient data have accrued.
Here we skip the efficacy bound at the first interim:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># 3-analysis design with binding futility (test.type = 3)</span></span>
<span><span class="co"># No efficacy testing at IA1</span></span>
<span><span class="va">x2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsDesign.html">gsDesign</a></span><span class="op">(</span></span>
<span>  k <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  test.type <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  sfu <span class="op">=</span> <span class="va">sfHSD</span>,</span>
<span>  sfupar <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>,</span>
<span>  sfl <span class="op">=</span> <span class="va">sfHSD</span>,</span>
<span>  sflpar <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>,</span>
<span>  testUpper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/gsBoundSummary.html">gsBoundSummary</a></span><span class="op">(</span><span class="va">x2</span><span class="op">)</span></span>
<span><span class="co">#&gt;                Analysis               Value Efficacy Futility</span></span>
<span><span class="co">#&gt;               IA 1: 33%                   Z       NA  -0.2579</span></span>
<span><span class="co">#&gt;  N/Fixed design N: 0.35         p (1-sided)       NA   0.6018</span></span>
<span><span class="co">#&gt;                             ~delta at bound       NA  -0.1346</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=0       NA   0.3982</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=1       NA   0.0148</span></span>
<span><span class="co">#&gt;               IA 2: 67%                   Z   2.4976   0.9138</span></span>
<span><span class="co">#&gt;   N/Fixed design N: 0.7         p (1-sided)   0.0063   0.1804</span></span>
<span><span class="co">#&gt;                             ~delta at bound   0.9215   0.3371</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=0   0.0062   0.8279</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=1   0.5841   0.0437</span></span>
<span><span class="co">#&gt;                   Final                   Z   1.9593   1.9593</span></span>
<span><span class="co">#&gt;  N/Fixed design N: 1.05         p (1-sided)   0.0250   0.0250</span></span>
<span><span class="co">#&gt;                             ~delta at bound   0.5902   0.5902</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=0   0.0250   0.9750</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=1   0.9006   0.0994</span></span></code></pre></div>
<p>At IA1, only the futility bound is active. The efficacy bound appears
as <code>NA</code> for that analysis.</p>
</div>
<div class="section level2">
<h2 id="example-3-survival-design-with-selective-bounds-via-gssurv">Example 3: Survival design with selective bounds via gsSurv<a class="anchor" aria-label="anchor" href="#example-3-survival-design-with-selective-bounds-via-gssurv"></a>
</h2>
<p>The <code>testUpper</code>, <code>testLower</code>, and
<code>testHarm</code> parameters pass through to <code><a href="../reference/nSurv.html">gsSurv()</a></code>
and <code><a href="../reference/gsSurvCalendar.html">gsSurvCalendar()</a></code>:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Survival design with futility only at IA1</span></span>
<span><span class="va">xs</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nSurv.html">gsSurv</a></span><span class="op">(</span></span>
<span>  k <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  test.type <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  hr <span class="op">=</span> <span class="fl">0.7</span>,</span>
<span>  timing <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.75</span><span class="op">)</span>,</span>
<span>  sfu <span class="op">=</span> <span class="va">sfHSD</span>,</span>
<span>  sfupar <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>,</span>
<span>  sfl <span class="op">=</span> <span class="va">sfHSD</span>,</span>
<span>  sflpar <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>,</span>
<span>  lambdaC <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">/</span> <span class="fl">12</span>,</span>
<span>  eta <span class="op">=</span> <span class="fl">0.01</span>,</span>
<span>  gamma <span class="op">=</span> <span class="fl">10</span>,</span>
<span>  R <span class="op">=</span> <span class="fl">12</span>,</span>
<span>  T <span class="op">=</span> <span class="fl">36</span>,</span>
<span>  minfup <span class="op">=</span> <span class="fl">24</span>,</span>
<span>  testLower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gsBoundSummary.html">gsBoundSummary</a></span><span class="op">(</span><span class="va">xs</span><span class="op">)</span></span>
<span><span class="co">#&gt; Method: LachinFoulkes </span></span>
<span><span class="co">#&gt;     Analysis              Value Efficacy Futility</span></span>
<span><span class="co">#&gt;    IA 1: 50%                  Z   2.7500   0.4555</span></span>
<span><span class="co">#&gt;       N: 524        p (1-sided)   0.0030   0.3244</span></span>
<span><span class="co">#&gt;  Events: 179       ~HR at bound   0.6623   0.9340</span></span>
<span><span class="co">#&gt;    Month: 15   P(Cross) if HR=1   0.0030   0.6756</span></span>
<span><span class="co">#&gt;              P(Cross) if HR=0.7   0.3572   0.0269</span></span>
<span><span class="co">#&gt;    IA 2: 75%                  Z   2.4318       NA</span></span>
<span><span class="co">#&gt;       N: 524        p (1-sided)   0.0075       NA</span></span>
<span><span class="co">#&gt;  Events: 268       ~HR at bound   0.7427       NA</span></span>
<span><span class="co">#&gt;    Month: 23   P(Cross) if HR=1   0.0089       NA</span></span>
<span><span class="co">#&gt;              P(Cross) if HR=0.7   0.6959       NA</span></span>
<span><span class="co">#&gt;        Final                  Z   2.0116       NA</span></span>
<span><span class="co">#&gt;       N: 524        p (1-sided)   0.0221       NA</span></span>
<span><span class="co">#&gt;  Events: 357       ~HR at bound   0.8081       NA</span></span>
<span><span class="co">#&gt;    Month: 36   P(Cross) if HR=1   0.0239       NA</span></span>
<span><span class="co">#&gt;              P(Cross) if HR=0.7   0.9067       NA</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="example-4-selective-harm-monitoring-test-type-78">Example 4: Selective harm monitoring (test.type 7/8)<a class="anchor" aria-label="anchor" href="#example-4-selective-harm-monitoring-test-type-78"></a>
</h2>
<p>For designs with a separate harm bound, the <code>testHarm</code>
parameter controls which analyses include harm monitoring. This can be
useful when harm monitoring is most critical during early enrollment,
before longer-term safety data are available.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Harm bound design with harm monitoring only at IA1 and IA2</span></span>
<span><span class="va">xh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsDesign.html">gsDesign</a></span><span class="op">(</span></span>
<span>  k <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  test.type <span class="op">=</span> <span class="fl">8</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  astar <span class="op">=</span> <span class="fl">0.05</span>,</span>
<span>  sfu <span class="op">=</span> <span class="va">sfHSD</span>,</span>
<span>  sfupar <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>,</span>
<span>  sfl <span class="op">=</span> <span class="va">sfHSD</span>,</span>
<span>  sflpar <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>,</span>
<span>  sfharm <span class="op">=</span> <span class="va">sfHSD</span>,</span>
<span>  sfharmparam <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  testHarm <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gsBoundSummary.html">gsBoundSummary</a></span><span class="op">(</span><span class="va">xh</span><span class="op">)</span></span>
<span><span class="co">#&gt;                Analysis               Value    Harm Futility</span></span>
<span><span class="co">#&gt;               IA 1: 33%                   Z -2.0061  -0.2387</span></span>
<span><span class="co">#&gt;  N/Fixed design N: 0.36         p (1-sided)  0.9776   0.5943</span></span>
<span><span class="co">#&gt;                             ~delta at bound -1.0363  -0.1233</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=0  0.0224   0.4057</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=1  0.0000   0.0148</span></span>
<span><span class="co">#&gt;               IA 2: 67%                   Z -1.9827   0.9411</span></span>
<span><span class="co">#&gt;  N/Fixed design N: 0.71         p (1-sided)  0.9763   0.1733</span></span>
<span><span class="co">#&gt;                             ~delta at bound -0.7242   0.3438</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=0  0.0385   0.8347</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=1  0.0000   0.0437</span></span>
<span><span class="co">#&gt;                   Final                   Z      NA   1.9992</span></span>
<span><span class="co">#&gt;  N/Fixed design N: 1.07         p (1-sided)      NA   0.0228</span></span>
<span><span class="co">#&gt;                             ~delta at bound      NA   0.5963</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=0      NA   0.9767</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=1      NA   0.1000</span></span>
<span><span class="co">#&gt;  Efficacy</span></span>
<span><span class="co">#&gt;    3.0107</span></span>
<span><span class="co">#&gt;    0.0013</span></span>
<span><span class="co">#&gt;    1.5553</span></span>
<span><span class="co">#&gt;    0.0013</span></span>
<span><span class="co">#&gt;    0.1412</span></span>
<span><span class="co">#&gt;    2.5465</span></span>
<span><span class="co">#&gt;    0.0054</span></span>
<span><span class="co">#&gt;    0.9302</span></span>
<span><span class="co">#&gt;    0.0062</span></span>
<span><span class="co">#&gt;    0.5815</span></span>
<span><span class="co">#&gt;    1.9992</span></span>
<span><span class="co">#&gt;    0.0228</span></span>
<span><span class="co">#&gt;    0.5963</span></span>
<span><span class="co">#&gt;    0.0233</span></span>
<span><span class="co">#&gt;    0.9000</span></span></code></pre></div>
<p>The harm bound is <code>NA</code> at the final analysis.</p>
</div>
<div class="section level2">
<h2 id="example-5-combining-selective-efficacy-and-futility">Example 5: Combining selective efficacy and futility<a class="anchor" aria-label="anchor" href="#example-5-combining-selective-efficacy-and-futility"></a>
</h2>
<p>Both <code>testUpper</code> and <code>testLower</code> can be
specified simultaneously. For example, a design with futility-only at
IA1 and efficacy-only at IA2:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Futility only at IA1, efficacy only at IA2, both at Final</span></span>
<span><span class="va">x5</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsDesign.html">gsDesign</a></span><span class="op">(</span></span>
<span>  k <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  test.type <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  alpha <span class="op">=</span> <span class="fl">0.025</span>,</span>
<span>  beta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  sfu <span class="op">=</span> <span class="va">sfHSD</span>,</span>
<span>  sfupar <span class="op">=</span> <span class="op">-</span><span class="fl">4</span>,</span>
<span>  sfl <span class="op">=</span> <span class="va">sfHSD</span>,</span>
<span>  sflpar <span class="op">=</span> <span class="op">-</span><span class="fl">2</span>,</span>
<span>  testUpper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  testLower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="../reference/gsBoundSummary.html">gsBoundSummary</a></span><span class="op">(</span><span class="va">x5</span><span class="op">)</span></span>
<span><span class="co">#&gt;                Analysis               Value Efficacy Futility</span></span>
<span><span class="co">#&gt;               IA 1: 33%                   Z       NA  -0.2387</span></span>
<span><span class="co">#&gt;  N/Fixed design N: 0.36         p (1-sided)       NA   0.5943</span></span>
<span><span class="co">#&gt;                             ~delta at bound       NA  -0.1233</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=0       NA   0.4057</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=1       NA   0.0148</span></span>
<span><span class="co">#&gt;               IA 2: 67%                   Z   2.4979       NA</span></span>
<span><span class="co">#&gt;  N/Fixed design N: 0.71         p (1-sided)   0.0062       NA</span></span>
<span><span class="co">#&gt;                             ~delta at bound   0.9124       NA</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=0   0.0062       NA</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=1   0.5945       NA</span></span>
<span><span class="co">#&gt;                   Final                   Z   1.9947       NA</span></span>
<span><span class="co">#&gt;  N/Fixed design N: 1.07         p (1-sided)   0.0230       NA</span></span>
<span><span class="co">#&gt;                             ~delta at bound   0.5949       NA</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=0   0.0244       NA</span></span>
<span><span class="co">#&gt;                         P(Cross) if delta=1   0.9083       NA</span></span></code></pre></div>
<p>Note the <code>NA</code> values: efficacy is <code>NA</code> at IA1,
and futility is <code>NA</code> at IA2 and the final analysis.</p>
</div>
<div class="section level2">
<h2 id="validation-rules">Validation rules<a class="anchor" aria-label="anchor" href="#validation-rules"></a>
</h2>
<p>The following rules are enforced:</p>
<ol style="list-style-type: decimal">
<li>
<strong><code>testUpper</code> must be <code>TRUE</code> at the
final analysis</strong> (the trial must always be able to reject <span class="math inline">\(H_0\)</span>).</li>
<li>
<strong>At least one bound must be active at every
analysis</strong>. For example, setting
<code>testUpper = c(FALSE, TRUE, TRUE)</code> and
<code>testLower = c(FALSE, TRUE, TRUE)</code> would fail because no
bound is active at IA1.</li>
<li>
<strong><code>test.type = 1</code></strong>: Only one-sided efficacy
testing. <code>testLower</code> is ignored (set to <code>FALSE</code>
internally).</li>
<li>
<strong><code>test.type = 2</code></strong>: Symmetric two-sided
testing. Both <code>testUpper</code> and <code>testLower</code> are
overridden to all <code>TRUE</code>.</li>
<li>
<strong><code>test.type</code> 3–8</strong>: <code>testLower</code>
must be <code>TRUE</code> for at least one analysis.</li>
<li>
<strong><code>test.type</code> 7 and 8</strong>:
<code>testHarm</code> must be <code>TRUE</code> for at least one
analysis.</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This fails: testUpper must be TRUE at the final analysis</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/gsDesign.html">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">3</span>, testUpper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">TRUE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in gsTestBoundsCheck(x$k, x$test.type, testUpper, testLower, testHarm) : </span></span>
<span><span class="co">#&gt;   testUpper must be TRUE at the final analysis</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># This fails: no bound active at analysis 1</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/try.html" class="external-link">try</a></span><span class="op">(</span><span class="fu"><a href="../reference/gsDesign.html">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">4</span>,</span>
<span>  testUpper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>  testLower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="op">)</span><span class="op">)</span></span>
<span><span class="co">#&gt; Error in gsTestBoundsCheck(x$k, x$test.type, testUpper, testLower, testHarm) : </span></span>
<span><span class="co">#&gt;   At analysis 1 at least one of testUpper, testLower, or testHarm must be TRUE</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="accessing-stored-flags">Accessing stored flags<a class="anchor" aria-label="anchor" href="#accessing-stored-flags"></a>
</h2>
<p>The <code>testUpper</code>, <code>testLower</code>, and
<code>testHarm</code> logical vectors are stored on the returned
<code>gsDesign</code> object:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x1</span><span class="op">$</span><span class="va">testUpper</span></span>
<span><span class="co">#&gt; [1] TRUE TRUE TRUE</span></span>
<span><span class="va">x1</span><span class="op">$</span><span class="va">testLower</span></span>
<span><span class="co">#&gt; [1]  TRUE FALSE FALSE</span></span>
<span><span class="va">x1</span><span class="op">$</span><span class="va">testHarm</span></span>
<span><span class="co">#&gt; [1] FALSE FALSE FALSE</span></span></code></pre></div>
<p>These can be inspected programmatically for downstream analyses or
reporting.</p>
</div>
<div class="section level2">
<h2 id="type-i-error-preservation">Type I Error Preservation<a class="anchor" aria-label="anchor" href="#type-i-error-preservation"></a>
</h2>
<p>A key property of the selective bounds implementation is that
<strong>Type I error is preserved at the nominal level</strong>
regardless of which analyses are skipped.</p>
<div class="section level3">
<h3 id="how-it-works">How it works<a class="anchor" aria-label="anchor" href="#how-it-works"></a>
</h3>
<p>When bounds are selectively deactivated, the cumulative spending at
each <em>performed</em> analysis remains at the spending function’s
planned value. At inactive analyses, the cumulative spending is frozen
(no incremental spend), causing the C code to produce <span class="math inline">\(\pm\)</span>EXTREMEZ bounds. At the next active
analysis, the incremental spend absorbs the budget from any prior
skipped analyses, so the cumulative spend catches up to the planned
level. The efficacy bounds at active analyses are then recomputed using
the modified spending with the sample size held fixed, ensuring the
total alpha spent equals the nominal level.</p>
</div>
<div class="section level3">
<h3 id="non-binding-futility-test-type-4-or-6">Non-binding futility (test.type 4 or 6)<a class="anchor" aria-label="anchor" href="#non-binding-futility-test-type-4-or-6"></a>
</h3>
<p>For non-binding designs, the efficacy bounds are computed under the
assumption that the trial <em>may continue past the futility bound</em>
(i.e., futility does not contribute to the upper alpha calculation).
Since upper bounds are independent of lower bounds, removing futility
has no effect on the upper (efficacy) bounds or the non-binding
alpha:</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Baseline non-binding design</span></span>
<span><span class="va">x_nb</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsDesign.html">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.025</span>, beta <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Remove futility at IA2 and final</span></span>
<span><span class="va">x_nb_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsDesign.html">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.025</span>, beta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  testLower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Non-binding alpha (computed ignoring lower bounds)</span></span>
<span><span class="va">nb_alpha_base</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">gsDesign</span><span class="fu">:::</span><span class="fu">gsprob</span><span class="op">(</span><span class="fl">0</span>, <span class="va">x_nb</span><span class="op">$</span><span class="va">n.I</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="fl">3</span><span class="op">)</span>, <span class="va">x_nb</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>, r <span class="op">=</span> <span class="va">x_nb</span><span class="op">$</span><span class="va">r</span><span class="op">)</span><span class="op">$</span><span class="va">probhi</span><span class="op">)</span></span>
<span><span class="va">nb_alpha_sel</span>  <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">gsDesign</span><span class="fu">:::</span><span class="fu">gsprob</span><span class="op">(</span><span class="fl">0</span>, <span class="va">x_nb_sel</span><span class="op">$</span><span class="va">n.I</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="fl">3</span><span class="op">)</span>, <span class="va">x_nb_sel</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>, r <span class="op">=</span> <span class="va">x_nb_sel</span><span class="op">$</span><span class="va">r</span><span class="op">)</span><span class="op">$</span><span class="va">probhi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Baseline non-binding alpha: "</span>, <span class="va">nb_alpha_base</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Baseline non-binding alpha:  0.025</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Selective non-binding alpha:"</span>, <span class="va">nb_alpha_sel</span> , <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Selective non-binding alpha: 0.025</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Upper bounds identical:     "</span>, <span class="fu"><a href="https://rdrr.io/r/base/all.equal.html" class="external-link">all.equal</a></span><span class="op">(</span><span class="va">x_nb</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>, <span class="va">x_nb_sel</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Upper bounds identical:      TRUE</span></span></code></pre></div>
<p>When removing early efficacy bounds, the upper bounds at active
analyses adjust to absorb the redistributed spending, still totalling
exactly <span class="math inline">\(\alpha = 0.025\)</span>:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Remove efficacy at IA1</span></span>
<span><span class="va">x_nb_eff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsDesign.html">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">4</span>, alpha <span class="op">=</span> <span class="fl">0.025</span>, beta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  testUpper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">nb_alpha_eff</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="fu">gsDesign</span><span class="fu">:::</span><span class="fu">gsprob</span><span class="op">(</span><span class="fl">0</span>, <span class="va">x_nb_eff</span><span class="op">$</span><span class="va">n.I</span>, <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="op">-</span><span class="fl">20</span>, <span class="fl">3</span><span class="op">)</span>, <span class="va">x_nb_eff</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">bound</span>, r <span class="op">=</span> <span class="va">x_nb_eff</span><span class="op">$</span><span class="va">r</span><span class="op">)</span><span class="op">$</span><span class="va">probhi</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Non-binding alpha (skip IA1 efficacy):"</span>, <span class="va">nb_alpha_eff</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Non-binding alpha (skip IA1 efficacy): 0.025</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="binding-futility-test-type-3-or-5">Binding futility (test.type 3 or 5)<a class="anchor" aria-label="anchor" href="#binding-futility-test-type-3-or-5"></a>
</h3>
<p>For binding designs, the efficacy bounds depend on the futility
bounds. When futility bounds are selectively removed, the bounds are
recomputed with the modified spending while holding sample size fixed.
This ensures the cumulative Type I error remains at the nominal
level:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Baseline binding design</span></span>
<span><span class="va">x_b</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsDesign.html">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.025</span>, beta <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Baseline alpha:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x_b</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">prob</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Baseline alpha: 0.02500087</span></span>
<span></span>
<span><span class="co"># Remove futility at IA2 and final</span></span>
<span><span class="va">x_b_sel</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsDesign.html">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.025</span>, beta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  testLower <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="cn">FALSE</span>, <span class="cn">FALSE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Selective alpha:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x_b_sel</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">prob</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Selective alpha: 0.025</span></span>
<span></span>
<span><span class="co"># Remove efficacy at IA1</span></span>
<span><span class="va">x_b_eff</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsDesign.html">gsDesign</a></span><span class="op">(</span>k <span class="op">=</span> <span class="fl">3</span>, test.type <span class="op">=</span> <span class="fl">3</span>, alpha <span class="op">=</span> <span class="fl">0.025</span>, beta <span class="op">=</span> <span class="fl">0.1</span>,</span>
<span>  testUpper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html" class="external-link">cat</a></span><span class="op">(</span><span class="st">"Skip IA1 efficacy alpha:"</span>, <span class="fu"><a href="https://rdrr.io/r/base/sum.html" class="external-link">sum</a></span><span class="op">(</span><span class="va">x_b_eff</span><span class="op">$</span><span class="va">upper</span><span class="op">$</span><span class="va">prob</span><span class="op">[</span>, <span class="fl">1</span><span class="op">]</span><span class="op">)</span>, <span class="st">"\n"</span><span class="op">)</span></span>
<span><span class="co">#&gt; Skip IA1 efficacy alpha: 0.025</span></span></code></pre></div>
<p>In all cases, the actual Type I error is exactly <span class="math inline">\(\alpha = 0.025\)</span> (within numerical
tolerance). The sample size remains unchanged from the baseline design,
and the bounds at active analyses adjust to properly allocate the
spending budget.</p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Keaven Anderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
