<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>A gentle introduction to group sequential design • gsDesign</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.4.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.4.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A gentle introduction to group sequential design">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">gsDesign</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.6.3</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/keaven/gsDesign/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>A gentle introduction to group sequential design</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/keaven/gsDesign/blob/v3.6.3/vignettes/GentleIntroductionToGSD.Rmd" class="external-link"><code>vignettes/GentleIntroductionToGSD.Rmd</code></a></small>
      <div class="d-none name"><code>GentleIntroductionToGSD.Rmd</code></div>
    </div>

    
    
<div class="section level3">
<h3 id="introduction">Introduction<a class="anchor" aria-label="anchor" href="#introduction"></a>
</h3>
<p>This article is intended to give a gentle mathematical and
statistical introduction to group sequential design. We also provide
relatively simple examples from the literature to explain clinical
applications. There is no programming shown, but by accessing the source
for the article all required programming can be accessed; substantial
commenting is provided in the source in the hope that users can
understand how to implement the concepts developed here. Hopefully, the
few mathematical and statistical concepts introduced will not discourage
those wishing to understand some underlying concepts for group
sequential design.</p>
<p>A group sequential design enables repeated analysis of an endpoint
for a clinical trial to enable possible early stopping of a trial for
either a positive result, for futility, or for a safety issue. This
approach can</p>
<ul>
<li>limit exposure risk to patients and clinical trial investment past
the time where known unacceptable safety risks have been established for
the endpoint of interest,</li>
<li>limit investment in a trial where interim results suggest further
evaluation for a positive efficacy finding is futile, or</li>
<li>accelerate the availability of a highly effective treatment by
enabling early approval following an early positive finding.</li>
</ul>
<p>Examples of outcomes that might be considered include:</p>
<ul>
<li>a continuous outcome such as change from baseline at some fixed
follow-up time in the HAM-D depression score,</li>
<li>absolute or difference or risk ratio for a response rate (e.g., in
oncology) or failure rate for a binary (yes/no) outcome, and</li>
<li>a hazard ratio for a time-to-event out such such as time-to-death or
disease progression in an oncology trial or for time until a
cardiovascular event (death, myocardial infarction or unstable
angina).</li>
</ul>
<p>Examples of the above include:</p>
<ul>
<li>a new treatment for major depression where an interim analysis of a
continuous outcome stopped the trial for futility (<span class="citation">Binneman et al. (2008)</span>),</li>
<li>a new treatment for patients with unstable angina undergoing balloon
angioplasty with a positive interim finding for a binary outcome of
death, myocardial infarction or urgent repeat intervention within 30
days (<span class="citation">The CAPTURE Investigators (1997)</span>),
and</li>
<li>a new treatment for patients with lung cancer based on a positive
interim finding for time-to-death (<span class="citation">Gandhi et al.
(2018)</span>).</li>
</ul>
</div>
<div class="section level3">
<h3 id="group-sequential-design-framework">Group sequential design framework<a class="anchor" aria-label="anchor" href="#group-sequential-design-framework"></a>
</h3>
<p>We assume</p>
<ul>
<li>A two-arm clinical trial with a control and experimental group.</li>
<li>There are
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>k</mi><annotation encoding="application/x-tex">k</annotation></semantics></math>
analyses planned for some integer
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>k</mi><mo>&gt;</mo><mn>1</mn><mi>.</mi></mrow><annotation encoding="application/x-tex">k&gt; 1.</annotation></semantics></math>
</li>
<li>There is a natural parameter
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
describing the underlying treatment difference with an estimate that has
an asymptotically normal and efficient estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mover><mi>δ</mi><mo accent="true">̂</mo></mover><mi>j</mi></msub><annotation encoding="application/x-tex">\hat\delta_j</annotation></semantics></math>
with variance
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mi>σ</mi><mi>j</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\sigma_j^2</annotation></semantics></math>
and corresponding statistical information
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>ℐ</mi><mi>j</mi></msub><mo>=</mo><mn>1</mn><mi>/</mi><msubsup><mi>σ</mi><mi>j</mi><mn>2</mn></msubsup></mrow><annotation encoding="application/x-tex">\mathcal{I}_j=1/\sigma_j^2</annotation></semantics></math>,
at analysis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">j=1,2,\ldots,k</annotation></semantics></math>.
A positive value favoring experimental treatment and negative value
favoring control. We assume a consistent estimate
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msubsup><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>j</mi><mn>2</mn></msubsup><annotation encoding="application/x-tex">\hat\sigma_j^2</annotation></semantics></math>
of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>σ</mi><mi>j</mi><mn>2</mn></msubsup><mo>,</mo><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">\sigma_j^2, j=1,2,\ldots,k</annotation></semantics></math>.</li>
<li>The information fraction is defined as
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mi>j</mi></msub><mo>=</mo><msub><mi>ℐ</mi><mi>i</mi></msub><mi>/</mi><msub><mi>ℐ</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">t_j=\mathcal{I}_i/\mathcal{I}_j</annotation></semantics></math>
at analysis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">j=1,\ldots,k</annotation></semantics></math>.</li>
<li>Correlations between estimates at different analyses are <span class="math inline">$\hbox{Corr}(\hat\delta_i,\hat\delta_j)=\sqrt{\mathcal{I}_i/\mathcal{I}_j}=\sqrt{t_j}$</span>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>j</mi><mo>≤</mo><mi>k</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">1\le i\le j\le k.</annotation></semantics></math>
</li>
<li>There is a test test
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>j</mi></msub><mo>≈</mo><msub><mover><mi>δ</mi><mo accent="true">̂</mo></mover><mi>j</mi></msub><mi>/</mi><msubsup><mover><mi>σ</mi><mo accent="true">̂</mo></mover><mi>j</mi><mn>2</mn></msubsup><mi>.</mi></mrow><annotation encoding="application/x-tex">Z_j\approx\hat\delta_j/\hat{\sigma}^2_j.</annotation></semantics></math>
</li>
</ul>
<p>For a time-to-event outcome,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
would typically represent the logarithm of the hazard ratio for the
control group versus the experimental group. For a difference in
response rates,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
would represent the underlying response rates. For a continuous outcome
such as the HAM-D, we would examine the difference in change from
baseline at a milestone time point (e.g., at 6 weeks as in <span class="citation">Binneman et al. (2008)</span>). For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">j=1,\ldots,k</annotation></semantics></math>,
the tests
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>Z</mi><mi>j</mi></msub><annotation encoding="application/x-tex">Z_j</annotation></semantics></math>
are asymptotically multivariate normal with correlations as above, and
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">i=1,\ldots,k</annotation></semantics></math>
have <span class="math inline">$\hbox{Cov}(Z_i,Z_j)=\hbox{Corr}(\hat\delta_i,\hat\delta_j)$</span>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>E</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>Z</mi><mi>j</mi></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>δ</mi><msqrt><msub><mi>I</mi><mi>j</mi></msub></msqrt><mi>.</mi></mrow><annotation encoding="application/x-tex">E(Z_j)=\delta\sqrt{I_j}.</annotation></semantics></math></p>
<p>This multivariate asymptotic normal distribution for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mn>1</mn></msub><mo>,</mo><mi>…</mi><mo>,</mo><msub><mi>Z</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">Z_1,\ldots,Z_k</annotation></semantics></math>
is referred to as the <em>canonical form</em> by <span class="citation">Jennison and Turnbull (2000)</span> who have also
summarized much of the surrounding literature.</p>
</div>
<div class="section level3">
<h3 id="bounds-for-testing">Bounds for testing<a class="anchor" aria-label="anchor" href="#bounds-for-testing"></a>
</h3>
<div class="section level4">
<h4 id="one-sided-testing">One-sided testing<a class="anchor" aria-label="anchor" href="#one-sided-testing"></a>
</h4>
<p>We assume that the primary test the null hypothesis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_{0}</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\delta=0</annotation></semantics></math>
against the alternative
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_{1}</annotation></semantics></math>:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>=</mo><msub><mi>δ</mi><mn>1</mn></msub></mrow><annotation encoding="application/x-tex">\delta = \delta_1</annotation></semantics></math>
for a fixed effect size
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>δ</mi><mn>1</mn></msub><mo>&gt;</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\delta_1 &gt; 0</annotation></semantics></math>
which represents a benefit of experimental treatment compared to
control. We assume further that there is interest in stopping early if
there is good evidence to reject one hypothesis in favor of the other.
For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>k</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">i=1,2,\ldots,k-1</annotation></semantics></math>,
interim cutoffs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mi>i</mi></msub><mo>&lt;</mo><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">l_{i}&lt; u_{i}</annotation></semantics></math>
are set; final cutoffs
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mi>k</mi></msub><mo>≤</mo><msub><mi>u</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">l_{k}\leq u_{k}</annotation></semantics></math>
are also set. For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">i=1,2,\ldots,k</annotation></semantics></math>,
the trial is stopped at analysis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
to reject
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_{0}</annotation></semantics></math>
if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mi>j</mi></msub><mo>&lt;</mo><msub><mi>Z</mi><mi>j</mi></msub><mo>&lt;</mo><msub><mi>u</mi><mi>j</mi></msub></mrow><annotation encoding="application/x-tex">l_{j}&lt;Z_{j}&lt; u_{j}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>i</mi><mo>−</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">j=1,2,\dots,i-1</annotation></semantics></math>
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>i</mi></msub><mo>≥</mo><msub><mi>u</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">Z_{i}\geq u_{i}</annotation></semantics></math>.
If the trial continues until stage
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_{0}</annotation></semantics></math>
is not rejected at stage
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>Z</mi><mi>i</mi></msub><mo>≤</mo><msub><mi>l</mi><mi>i</mi></msub></mrow><annotation encoding="application/x-tex">Z_{i}\leq l_{i}</annotation></semantics></math>
then
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_{1}</annotation></semantics></math>
is rejected in favor of
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_{0}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">i=1,2,\ldots,k</annotation></semantics></math>.
Thus,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>3</mn><mi>k</mi></mrow><annotation encoding="application/x-tex">3k</annotation></semantics></math>
parameters define a group sequential design:
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>l</mi><mi>i</mi></msub><annotation encoding="application/x-tex">l_{i}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>u</mi><mi>i</mi></msub><annotation encoding="application/x-tex">u_{i}</annotation></semantics></math>,
and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>ℐ</mi><mi>i</mi></msub><annotation encoding="application/x-tex">\mathcal{I}_{i}</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">i=1,2,\ldots,k</annotation></semantics></math>.
Note that if
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mi>k</mi></msub><mo>&lt;</mo><msub><mi>u</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">l_{k}&lt; u_{k}</annotation></semantics></math>
there is the possibility of completing the trial without rejecting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>0</mn></msub><annotation encoding="application/x-tex">H_{0}</annotation></semantics></math>
or
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mi>H</mi><mn>1</mn></msub><annotation encoding="application/x-tex">H_{1}</annotation></semantics></math>.
We will often restrict
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mi>k</mi></msub><mo>=</mo><msub><mi>u</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">l_{k}= u_{k}</annotation></semantics></math>
so that one hypothesis is rejected.</p>
<p>We begin with a one-sided test. In this case there is no interest in
stopping early for a lower bound and thus
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mi>i</mi></msub><mo>=</mo><mo>−</mo><mi>∞</mi></mrow><annotation encoding="application/x-tex">l_i= -\infty</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">i=1,2,\ldots,k</annotation></semantics></math>.
The probability of first crossing an upper bound at analysis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">i=1,2,\ldots,k</annotation></semantics></math>,
is</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>α</mi><mi>i</mi><mo>+</mo></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>δ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>P</mi><mi>δ</mi></msub><mo stretchy="false" form="prefix">{</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>Z</mi><mi>i</mi></msub><mo>≥</mo><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo><msubsup><mo>∩</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false" form="prefix">{</mo><msub><mi>Z</mi><mi>j</mi></msub><mo>&lt;</mo><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">}</mo><mo stretchy="false" form="postfix">}</mo></mrow><annotation encoding="application/x-tex">\alpha_{i}^{+}(\delta)=P_{\delta}\{\{Z_{i}\geq u_{i}\}\cap_{j=1}^{i-1}
\{Z_{j}&lt; u_{j}\}\}</annotation></semantics></math></p>
<p>The Type I error is the probability of ever crossing the upper bound
when
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>δ</mi><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\delta=0</annotation></semantics></math>.
The value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>α</mi><mi>i</mi><mo>+</mo></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha^+_{i}(0)</annotation></semantics></math>
is commonly referred to as the amount of Type I error spent at analysis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>1</mn><mo>≤</mo><mi>i</mi><mo>≤</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">1\leq i\leq k</annotation></semantics></math>.
The total upper boundary crossing probability for a trial is denoted in
this one-sided scenario by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>α</mi><mo>+</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>δ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≡</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msubsup><mi>α</mi><mi>i</mi><mo>+</mo></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mi>δ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha^+(\delta) \equiv \sum_{i=1}^{k}\alpha^+_{i}(\delta)</annotation></semantics></math></p>
<p>and the total Type I error by
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>α</mi><mo>+</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha^+(0)</annotation></semantics></math>.
Assuming
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>α</mi><mo>+</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">\alpha^+(0)=\alpha</annotation></semantics></math>
the design will be said to provide a one-sided group sequential test at
level
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>.</p>
</div>
<div class="section level4">
<h4 id="binding">Asymmetric two-sided testing<a class="anchor" aria-label="anchor" href="#binding"></a>
</h4>
<p>With both lower and upper bounds for testing and any real value
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>δ</mi><annotation encoding="application/x-tex">\delta</annotation></semantics></math>
representing treatment effect we denote the probability of crossing the
upper boundary at analysis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
without previously crossing a bound by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>δ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>P</mi><mi>δ</mi></msub><mo stretchy="false" form="prefix">{</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>Z</mi><mi>i</mi></msub><mo>≥</mo><msub><mi>u</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo><msubsup><mo>∩</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false" form="prefix">{</mo><msub><mi>l</mi><mi>j</mi></msub><mo>&lt;</mo><msub><mi>Z</mi><mi>j</mi></msub><mo>&lt;</mo><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">}</mo><mo stretchy="false" form="postfix">}</mo><mo>,</mo></mrow><annotation encoding="application/x-tex">\alpha_{i}(\delta)=P_{\delta}\{\{Z_{i}\geq u_{i}\}\cap_{j=1}^{i-1}
\{ l_{j}&lt;Z_{j}&lt; u_{j}\}\},</annotation></semantics></math></p>
<p><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>k</mi><mi>.</mi></mrow><annotation encoding="application/x-tex">i=1,2,\ldots,k.</annotation></semantics></math>
The total probability of crossing an upper bound prior to crossing a
lower bound is denoted by</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>δ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>≡</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msub><mi>α</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>δ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\alpha(\delta)\equiv\sum_{i=1}^{k}\alpha_{i}(\delta).</annotation></semantics></math></p>
<p>Next, we consider analogous notation for the lower bound. For
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mn>2</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">i=1,2,\ldots,k</annotation></semantics></math>
denote the probability of crossing a lower bound at analysis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>i</mi><annotation encoding="application/x-tex">i</annotation></semantics></math>
without previously crossing any bound by
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>δ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><msub><mi>P</mi><mi>δ</mi></msub><mo stretchy="false" form="prefix">{</mo><mo stretchy="false" form="prefix">{</mo><msub><mi>Z</mi><mi>i</mi></msub><mo>≤</mo><msub><mi>l</mi><mi>i</mi></msub><mo stretchy="false" form="postfix">}</mo><msubsup><mo>∩</mo><mrow><mi>j</mi><mo>=</mo><mn>1</mn></mrow><mrow><mi>i</mi><mo>−</mo><mn>1</mn></mrow></msubsup><mo stretchy="false" form="prefix">{</mo><msub><mi>l</mi><mi>j</mi></msub><mo>&lt;</mo><msub><mi>Z</mi><mi>j</mi></msub><mo>&lt;</mo><msub><mi>u</mi><mi>j</mi></msub><mo stretchy="false" form="postfix">}</mo><mo stretchy="false" form="postfix">}</mo><mi>.</mi></mrow><annotation encoding="application/x-tex">\beta_{i}(\delta)=P_{\delta}\{\{Z_{i}\leq l_{i}\}\cap_{j=1}^{i-1}\{ l_{j}
&lt;Z_{j}&lt; u_{j}\}\}.</annotation></semantics></math> The total lower
boundary crossing probability in this case is written as
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>δ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><munderover><mo>∑</mo><mrow><mi>i</mi><mo>=</mo><mn>1</mn></mrow><mi>k</mi></munderover><msub><mi>β</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>δ</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\beta(\delta)=
{\sum\limits_{i=1}^{k}}
\beta_{i}(\delta).</annotation></semantics></math></p>
<p>When a design has final bounds equal
(<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>l</mi><mi>k</mi></msub><mo>=</mo><msub><mi>u</mi><mi>k</mi></msub></mrow><annotation encoding="application/x-tex">l_k=u_k</annotation></semantics></math>),
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>β</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>δ</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta(\delta_1)</annotation></semantics></math>
is the Type II error which is equal to 1 minus the power of the design.
In this case,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mi>i</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mi>δ</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\beta_i(\delta)</annotation></semantics></math>
is referred to as the
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>-spending
at analysis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>i</mi><mo>,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">i, i=1,\ldots,k</annotation></semantics></math>.</p>
</div>
</div>
<div class="section level3">
<h3 id="spending-function-design">Spending function design<a class="anchor" aria-label="anchor" href="#spending-function-design"></a>
</h3>
<p>Type I error is most often defined with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>α</mi><mi>i</mi><mo>+</mo></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>,</mo><mi>i</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">\alpha_i^+(0), i=1,\ldots,k</annotation></semantics></math>.
This is referred to as non-binding Type I error since any lower bound is
ignored in the calculation. This means that if a trial is continued in
spite of a lower bound being crossed at an interim analysis that Type I
error is still controlled at the design
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>-level.
For Phase III trials used for approvals of new treatments, non-binding
Type I error calculation is generally expected by regulators.</p>
<p>For any given
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mn>0</mn><mo>&lt;</mo><mi>α</mi><mo>&lt;</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">0&lt;\alpha&lt;1</annotation></semantics></math>
we define a non-decreasing
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>-spending
function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">f(t; \alpha)</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>≥</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t\geq 0</annotation></semantics></math>
with
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">\alpha\left(  0\right)  =0</annotation></semantics></math>
and for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>t</mi><mo>≥</mo><mn>1</mn></mrow><annotation encoding="application/x-tex">t\geq 1</annotation></semantics></math>,
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>α</mi></mrow><annotation encoding="application/x-tex">f( t; \alpha)  =\alpha</annotation></semantics></math>.
Letting
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>0</mn></msub><mo>=</mo><mn>0</mn></mrow><annotation encoding="application/x-tex">t_0=0</annotation></semantics></math>,
we set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>α</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha_j(0)</annotation></semantics></math>
for
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">j=1,\ldots,k</annotation></semantics></math>
through the equation
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msubsup><mi>α</mi><mi>j</mi><mo>+</mo></msubsup><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>j</mi></msub><mo>;</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>;</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\alpha^+_{j}(0) = f(t_j;\alpha)-f(t_{j-1}; \alpha).</annotation></semantics></math>
Assuming an asymmetric lower bound, we similarly use a
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>-spending
function and to set
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>-spending
at analysis
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>j</mi><mo>=</mo><mn>1</mn><mo>,</mo><mi>…</mi><mo>,</mo><mi>k</mi></mrow><annotation encoding="application/x-tex">j=1,\ldots, k</annotation></semantics></math>
as:
<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>β</mi><mi>j</mi></msub><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>δ</mi><mn>1</mn></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mi>j</mi></msub><mo>;</mo><msub><mi>δ</mi><mn>1</mn></msub><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>−</mo><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>t</mi><mrow><mi>j</mi><mo>−</mo><mn>1</mn></mrow></msub><mo>;</mo><msub><mi>δ</mi><mn>1</mn></msub><mo>,</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">\beta_{j}(\delta_1) = g(t_j;\delta_1, \beta) - g(t_{j-1};\delta_1, \beta).</annotation></semantics></math></p>
<p>In the following example, the function
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\Phi()</annotation></semantics></math>
represents the cumulative distribution function for the standard normal
distribution function (i.e., mean 0, standard deviation 1). The major
depression study of <span class="citation">Binneman et al. (2008)</span>
considered above used the <span class="citation">Lan and DeMets
(1983)</span> spending function approximating an O’Brien-Fleming bound
for a single interim analysis half way through the trial with</p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>α</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msup><mi>Φ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>α</mi><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msqrt><mi>t</mi></msqrt></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">f(t; \alpha) = 2\left(  1-\Phi\left(  \frac{\Phi
^{-1}(\alpha/2)}{\sqrt{t}}\right)  \right).</annotation></semantics></math></p>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>g</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>t</mi><mo>;</mo><mi>β</mi><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>2</mn><mrow><mo stretchy="true" form="prefix">(</mo><mn>1</mn><mo>−</mo><mi>Φ</mi><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msup><mi>Φ</mi><mrow><mo>−</mo><mn>1</mn></mrow></msup><mrow><mo stretchy="true" form="prefix">(</mo><mi>β</mi><mi>/</mi><mn>2</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><msqrt><mi>t</mi></msqrt></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow><mi>.</mi></mrow><annotation encoding="application/x-tex">g(t; \beta) = 2\left(  1-\Phi\left(  \frac{\Phi
^{-1}(\beta/2)}{\sqrt{t}}\right)  \right).</annotation></semantics></math></p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://keaven.github.io/gsDesign/">gsDesign</a></span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">delta1</span> <span class="op">&lt;-</span> <span class="fl">3</span> <span class="co"># Treatment effect, alternate hypothesis</span></span>
<span><span class="va">delta0</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># Treatment effect, null hypothesis</span></span>
<span><span class="va">ratio</span> <span class="op">&lt;-</span> <span class="fl">1</span> <span class="co"># Randomization ratio (experimental / control)</span></span>
<span><span class="va">sd</span> <span class="op">&lt;-</span> <span class="fl">7.5</span> <span class="co"># Standard deviation for change in HAM-D score</span></span>
<span><span class="va">alpha</span> <span class="op">&lt;-</span> <span class="fl">0.1</span> <span class="co"># 1-sided Type I error</span></span>
<span><span class="va">beta</span> <span class="op">&lt;-</span> <span class="fl">0.17</span> <span class="co"># Targeted Type II error (1 - targeted power)</span></span>
<span><span class="va">k</span> <span class="op">&lt;-</span> <span class="fl">2</span> <span class="co"># Number of planned analyses</span></span>
<span><span class="va">test.type</span> <span class="op">&lt;-</span> <span class="fl">4</span> <span class="co"># Asymmetric bound design with non-binding futility bound</span></span>
<span><span class="va">timing</span> <span class="op">&lt;-</span> <span class="fl">.5</span> <span class="co"># information fraction at interim analyses</span></span>
<span><span class="va">sfu</span> <span class="op">&lt;-</span> <span class="va">sfLDOF</span> <span class="co"># O'Brien-Fleming spending function for alpha-spending</span></span>
<span><span class="va">sfupar</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># Parameter for upper spending function</span></span>
<span><span class="va">sfl</span> <span class="op">&lt;-</span> <span class="va">sfLDOF</span> <span class="co"># O'Brien-Fleming spending function for beta-spending</span></span>
<span><span class="va">sflpar</span> <span class="op">&lt;-</span> <span class="fl">0</span> <span class="co"># Parameter for lower spending function</span></span>
<span><span class="va">delta</span> <span class="op">&lt;-</span> <span class="fl">0</span></span>
<span><span class="va">endpoint</span> <span class="op">&lt;-</span> <span class="st">"normal"</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Derive normal fixed design sample size</span></span>
<span><span class="va">n</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/nNormal.html">nNormal</a></span><span class="op">(</span></span>
<span>  delta1 <span class="op">=</span> <span class="va">delta1</span>,</span>
<span>  delta0 <span class="op">=</span> <span class="va">delta0</span>,</span>
<span>  ratio <span class="op">=</span> <span class="va">ratio</span>,</span>
<span>  sd <span class="op">=</span> <span class="va">sd</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">beta</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Derive group sequential design based on parameters above</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsDesign.html">gsDesign</a></span><span class="op">(</span></span>
<span>  k <span class="op">=</span> <span class="va">k</span>,</span>
<span>  test.type <span class="op">=</span> <span class="va">test.type</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">alpha</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">beta</span>,</span>
<span>  timing <span class="op">=</span> <span class="va">timing</span>,</span>
<span>  sfu <span class="op">=</span> <span class="va">sfu</span>,</span>
<span>  sfupar <span class="op">=</span> <span class="va">sfupar</span>,</span>
<span>  sfl <span class="op">=</span> <span class="va">sfl</span>,</span>
<span>  sflpar <span class="op">=</span> <span class="va">sflpar</span>,</span>
<span>  delta <span class="op">=</span> <span class="va">delta</span>, <span class="co"># Not used since n.fix is provided</span></span>
<span>  delta1 <span class="op">=</span> <span class="va">delta1</span>,</span>
<span>  delta0 <span class="op">=</span> <span class="va">delta0</span>,</span>
<span>  endpoint <span class="op">=</span> <span class="st">"normal"</span>,</span>
<span>  n.fix <span class="op">=</span> <span class="va">n</span></span>
<span><span class="op">)</span></span>
<span><span class="co"># Convert sample size at each analysis to integer values</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/toInteger.html">toInteger</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span></code></pre></div>
<p>The planned design used
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.1</mn></mrow><annotation encoding="application/x-tex">\alpha=0.1</annotation></semantics></math>,
one-sided and Type II error 17% (83% power) with an interim analysis at
50% of the final planned observations. This leads to Type I
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>-spending
of 0.02 and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>-spending
of 0.052 at the planned interim. An advantage of the spending function
approach is that bounds can be adjusted when the number of observations
at analyses are different than planned. The actual observations for
experimental versus control at the analysis were 59 as opposed to the
planned 67, which resulted in interim spending fraction
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>t</mi><mn>1</mn></msub><mo>=</mo></mrow><annotation encoding="application/x-tex">t_1=</annotation></semantics></math>
0.4403. With the Lan-DeMets spending function to approximate
O’Brien-Fleming bounds this results in
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>α</mi><annotation encoding="application/x-tex">\alpha</annotation></semantics></math>-spending
of 0.0132 (<code>P(Cross) if delta=0</code> row in Efficacy column) and
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mi>β</mi><annotation encoding="application/x-tex">\beta</annotation></semantics></math>-spending
of 0.0386 (<code>P(Cross) if delta=3</code> row in Futility column). We
note that the Z-value and 1-sided p-values in the table below correspond
exactly and either can be used for evaluation of statistical
significance for a trial result. The rows labeled
<code>~delta at bound</code> are approximations that describe
approximately what treatment difference is required to cross a bound;
these should not be used for a formal evaluation of whether a bound has
been crossed. The O’Brien-Fleming spending function is generally felt to
provide conservative bounds for stopping at interim analysis. Most of
the error spending is reserved for the final analysis in this example.
The futility bound only required a small trend in the wrong direction to
stop the trial; a nominal p-value of 0.77 was observed which crossed the
futility bound, stopping the trial since this was greater than the
futility p-value bound of 0.59. Finally, we note that at the final
analysis, the cumulative probability for
<code>P(Cross) if delta=0</code> is less than the planned
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mo>=</mo><mn>0.10</mn></mrow><annotation encoding="application/x-tex">\alpha=0.10</annotation></semantics></math>.
This probability represents
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mi>α</mi><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">\alpha(0)</annotation></semantics></math>
which excludes the probability of crossing the lower bound at the
interim analysis and the final analysis. The value of the non-binding
Type I error is still
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msup><mi>α</mi><mo>+</mo></msup><mrow><mo stretchy="true" form="prefix">(</mo><mn>0</mn><mo stretchy="true" form="postfix">)</mo></mrow><mo>=</mo><mn>0.10</mn></mrow><annotation encoding="application/x-tex">\alpha^+(0) = 0.10</annotation></semantics></math>.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Updated alpha is unchanged</span></span>
<span><span class="va">alphau</span> <span class="op">&lt;-</span> <span class="fl">0.1</span></span>
<span><span class="co"># Updated sample size at each analysis</span></span>
<span><span class="va">n.I</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">59</span>, <span class="fl">134</span><span class="op">)</span></span>
<span><span class="co"># Updated number of analyses</span></span>
<span><span class="va">ku</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">n.I</span><span class="op">)</span></span>
<span><span class="co"># Information fraction is used for spending</span></span>
<span><span class="va">usTime</span> <span class="op">&lt;-</span> <span class="va">n.I</span> <span class="op">/</span> <span class="va">x</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">k</span><span class="op">]</span></span>
<span><span class="va">lsTime</span> <span class="op">&lt;-</span> <span class="va">usTime</span></span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Update design based on actual interim sample size and planned final sample size</span></span>
<span><span class="va">xu</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/gsDesign.html">gsDesign</a></span><span class="op">(</span></span>
<span>  k <span class="op">=</span> <span class="va">ku</span>,</span>
<span>  test.type <span class="op">=</span> <span class="va">test.type</span>,</span>
<span>  alpha <span class="op">=</span> <span class="va">alphau</span>,</span>
<span>  beta <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">beta</span>,</span>
<span>  sfu <span class="op">=</span> <span class="va">sfu</span>,</span>
<span>  sfupar <span class="op">=</span> <span class="va">sfupar</span>,</span>
<span>  sfl <span class="op">=</span> <span class="va">sfl</span>,</span>
<span>  sflpar <span class="op">=</span> <span class="va">sflpar</span>,</span>
<span>  n.I <span class="op">=</span> <span class="va">n.I</span>,</span>
<span>  maxn.IPlan <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">n.I</span><span class="op">[</span><span class="va">x</span><span class="op">$</span><span class="va">k</span><span class="op">]</span>,</span>
<span>  delta <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">delta</span>,</span>
<span>  delta1 <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">delta1</span>,</span>
<span>  delta0 <span class="op">=</span> <span class="va">x</span><span class="op">$</span><span class="va">delta0</span>,</span>
<span>  endpoint <span class="op">=</span> <span class="va">endpoint</span>,</span>
<span>  n.fix <span class="op">=</span> <span class="va">n</span>,</span>
<span>  usTime <span class="op">=</span> <span class="va">usTime</span>,</span>
<span>  lsTime <span class="op">=</span> <span class="va">lsTime</span></span>
<span><span class="op">)</span></span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Summarize bounds</span></span>
<span><span class="fu"><a href="../reference/gsBoundSummary.html">gsBoundSummary</a></span><span class="op">(</span><span class="va">xu</span>, Nname <span class="op">=</span> <span class="st">"N"</span>, digits <span class="op">=</span> <span class="fl">4</span>, ddigits <span class="op">=</span> <span class="fl">2</span>, tdigits <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;   Analysis               Value Efficacy Futility</span></span>
<span><span class="co">#&gt;  IA 1: 44%                   Z   2.2209  -0.2304</span></span>
<span><span class="co">#&gt;      N: 59         p (1-sided)   0.0132   0.5911</span></span>
<span><span class="co">#&gt;                ~delta at bound   4.3370  -0.4500</span></span>
<span><span class="co">#&gt;            P(Cross) if delta=0   0.0132   0.4089</span></span>
<span><span class="co">#&gt;            P(Cross) if delta=3   0.2468   0.0386</span></span>
<span><span class="co">#&gt;      Final                   Z   1.3047   1.3047</span></span>
<span><span class="co">#&gt;     N: 134         p (1-sided)   0.0960   0.0960</span></span>
<span><span class="co">#&gt;                ~delta at bound   1.6907   1.6907</span></span>
<span><span class="co">#&gt;            P(Cross) if delta=0   0.0965   0.9035</span></span>
<span><span class="co">#&gt;            P(Cross) if delta=3   0.8350   0.1650</span></span></code></pre>
</div>
<div class="section level2">
<h2 class="unnumbered" id="references">References<a class="anchor" aria-label="anchor" href="#references"></a>
</h2>
<div id="refs" class="references csl-bib-body hanging-indent" entry-spacing="0">
<div id="ref-binneman20086" class="csl-entry">
Binneman, Brendon, Douglas Feltner, Sheela Kolluri, Yuanjun Shi, Ruolun
Qiu, and Thomas Stiger. 2008. <span>“A 6-Week Randomized,
Placebo-Controlled Trial of <span>CP-316,311</span> (a Selective
<math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><msub><mrow><mi>C</mi><mi>R</mi><mi>H</mi></mrow><mn>1</mn></msub><annotation encoding="application/x-tex">{CRH}_{1}</annotation></semantics></math>
Antagonist) in the Treatment of Major Depression.”</span> <em>American
Journal of Psychiatry</em> 165 (5): 617–20.
</div>
<div id="ref-KEYNOTE189" class="csl-entry">
Gandhi, Leena, Delvys Rodrı́guez-Abreu, Shirish Gadgeel, Emilio Esteban,
Enriqueta Felip, Flávia De Angelis, Manuel Domine, et al. 2018.
<span>“Pembrolizumab Plus Chemotherapy in Metastatic Non–Small-Cell Lung
Cancer.”</span> <em>New England Journal of Medicine</em> 378 (22):
2078–92.
</div>
<div id="ref-JTBook" class="csl-entry">
Jennison, Christopher, and Bruce W. Turnbull. 2000. <em>Group Sequential
Methods with Applications to Clinical Trials</em>. Boca Raton, FL:
Chapman; Hall/CRC.
</div>
<div id="ref-LanDeMets" class="csl-entry">
Lan, K. K. G., and David L. DeMets. 1983. <span>“Discrete Sequential
Boundaries for Clinical Trials.”</span> <em>Biometrika</em> 70: 659–63.
</div>
<div id="ref-CAPTURE" class="csl-entry">
The CAPTURE Investigators. 1997. <span>“Randomized Placebo-Controlled
Trial of Abciximab Before and During Coronary Intervention in Refractory
Unstable Angina: The <span>CAPTURE</span> Study.”</span> <em>Lancet</em>
349 (9063): 1429–35.
</div>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Keaven Anderson.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
